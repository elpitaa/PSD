
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Implementing Estimators &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '.venv/lib/python3.11/site-packages/docs/source/developer_guide/add_estimators';</script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My sample book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F.venv/lib/python3.11/site-packages/docs/source/developer_guide/add_estimators.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../../../_sources/.venv/lib/python3.11/site-packages/docs/source/developer_guide/add_estimators.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Implementing Estimators</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-an-sktime-compatible-estimator">Implementing an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-my-learning-task">What is my learning task?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-sktime-extension-templates">What are <code class="docutils literal notranslate"><span class="pre">sktime</span></code> extension templates?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use-sktime-extension-templates">How to use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> extension templates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-test-interface-conformance">How to test interface conformance</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-check-estimator-utility">Using the <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> utility</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-test-suite-in-a-repository-clone">Running the test suite in a repository clone</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-within-a-third-party-extension-package">Testing within a third party extension package</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-an-sktime-compatible-estimator-to-sktime">Adding an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimator to <code class="docutils literal notranslate"><span class="pre">sktime</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimators-dependent-on-cython">Estimators dependent on cython</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="implementing-estimators">
<span id="developer-guide-add-estimators"></span><h1>Implementing Estimators<a class="headerlink" href="#implementing-estimators" title="Link to this heading">#</a></h1>
<p>This page describes how to implement <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimators, and how to ensure and test compatibility.
There are additional steps for estimators that are contributed to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> directly.</p>
<section id="implementing-an-sktime-compatible-estimator">
<h2>Implementing an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimator<a class="headerlink" href="#implementing-an-sktime-compatible-estimator" title="Link to this heading">#</a></h2>
<p>The high-level steps to implement <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimators are as follows:</p>
<ol class="arabic simple">
<li><p>identify the type of the estimator: forecaster, classifier, etc</p></li>
<li><p>copy the extension template for that kind of estimator to its intended location</p></li>
<li><p>complete the extension template</p></li>
<li><p>run the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> test suite and/or the <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> utility (see <a class="reference external" href="https://www.sktime.net/en/latest/developer_guide/add_estimators.html#using-the-check-estimator-utility">here</a>)</p></li>
<li><p>if the test suite highlights bugs or issues, fix them and go to 4</p></li>
</ol>
<p>For more guidance on how to implement your own estimator, see this <a class="reference external" href="https://github.com/sktime/sktime-workshop-pydata-london-2022">tutorial at pydata</a> on testing interface conformance.</p>
<section id="what-is-my-learning-task">
<h3>What is my learning task?<a class="headerlink" href="#what-is-my-learning-task" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> is structured along modules encompassing specific learning tasks,
e.g., forecasting or time series classification.
For brevity, we define an estimator’s scientific type or “scitype” by the formal learning task that it solves.
For example, the scitype of an estimator that solves the forecasting task is “forecaster”.
The scitype of an estimator that solves the time series classification task is “time series classifier”.</p>
<p>Estimators for a given scitype should be located in the respective module.
The estimator scitypes also map onto the different extension templates found in
the <a class="reference external" href="https://github.com/sktime/sktime/tree/main/extension_templates">extension_templates</a>
directory of <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p>
<p>Usually, the scitype of a given estimator is directly determined by what the estimator does.
This is also, often, explicitly signposted in publications related to the estimator.
For instance, most textbooks mention ARIMA in the context of forecasting, so in that hypothetical situation
it makeas sense to consider the “forecaster” template.
Then, inspect the template and check whether the methods of the class map clearly onto routines of the estimator.
If not, another template might be more appropriate.</p>
<p>The most common point of confusion here is between transformers and other estimator types,
since transformers are often used as parts of algorithms of other type.</p>
<p>If unsure, feel free to post your question on one of <code class="docutils literal notranslate"><span class="pre">sktime</span></code>’s social channels.
Don’t panic - it is not uncommon that academic publications are not clear about the type of an estimator,
and correct categorization may be difficult even to experts.</p>
</section>
<section id="what-are-sktime-extension-templates">
<h3>What are <code class="docutils literal notranslate"><span class="pre">sktime</span></code> extension templates?<a class="headerlink" href="#what-are-sktime-extension-templates" title="Link to this heading">#</a></h3>
<p>Extension templates are convenient “fill-in” templates for implementers of new estimators.
They fit into <code class="docutils literal notranslate"><span class="pre">sktime</span></code>’s unified interface as follows:</p>
<ul class="simple">
<li><p>for each scitype, there is a public user interface, defined by the respective base class.
For instance, <code class="docutils literal notranslate"><span class="pre">BaseForecaster</span></code> defines the <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code> interfaces for forecasters.
All forecasters will implement <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code> the same way, by inheritance from <code class="docutils literal notranslate"><span class="pre">BaseForecaster</span></code>.
The public interface follows the “strategy” object orientation pattern.</p></li>
<li><p>for each scitype, there is a private extender interface, defined by the extension contract in the extension template.
For instance, the <code class="docutils literal notranslate"><span class="pre">forecaster.py</span></code> extension template for forecasters explains what to fill in for a concrete forecaster
inheriting from <code class="docutils literal notranslate"><span class="pre">BaseForecaster</span></code>. In most extension templates, users should implement private methods (“inner” methods),
e.g., <code class="docutils literal notranslate"><span class="pre">_fit</span></code> and <code class="docutils literal notranslate"><span class="pre">_predict</span></code> for forecasters. Boilerplate code rests within the public part of the interface, in <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code>.
The extender interface follows the “template” object orientation pattern.</p></li>
</ul>
<p>Extenders familiar with <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> extension should note the following difference to <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>:</p>
<p>the public interface, e.g., <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code>, is never overridden in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> (concrete) estimators.
Implementation happens in the private, extender sided interface, e.g., <code class="docutils literal notranslate"><span class="pre">_fit</span></code> and <code class="docutils literal notranslate"><span class="pre">_predict</span></code>.</p>
<p>This allows to avoid boilerplate replication, such as <code class="docutils literal notranslate"><span class="pre">check_X</span></code> etc in <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>.
This also allows richer boilerplate, such as automated vectorization functionality or input conversion.</p>
</section>
<section id="how-to-use-sktime-extension-templates">
<h3>How to use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> extension templates<a class="headerlink" href="#how-to-use-sktime-extension-templates" title="Link to this heading">#</a></h3>
<p>To use the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> extension templates, copy them to the intended location of the estimator.
Inside the extension templates, necessary actions are marked with <code class="docutils literal notranslate"><span class="pre">todo</span></code>.
The typical workflow goes through the extension template by searching for <code class="docutils literal notranslate"><span class="pre">todo</span></code>, and carrying out
the action described next to the <code class="docutils literal notranslate"><span class="pre">todo</span></code>.</p>
<p>Extension templates typically have the following <code class="docutils literal notranslate"><span class="pre">todo</span></code>:</p>
<ul class="simple">
<li><p>choosing name and parameters for the estimator</p></li>
<li><p>filling in the <code class="docutils literal notranslate"><span class="pre">__init__</span></code>: writing parameters to <code class="docutils literal notranslate"><span class="pre">self</span></code>, calling <code class="docutils literal notranslate"><span class="pre">super</span></code>’s <code class="docutils literal notranslate"><span class="pre">__init__</span></code></p></li>
<li><p>filling in docstrings of the module and the estimator. This is recommended as early as parameters have been settled on,
it tends to be useful as a specification to follow in implementation.</p></li>
<li><p>filling in the tags for the estimator. Some tags are “capabilities”, i.e., what the estimator can do, e.g., dealing with nans.
Other tags determine the format of inputs seen in the “inner” methods <code class="docutils literal notranslate"><span class="pre">_fit</span></code> etc, these tags are usually called <code class="docutils literal notranslate"><span class="pre">X_inner_mtype</span></code> or similar.
This is useful in case the inner functionality assumes <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, or <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, and helps avoid conversion boilerplate.
The type strings can be found in <code class="docutils literal notranslate"><span class="pre">datatypes.MTYPE_REGISTER</span></code>. For a tutorial on data type conventions, see <code class="docutils literal notranslate"><span class="pre">examples/AA_datatypes_and_datasets</span></code>.</p></li>
<li><p>Filling in the “inner” methods, e.g., <code class="docutils literal notranslate"><span class="pre">_fit</span></code> and <code class="docutils literal notranslate"><span class="pre">_predict</span></code>. The docstrings and comments in the extension template should be followed here.
The docstrings also describe the guarantees on the inputs to the “inner” methods, which are typically stronger than the guarantees on
inputs to the public methods, and determined by values of tags that have been set.
For instance, setting the tag <code class="docutils literal notranslate"><span class="pre">y_inner_mtype</span></code> to <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> for a forecaster guarantees that the <code class="docutils literal notranslate"><span class="pre">y</span></code> seen by <code class="docutils literal notranslate"><span class="pre">_fit</span></code> will be
a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, complying with additional data container specifications in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> (e.g., index types).</p></li>
<li><p>filling in testing parameters in <code class="docutils literal notranslate"><span class="pre">get_test_params</span></code>. The selection of parameters should cover major estimator internal case distinctions
to achieve good coverage.</p></li>
</ul>
<p>Some common caveats, also described in extension template text:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code> parameters should be written to <code class="docutils literal notranslate"><span class="pre">self</span></code> and never be changed</p></li>
<li><p>special case of this: estimator components, i.e., parameters that are estimators, should generally be
cloned (via <code class="docutils literal notranslate"><span class="pre">sklearn.clone</span></code>), and method should be called only on the clones</p></li>
<li><p>methods should generally avoid side effects on arguments</p></li>
<li><p>non-state changing methods should not write to <code class="docutils literal notranslate"><span class="pre">self</span></code> in general</p></li>
<li><p>typically, implementing <code class="docutils literal notranslate"><span class="pre">get_params</span></code> and <code class="docutils literal notranslate"><span class="pre">set_params</span></code> is not needed, since <code class="docutils literal notranslate"><span class="pre">sktime</span></code>’s <code class="docutils literal notranslate"><span class="pre">BaseEstimator</span></code> inherits from <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s.
Custom <code class="docutils literal notranslate"><span class="pre">get_params</span></code>, <code class="docutils literal notranslate"><span class="pre">set_params</span></code> are typically needed only for complex cases only heterogeneous composites, e.g., pipelines with
parameters that are nested structures containing estimators.</p></li>
</ul>
</section>
<section id="how-to-test-interface-conformance">
<h3>How to test interface conformance<a class="headerlink" href="#how-to-test-interface-conformance" title="Link to this heading">#</a></h3>
<p>For a video tutorial and more examples on the below, please visit our
<a class="reference external" href="https://github.com/sktime/sktime-workshop-pydata-london-2022">tutorial at pydata</a>.</p>
<section id="using-the-check-estimator-utility">
<h4>Using the <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> utility<a class="headerlink" href="#using-the-check-estimator-utility" title="Link to this heading">#</a></h4>
<p>Usually, the simplest way to test interface conformance with <code class="docutils literal notranslate"><span class="pre">sktime</span></code> is via the
<code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> methods in the <code class="docutils literal notranslate"><span class="pre">utils.estimator_checks</span></code> module.</p>
<p>When invoked, this will collect tests in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> relevant for the estimator type and
run them on the estimator.</p>
<p>This can be used for manual debugging in a notebook environment.
Example of running the full test suite for <code class="docutils literal notranslate"><span class="pre">NaiveForecaster</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.estimator_checks</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_estimator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span>
<span class="n">check_estimator</span><span class="p">(</span><span class="n">NaiveForecaster</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> utility will return, by default, a <code class="docutils literal notranslate"><span class="pre">dict</span></code>, indexed by test/fixture combination strings,
that is, a test name and the fixture combination string in squared brackets.
Example: <code class="docutils literal notranslate"><span class="pre">'test_repr[NaiveForecaster-2]'</span></code>, where <code class="docutils literal notranslate"><span class="pre">test_repr</span></code> is the test name, and <code class="docutils literal notranslate"><span class="pre">NaiveForecaster-2</span></code> the fixture combination string.</p>
<p>Values of the return <code class="docutils literal notranslate"><span class="pre">dict</span></code> are either the string <code class="docutils literal notranslate"><span class="pre">&quot;PASSED&quot;</span></code>, if the test succeeds, or the exception that the test would raise at failure.
<code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> does not raise exceptions by default, the default is returning them as dictionary values.
To raise the exceptions instead, e.g., for debugging, use the argument <code class="docutils literal notranslate"><span class="pre">raise_exceptions=True</span></code>,
which will raise the exceptions instead of returning them as dictionary values.
In that case, there will be at most one exception raised, namely the first exception encountered in the test execution order.</p>
<p>To run or exclude certain tests, use the <code class="docutils literal notranslate"><span class="pre">tests_to_run</span></code> or <code class="docutils literal notranslate"><span class="pre">tests_to_exclude</span></code> arguments.
Values provided should be names of tests (str), or a list of names of tests.
Note that test names exclude the part in squared brackets.</p>
<p>Example, running the test <code class="docutils literal notranslate"><span class="pre">test_constructor</span></code> with all fixtures:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">check_estimator</span><span class="p">(</span><span class="n">NaiveForecaster</span><span class="p">,</span> <span class="n">tests_to_run</span><span class="o">=</span><span class="s2">&quot;test_constructor&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">{'test_constructor[NaiveForecaster]':</span> <span class="pre">'PASSED'}</span></code></p>
<p>To run or exclude certain test-fixture-combinations, use the <code class="docutils literal notranslate"><span class="pre">fixtures_to_run</span></code> or <code class="docutils literal notranslate"><span class="pre">fixtures_to_exclude</span></code> arguments.
Values provided should be names of test-fixture-combination strings (str), or a list of such.
Valid strings are precisely the dictionary keys when using <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> with default parameters.</p>
<p>Example, running the test-fixture-combination <code class="docutils literal notranslate"><span class="pre">&quot;test_repr[NaiveForecaster-2]&quot;</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">check_estimator</span><span class="p">(</span><span class="n">NaiveForecaster</span><span class="p">,</span> <span class="n">fixtures_to_run</span><span class="o">=</span><span class="s2">&quot;test_repr[NaiveForecaster-2]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">{'test_repr[NaiveForecaster-2]':</span> <span class="pre">'PASSED'}</span></code></p>
<p>A useful workflow for using <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> to debug an estimator is as follows:</p>
<ol class="arabic simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">check_estimator(MyEstimator)</span></code> to find failing tests</p></li>
<li><p>Subset to failing tests or fixtures using <code class="docutils literal notranslate"><span class="pre">fixtures_to_run</span></code> or <code class="docutils literal notranslate"><span class="pre">tests_to_run</span></code></p></li>
<li><p>If the failure is not obvious, set <code class="docutils literal notranslate"><span class="pre">raise_exceptions=True</span></code> to raise the exception and inspecet the traceback.</p></li>
<li><p>If the failure is still not clear, use advanced debuggers on the line of code with <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code>.</p></li>
</ol>
</section>
<section id="running-the-test-suite-in-a-repository-clone">
<h4>Running the test suite in a repository clone<a class="headerlink" href="#running-the-test-suite-in-a-repository-clone" title="Link to this heading">#</a></h4>
<p>If the target location of the estimator is within <code class="docutils literal notranslate"><span class="pre">sktime</span></code>, then the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> test
suite can be run instead. The <code class="docutils literal notranslate"><span class="pre">sktime</span></code> test suite (and CI/CD) is <code class="docutils literal notranslate"><span class="pre">pytest</span></code> based, <code class="docutils literal notranslate"><span class="pre">pytest</span></code> will automatically
collect all estimators of a certain type and tests applying for a given estimator.</p>
<p>For an overview of the testing framework, see the “testing framework” documentation.
Generic interface conformance tests are contained in the classes <code class="docutils literal notranslate"><span class="pre">TestAllEstimators</span></code>, <code class="docutils literal notranslate"><span class="pre">TestAllForecasters</span></code>, and so on.
<code class="docutils literal notranslate"><span class="pre">pytest</span></code> test-fixture-strings for an estimator <code class="docutils literal notranslate"><span class="pre">EstimatorName</span></code> will always contain <code class="docutils literal notranslate"><span class="pre">EstimatorName</span></code> as a substring,
and are identical with the test-fixture-strings returned by <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code>.</p>
<p>To run tests only for a given estimator from the console, the command <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-k</span> <span class="pre">&quot;EstimatorName&quot;</span></code> can be used.
This will typically have the same effect as using <code class="docutils literal notranslate"><span class="pre">check_estimator(EstimatorName)</span></code>, only via direct <code class="docutils literal notranslate"><span class="pre">pytest</span></code> call.
When using Visual Studio Code or pycharm, tests can also be sub-set using GUI filter
functionality - for this, refer to the respecetive IDE documentation on test integration.</p>
<p>To identify codebase locations of tests applying to a specific estimator,
a quick approach is searching the codebase for test strings produced by <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code>, preceded by <code class="docutils literal notranslate"><span class="pre">def</span></code> (for function/method definition).</p>
</section>
</section>
<section id="testing-within-a-third-party-extension-package">
<h3>Testing within a third party extension package<a class="headerlink" href="#testing-within-a-third-party-extension-package" title="Link to this heading">#</a></h3>
<p>For third party extension packages to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> (open or closed),
or third party modules that aim for interface compliance with <code class="docutils literal notranslate"><span class="pre">sktime</span></code>,
the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> test suite can be imported and extended in two ways:</p>
<ul class="simple">
<li><p>importing <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code>, this will carry out the tests defined in <code class="docutils literal notranslate"><span class="pre">sktime</span></code></p></li>
<li><p>importing test classes, e.g., <code class="docutils literal notranslate"><span class="pre">test_all_estimators.TestAllEstimators</span></code> or
<code class="docutils literal notranslate"><span class="pre">test_all_forecasters.TestAllForecasters</span></code>. The imports will be discovered directly
by <code class="docutils literal notranslate"><span class="pre">pytest</span></code>. The test suite also be extended by inheriting from the test classes.</p></li>
</ul>
</section>
</section>
<section id="adding-an-sktime-compatible-estimator-to-sktime">
<h2>Adding an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimator to <code class="docutils literal notranslate"><span class="pre">sktime</span></code><a class="headerlink" href="#adding-an-sktime-compatible-estimator-to-sktime" title="Link to this heading">#</a></h2>
<p>When adding an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimator to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> itself, a number of
additional things need to be done:</p>
<ul class="simple">
<li><p>ensure that code also meets <code class="docutils literal notranslate"><span class="pre">sktime's</span></code> <a class="reference internal" href="../../../../../../lib64/python3.11/site-packages/docs/source/developer_guide/documentation.html#developer-guide-documentation"><span class="std std-ref">documentation</span></a> standards.</p></li>
<li><p>add the estimator to the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> API reference. This is done by adding a reference to the estimator in the
correct <code class="docutils literal notranslate"><span class="pre">rst</span></code> file inside <code class="docutils literal notranslate"><span class="pre">docs/source/api_reference</span></code>.</p></li>
<li><p>authors of the estimator should add themselves to <code class="docutils literal notranslate"><span class="pre">CODEOWNERS</span></code>, as owners of the contributed estimator.</p></li>
<li><p>if the estimator relies on soft dependencies, or adds new soft dependencies, the steps in the <a class="reference internal" href="../../../../../../lib64/python3.11/site-packages/docs/source/developer_guide/dependencies.html#dependencies"><span class="std std-ref">“dependencies”
developer guide</span></a> should be followed</p></li>
<li><p>ensure that the estimator passes the entire local test suite of <code class="docutils literal notranslate"><span class="pre">sktime</span></code>, with the estimator in its target location.
To run tests only for the estimator, the command <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-k</span> <span class="pre">&quot;EstimatorName&quot;</span></code> can be used (or vs code GUI filter functionality)</p></li>
<li><p>ensure that test parameters in <code class="docutils literal notranslate"><span class="pre">get_test_params</span></code> are chosen such that runtime of estimator specific tests remains in the seconds order
on <code class="docutils literal notranslate"><span class="pre">sktime</span></code> remote CI/CD</p></li>
</ul>
<p>Don’t panic - when contributing to <code class="docutils literal notranslate"><span class="pre">sktime</span></code>, core developers will give helpful pointers on the above in their PR reviews.</p>
<p>It is recommended to open a draft PR to get feedback early.</p>
<section id="estimators-dependent-on-cython">
<h3>Estimators dependent on cython<a class="headerlink" href="#estimators-dependent-on-cython" title="Link to this heading">#</a></h3>
<p>To add an estimator to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> that depends on cython, the following additional steps are needed:</p>
<ul class="simple">
<li><p>all cython code should be present in a separate package on <code class="docutils literal notranslate"><span class="pre">pypi</span></code> and/or <code class="docutils literal notranslate"><span class="pre">conda-forge</span></code>.
No cython dependent code should be added directly to <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.
Below, we call this separate package <code class="docutils literal notranslate"><span class="pre">home-package</span></code>, for simplicity of reference.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">home-package</span></code>, it is recommended to test the estimator via <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code>,
on the same test matrix as <code class="docutils literal notranslate"><span class="pre">sktime</span></code>: all supported python versions; MacOS, Linux, Windows.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">sktime</span></code>, an interface to the algorithm should be added.
This can be a simple import from <code class="docutils literal notranslate"><span class="pre">home-package</span></code>,
if the algorithm in <code class="docutils literal notranslate"><span class="pre">home-package</span></code> already passes <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code>.</p></li>
<li><p>Alternatively, the algorithm can be interfaced via a delegator as a delegate,
tags and method overrides can be added in the delegator. See, e.g., <code class="docutils literal notranslate"><span class="pre">MrSQM</span></code> for this.</p></li>
<li><p>For the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> interface, the <code class="docutils literal notranslate"><span class="pre">requires_cython</span></code> tag should be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>,
and the <code class="docutils literal notranslate"><span class="pre">python_dependencies</span></code> tag should be set to the string <code class="docutils literal notranslate"><span class="pre">&quot;home-package&quot;</span></code>.</p></li>
</ul>
<p>If all has been setup correctly, the estimator will be tested in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> by the
CI element <code class="docutils literal notranslate"><span class="pre">test-cython-estimators</span></code>.
Note that this CI element does not cover the full test matrix
of python version and operating systems, this should be done in the upstream package.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./.venv/lib/python3.11/site-packages/docs/source/developer_guide"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-an-sktime-compatible-estimator">Implementing an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-my-learning-task">What is my learning task?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-sktime-extension-templates">What are <code class="docutils literal notranslate"><span class="pre">sktime</span></code> extension templates?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use-sktime-extension-templates">How to use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> extension templates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-test-interface-conformance">How to test interface conformance</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-check-estimator-utility">Using the <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code> utility</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-test-suite-in-a-repository-clone">Running the test suite in a repository clone</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-within-a-third-party-extension-package">Testing within a third party extension package</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-an-sktime-compatible-estimator-to-sktime">Adding an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible estimator to <code class="docutils literal notranslate"><span class="pre">sktime</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimators-dependent-on-cython">Estimators dependent on cython</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>