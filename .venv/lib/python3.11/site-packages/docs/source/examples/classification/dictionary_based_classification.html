
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Dictionary based time series classification in sktime &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '.venv/lib/python3.11/site-packages/docs/source/examples/classification/dictionary_based_classification';</script>
    <link rel="index" title="Index" href="../../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../../../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My sample book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F.venv/lib/python3.11/site-packages/docs/source/examples/classification/dictionary_based_classification.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../../../../_sources/.venv/lib/python3.11/site-packages/docs/source/examples/classification/dictionary_based_classification.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Dictionary based time series classification in sktime</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">1. Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">2. Load data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bag-of-sfa-symbols-boss">3. Bag of SFA Symbols (BOSS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contractable-boss-cboss">4. Contractable BOSS (cBOSS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#word-extraction-for-time-series-classification-weasel">5. Word Extraction for Time Series Classification (WEASEL)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#univariate">Univariate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multivariate">Multivariate</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-dictionary-ensemble-tde">6. Temporal Dictionary Ensemble (TDE)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Univariate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Multivariate</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="dictionary-based-time-series-classification-in-sktime">
<h1>Dictionary based time series classification in sktime<a class="headerlink" href="#dictionary-based-time-series-classification-in-sktime" title="Link to this heading">#</a></h1>
<p>Dictionary based approaches adapt the bag of words model commonly used in signal processing, computer vision and audio processing for time series classification.
Dictionary based classifiers have the same broad structure.
A sliding window of length <span class="math notranslate nohighlight">\(w\)</span> is run across a series.
For each window, the real valued series of length <span class="math notranslate nohighlight">\(w\)</span> is converted through approximation and discretisation processes into a symbolic string of length <span class="math notranslate nohighlight">\(l\)</span>, which consists of <span class="math notranslate nohighlight">\(\alpha\)</span> possible letters.
The occurrence in a series of each ‘word’ from the dictionary defined by <span class="math notranslate nohighlight">\(l\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> is counted, and once the sliding window has completed the series is transformed into a histogram.
Classification is based on the histograms of the words extracted from the series, rather than the raw data.</p>
<p>Currently 4 univeriate dictionary based classifiers are implemented in sktime, all making use of the Symbolic Fourier Approximation (SFA)[1] transform to discretise into words.
These are the Bag of SFA Symbols (BOSS)[2], the Contractable Bag of SFA Symbols (cBOSS)[3], Word Extraction for Time Series Classification  (WEASEL)[4] and the Temporal Dictionary Ensemble (TDE)[5]. WEASEL has a multivariate extension called MUSE[7] and TDE has multivariate capabilities.</p>
<p>In this notebook, we will demonstrate how to use BOSS, cBOSS, WEASEL and TDE on the ItalyPowerDemand and BasicMotions datasets.</p>
<section id="references">
<h2>References:<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<p>[1] Schäfer, P., &amp; Högqvist, M. (2012). SFA: a symbolic fourier approximation and index for similarity search in high dimensional datasets. In Proceedings of the 15th International Conference on Extending Database Technology (pp. 516-527).</p>
<p>[2] Schäfer, P. (2015). The BOSS is concerned with time series classification in the presence of noise. Data Mining and Knowledge Discovery, 29(6), 1505-1530.</p>
<p>[3] Middlehurst, M., Vickers, W., &amp; Bagnall, A. (2019). Scalable dictionary classifiers for time series classification. In International Conference on Intelligent Data Engineering and Automated Learning (pp. 11-19). Springer, Cham.</p>
<p>[4] Schäfer, P., &amp; Leser, U. (2017). Fast and accurate time series classification with WEASEL. In Proceedings of the 2017 ACM on Conference on Information and Knowledge Management (pp. 637-646).</p>
<p>[5] Middlehurst, M., Large, J., Cawley, G., &amp; Bagnall, A. (2020). The Temporal Dictionary Ensemble (TDE) Classifier for Time Series Classification. In The European Conference on Machine Learning and Principles and Practice of Knowledge Discovery in Databases.</p>
<p>[6] Large, J., Bagnall, A., Malinowski, S., &amp; Tavenard, R. (2019). On time series classification with dictionary-based classifiers. Intelligent Data Analysis, 23(5), 1073-1089.</p>
<p>[7] Schäfer, P., &amp; Leser, U. (2018). Multivariate time series classification with WEASEL+MUSE. 3rd ECML/PKDD Workshop on AALTD.</p>
</section>
<section id="imports">
<h2>1. Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">metrics</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.dictionary_based</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">MUSE</span><span class="p">,</span>
    <span class="n">WEASEL</span><span class="p">,</span>
    <span class="n">BOSSEnsemble</span><span class="p">,</span>
    <span class="n">ContractableBOSS</span><span class="p">,</span>
    <span class="n">TemporalDictionaryEnsemble</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_basic_motions</span><span class="p">,</span> <span class="n">load_italy_power_demand</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-data">
<h2>2. Load data<a class="headerlink" href="#load-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">X_train_mv</span><span class="p">,</span> <span class="n">y_train_mv</span> <span class="o">=</span> <span class="n">load_basic_motions</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test_mv</span><span class="p">,</span> <span class="n">y_test_mv</span> <span class="o">=</span> <span class="n">load_basic_motions</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">X_train_mv</span> <span class="o">=</span> <span class="n">X_train_mv</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="n">y_train_mv</span> <span class="o">=</span> <span class="n">y_train_mv</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="n">X_test_mv</span> <span class="o">=</span> <span class="n">X_test_mv</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="n">y_test_mv</span> <span class="o">=</span> <span class="n">y_test_mv</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train_mv</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train_mv</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test_mv</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test_mv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67, 1) (67,) (50, 1) (50,)
(20, 6) (20,) (20, 6) (20,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="bag-of-sfa-symbols-boss">
<h2>3. Bag of SFA Symbols (BOSS)<a class="headerlink" href="#bag-of-sfa-symbols-boss" title="Link to this heading">#</a></h2>
<p>BOSS is an ensemble of individual BOSS classifiers making use of the SFA transform.
The classifier performs grid-search through a large number of individual classifiers for parameters <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(p\)</span> (normalise each window).
Of the classifiers searched only those within 92% accuracy of the best classifier are retained.
Individual BOSS classifiers use a non-symmetric distance function, BOSS distance, in conjunction with a nearest neighbour classifier.</p>
<p>As tuning is handled inside the classifier, BOSS has very little parameters to be altered and generally should be run using default settings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boss</span> <span class="o">=</span> <span class="n">BOSSEnsemble</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">47</span><span class="p">)</span>
<span class="n">boss</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">boss_preds</span> <span class="o">=</span> <span class="n">boss</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;BOSS Accuracy: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">boss_preds</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BOSS Accuracy: 0.94
</pre></div>
</div>
</div>
</div>
</section>
<section id="contractable-boss-cboss">
<h2>4. Contractable BOSS (cBOSS)<a class="headerlink" href="#contractable-boss-cboss" title="Link to this heading">#</a></h2>
<p>cBOSS significantly speeds up BOSS with no significant difference in accuracy by improving how the ensemble is formed.
cBOSS utilises a filtered random selection of parameters to find its ensemble members.
Each ensemble member is built on a 70% subsample of the train data, using random sampling without replacement.
An exponential weighting scheme for the predictions of the base classifiers is introduced.</p>
<p>A new parameter for the number of parameters samples <span class="math notranslate nohighlight">\(k\)</span> is introduced. of which the top <span class="math notranslate nohighlight">\(s\)</span> (max ensemble size) with the highest accuracy are kept for the final ensemble.
The <span class="math notranslate nohighlight">\(k\)</span> parameter is replaceable with a time limit <span class="math notranslate nohighlight">\(t\)</span> through contracting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recommended non-contract cBOSS parameters</span>
<span class="n">cboss</span> <span class="o">=</span> <span class="n">ContractableBOSS</span><span class="p">(</span><span class="n">n_parameter_samples</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">max_ensemble_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">47</span><span class="p">)</span>

<span class="c1"># cBOSS with a 1 minute build time contract</span>
<span class="c1"># cboss = ContractableBOSS(time_limit_in_minutes=1,</span>
<span class="c1">#                         max_ensemble_size=50,</span>
<span class="c1">#                         random_state=47)</span>

<span class="n">cboss</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">cboss_preds</span> <span class="o">=</span> <span class="n">cboss</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cBOSS Accuracy: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">cboss_preds</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cBOSS Accuracy: 0.96
</pre></div>
</div>
</div>
</div>
</section>
<section id="word-extraction-for-time-series-classification-weasel">
<h2>5. Word Extraction for Time Series Classification (WEASEL)<a class="headerlink" href="#word-extraction-for-time-series-classification-weasel" title="Link to this heading">#</a></h2>
<p>WEASEL transforms time series into feature vectors, using a sliding-window approach, which are then analyzed through a machine learning classifier. The novelty of WEASEL lies in its specific method for deriving features, resulting in a much smaller yet much more discriminative feature set than BOSS. It extends SFA by bigrams, feature selection using Anova-f-test and Information Gain Binning (IGB).</p>
<section id="univariate">
<h3>Univariate<a class="headerlink" href="#univariate" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weasel</span> <span class="o">=</span> <span class="n">WEASEL</span><span class="p">(</span><span class="n">binning_strategy</span><span class="o">=</span><span class="s2">&quot;equi-depth&quot;</span><span class="p">,</span> <span class="n">anova</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">47</span><span class="p">)</span>
<span class="n">weasel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">weasel_preds</span> <span class="o">=</span> <span class="n">weasel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WEASEL Accuracy: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">weasel_preds</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WEASEL Accuracy: 0.96
</pre></div>
</div>
</div>
</div>
</section>
<section id="multivariate">
<h3>Multivariate<a class="headerlink" href="#multivariate" title="Link to this heading">#</a></h3>
<p>WEASEL+MUSE (Multivariate Symbolic Extension) is the multivariate extension of WEASEL.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">muse</span> <span class="o">=</span> <span class="n">MUSE</span><span class="p">()</span>
<span class="n">muse</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_mv</span><span class="p">,</span> <span class="n">y_train_mv</span><span class="p">)</span>

<span class="n">muse_preds</span> <span class="o">=</span> <span class="n">muse</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_mv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MUSE Accuracy: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test_mv</span><span class="p">,</span> <span class="n">muse_preds</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MUSE Accuracy: 1.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="temporal-dictionary-ensemble-tde">
<h2>6. Temporal Dictionary Ensemble (TDE)<a class="headerlink" href="#temporal-dictionary-ensemble-tde" title="Link to this heading">#</a></h2>
<p>TDE aggregates the best components of 3 classifiers extending from the original BOSS algorithm. The ensemble structure and improvements of cBOSS[3] are used; Spatial pyramids are introduced from Spatial BOSS (S-BOSS)[6]; From Word Extraction for Time Series Classification (WEASEL)[4] bigrams and Information Gain Binning (IGB), a replacement for the multiple coefficient binning (MCB) used by SFA, are included.
Two new parameters are included in the ensemble parameter search, the number of spatial pyramid levels <span class="math notranslate nohighlight">\(h\)</span> and whether to use IGB or MCB <span class="math notranslate nohighlight">\(b\)</span>.
A Gaussian processes regressor is used to select new parameter sets to evaluate for the ensemble, predicting the accuracy of a set of parameter values using past classifier performances.</p>
<p>Inheriting the cBOSS ensemble structure, the number of parameter samples <span class="math notranslate nohighlight">\(k\)</span>, time limit <span class="math notranslate nohighlight">\(t\)</span> and max ensemble size <span class="math notranslate nohighlight">\(s\)</span> remain as parameters to be set accounting for memory and time requirements.</p>
<section id="id1">
<h3>Univariate<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recommended non-contract TDE parameters</span>
<span class="n">tde_u</span> <span class="o">=</span> <span class="n">TemporalDictionaryEnsemble</span><span class="p">(</span>
    <span class="n">n_parameter_samples</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">max_ensemble_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">randomly_selected_params</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">47</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># TDE with a 1 minute build time contract</span>
<span class="c1"># tde = TemporalDictionaryEnsemble(time_limit_in_minutes=1,</span>
<span class="c1">#                                 max_ensemble_size=50,</span>
<span class="c1">#                                 randomly_selected_params=50,</span>
<span class="c1">#                                 random_state=47)</span>

<span class="n">tde_u</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">tde_u_preds</span> <span class="o">=</span> <span class="n">tde_u</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TDE Accuracy: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">tde_u_preds</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TDE Accuracy: 1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>Multivariate<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recommended non-contract TDE parameters</span>
<span class="n">tde_mv</span> <span class="o">=</span> <span class="n">TemporalDictionaryEnsemble</span><span class="p">(</span>
    <span class="n">n_parameter_samples</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">max_ensemble_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">randomly_selected_params</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">47</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># TDE with a 1 minute build time contract</span>
<span class="c1"># tde_m = TemporalDictionaryEnsemble(time_limit_in_minutes=1,</span>
<span class="c1">#                                 max_ensemble_size=50,</span>
<span class="c1">#                                 randomly_selected_params=50,</span>
<span class="c1">#                                 random_state=47)</span>

<span class="n">tde_mv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_mv</span><span class="p">,</span> <span class="n">y_train_mv</span><span class="p">)</span>

<span class="n">tde_mv_preds</span> <span class="o">=</span> <span class="n">tde_mv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_mv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TDE Accuracy: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test_mv</span><span class="p">,</span> <span class="n">tde_mv_preds</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TDE Accuracy: 1.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./.venv/lib/python3.11/site-packages/docs/source/examples/classification"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">1. Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">2. Load data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bag-of-sfa-symbols-boss">3. Bag of SFA Symbols (BOSS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contractable-boss-cboss">4. Contractable BOSS (cBOSS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#word-extraction-for-time-series-classification-weasel">5. Word Extraction for Time Series Classification (WEASEL)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#univariate">Univariate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multivariate">Multivariate</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-dictionary-ensemble-tde">6. Temporal Dictionary Ensemble (TDE)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Univariate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Multivariate</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>