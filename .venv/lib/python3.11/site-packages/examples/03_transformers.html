
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview of this notebook &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '.venv/lib/python3.11/site-packages/examples/03_transformers';</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My sample book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F.venv/lib/python3.11/site-packages/examples/03_transformers.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../_sources/.venv/lib/python3.11/site-packages/examples/03_transformers.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Overview of this notebook</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Overview of this notebook</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-in-sktime">3. Transformers in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="chapter3"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wherefore-transformers">3.1 Wherefore transformers? <a class="anchor" id="section_3_1"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-approach-don-t-do-this-at-home">Naive approach - don’t do this at home!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slightly-less-naive-approach-use-sktime-transformers-badly">Slightly less naive approach - use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers (badly)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expert-approach-use-sktime-transformers-with-pipelines">Expert approach - use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers with pipelines!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-interface-and-features">3.2 Transformers - interface and features <a class="anchor" id="section_3_2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-transformers">3.2.1 What are transformers? <a class="anchor" id="section_3_2_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#different-types-of-transformers">3.2.2 Different types of transformers <a class="anchor" id="section_3_2_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting-aka-vectorization-of-transformers">3.2.3 Broadcasting aka vectorization of transformers <a class="anchor" id="section_3_2_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-as-pipeline-components">3.2.4 Transformers as pipeline components <a class="anchor" id="section_3_2_4"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-forecaster-pipeline">Example 1: forecaster pipeline</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-classifier-pipeline">Example 2: classifier pipeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-transformers-feature-engineering">3.3 Combining transformers, feature engineering <a class="anchor" id="section_3_3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chaining-transformers-via">Chaining transformers via <code class="docutils literal notranslate"><span class="pre">*</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-union-via">Feature union via <code class="docutils literal notranslate"><span class="pre">+</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subset-input-columns-via-colname">Subset input columns via <code class="docutils literal notranslate"><span class="pre">[colname]</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#turning-log-transform-into-exp-transform-via-invert">turning log transform into exp transform via invert <code class="docutils literal notranslate"><span class="pre">~</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automl-structure-compositors-multiplexer-switch-and-on-off-switch">autoML structure compositors: multiplexer switch <code class="docutils literal notranslate"><span class="pre">¦</span></code> and on/off switch <code class="docutils literal notranslate"><span class="pre">-</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-details-transformer-types-and-signatures">3.4 Technical details - transformer types and signatures <a class="anchor" id="section_3_4"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-container-format">3.4.1 Data container format<a class="anchor" id="section_3_4_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-transformer-signature-time-series-transformers">3.4.2 General transformer signature - time series transformers<a class="anchor" id="section_3_4_2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-transforming-series-to-series">Example: transforming series to series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-transforming-series-to-primitive-features">Example: transforming series to primitive features</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-with-series-panel-output-vs-primitive-output">Transformers with series/panel output vs primitive output</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-transformer-signature-pairwise-series-transformers">3.4.3 General transformer signature - pairwise series transformers<a class="anchor" id="section_3_4_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-transformer-signature-pairwise-transformers">3.4.4 General transformer signature - pairwise transformers<a class="anchor" id="section_3_4_4"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-transformers">3.4.5 Searching for transformers<a class="anchor" id="section_3_4_5"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extension-guide-implementing-your-own-transformer">3.5 Extension guide - implementing your own transformer <a class="anchor" id="section_3_5"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">3.6 Summary <a class="anchor" id="section_3_6"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credits-notebook-3-transformers">Credits: notebook 3 - transformers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="overview-of-this-notebook">
<h1>Overview of this notebook<a class="headerlink" href="#overview-of-this-notebook" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>why transformers? transformers in <code class="docutils literal notranslate"><span class="pre">sktime</span></code></p>
<ul>
<li><p>transformers = modular data processing steps</p></li>
<li><p>simple pipeline example &amp; transformer explained</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>overview of transformer features</p>
<ul>
<li><p>types of transformers - input types, output types</p></li>
<li><p>broadcasting/vectorization to panel, hierarchical, multivariate</p></li>
<li><p>searching for transformers using <code class="docutils literal notranslate"><span class="pre">all_estimators</span></code></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="#chapter3"><span class="xref myst">3. Transformers in sktime</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_3_1"><span class="xref myst">3.1 Wherefore transformers?</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_2"><span class="xref myst">3.2 Transformers - interface and features</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_3_2_1"><span class="xref myst">3.2.1 What are transformers?</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_2_2"><span class="xref myst">3.2.2 Different types of transformers</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_2_3"><span class="xref myst">3.2.3 Broadcasting aka vectorization of transformers</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_2_4"><span class="xref myst">3.2.4 Transformers as pipeline components</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section_3_3"><span class="xref myst">3.3 Combining transformers, feature engineering</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_4"><span class="xref myst">3.4 Technical details - transformer types and signatures</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_5"><span class="xref myst">3.5 Extension guide</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_6"><span class="xref myst">3.6 Summary</span></a></p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="transformers-in-sktime">
<h1>3. Transformers in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="chapter3"></a><a class="headerlink" href="#transformers-in-sktime" title="Link to this heading">#</a></h1>
<section id="wherefore-transformers">
<h2>3.1 Wherefore transformers? <a class="anchor" id="section_3_1"></a><a class="headerlink" href="#wherefore-transformers" title="Link to this heading">#</a></h2>
<p>or: why sktime transformers will improve your life!</p>
<p>(disclaimer: not the same product as deep learning transformers)</p>
<p>suppose we want to forecast this well-known dataset
(airline passengers by year in a fixed scope)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_series</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;,
 &lt;AxesSubplot: ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/d01205d3b91cab37103a9ba728a60403f0cc59015b8779792bd80687dd8b0851.png" src="../../../../../_images/d01205d3b91cab37103a9ba728a60403f0cc59015b8779792bd80687dd8b0851.png" />
</div>
</div>
<p>observations:</p>
<ul class="simple">
<li><p>there is seasonal periodicity, 12 month period</p></li>
<li><p>seasonal periodicity looks multiplicative (not additive) to trend</p></li>
</ul>
<p>idea: forecast might be easier</p>
<ul class="simple">
<li><p>with seasonality removed</p></li>
<li><p>on logarithmic value scale (multiplication becomes addition)</p></li>
</ul>
<section id="naive-approach-don-t-do-this-at-home">
<h3>Naive approach - don’t do this at home!<a class="headerlink" href="#naive-approach-don-t-do-this-at-home" title="Link to this heading">#</a></h3>
<p>Maybe doing this manually step by step is a good idea?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># compute the logarithm</span>
<span class="n">logy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">plot_series</span><span class="p">(</span><span class="n">logy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;,
 &lt;AxesSubplot: ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/f04bad87598d8e11ab3264d2616965e2b19d2bff952b87042046819ec00e4765.png" src="../../../../../_images/f04bad87598d8e11ab3264d2616965e2b19d2bff952b87042046819ec00e4765.png" />
</div>
</div>
<p>this looks additive now!</p>
<p>ok, what next - deaseasonalization</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>

<span class="c1"># apply this to y</span>
<span class="c1"># wait no, to logy</span>

<span class="n">seasonal_result</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">logy</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">trend</span> <span class="o">=</span> <span class="n">seasonal_result</span><span class="o">.</span><span class="n">trend</span>
<span class="n">resid</span> <span class="o">=</span> <span class="n">seasonal_result</span><span class="o">.</span><span class="n">resid</span>
<span class="n">seasonal</span> <span class="o">=</span> <span class="n">seasonal_result</span><span class="o">.</span><span class="n">seasonal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_series</span><span class="p">(</span><span class="n">trend</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;, &lt;AxesSubplot: ylabel=&#39;trend&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/92ed622c1c5d02fd4232cae424926864998f43f2857912e913894ee6e2d75741.png" src="../../../../../_images/92ed622c1c5d02fd4232cae424926864998f43f2857912e913894ee6e2d75741.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_series</span><span class="p">(</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">resid</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;seasonal component&quot;</span><span class="p">,</span> <span class="s2">&quot;residual component&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;, &lt;AxesSubplot: ylabel=&#39;seasonal&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/5047d9fd5cf315ce74e5cb326bc64ef3981010a24900dbb3171ab3998b66e1bc.png" src="../../../../../_images/5047d9fd5cf315ce74e5cb326bc64ef3981010a24900dbb3171ab3998b66e1bc.png" />
</div>
</div>
<p>ok, now the forecast!</p>
<p>… of what ??</p>
<p>ah yes, residual plus trend, because seasonal just repeats itself</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># forecast this:</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">trend</span> <span class="o">+</span> <span class="n">resid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;, &lt;AxesSubplot: &gt;)
</pre></div>
</div>
<img alt="../../../../../_images/351aab9bf7948ba958e5c608fb556b7aef8af365f47a4f3315d68c5ea660bdfa.png" src="../../../../../_images/351aab9bf7948ba958e5c608fb556b7aef8af365f47a4f3315d68c5ea660bdfa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this has nans??</span>
<span class="n">trend</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1949-01   NaN
1949-02   NaN
1949-03   NaN
1949-04   NaN
1949-05   NaN
           ..
1960-08   NaN
1960-09   NaN
1960-10   NaN
1960-11   NaN
1960-12   NaN
Freq: M, Name: trend, Length: 144, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ok, forecast this instead then:</span>
<span class="n">y_to_forecast</span> <span class="o">=</span> <span class="n">logy</span> <span class="o">-</span> <span class="n">seasonal</span>

<span class="c1"># phew, no nans!</span>
<span class="n">y_to_forecast</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1949-01    4.804314
1949-02    4.885097
1949-03    4.864689
1949-04    4.872858
1949-05    4.804757
             ...   
1960-08    6.202368
1960-09    6.165645
1960-10    6.208669
1960-11    6.181992
1960-12    6.168741
Freq: M, Length: 144, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.trend</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialTrendForecaster</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">PolynomialTrendForecaster</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_to_forecast</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)))</span>
<span class="n">y_fcst</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="n">plot_series</span><span class="p">(</span><span class="n">y_to_forecast</span><span class="p">,</span> <span class="n">y_fcst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;, &lt;AxesSubplot: &gt;)
</pre></div>
</div>
<img alt="../../../../../_images/57fa3ed8ca861d7600fff33e9aab57a56ea24f21cd910c4035f0c449c5cf9b58.png" src="../../../../../_images/57fa3ed8ca861d7600fff33e9aab57a56ea24f21cd910c4035f0c449c5cf9b58.png" />
</div>
</div>
<p>looks reasonable!</p>
<p>Now to turn this into a forecast of the original y …</p>
<ul class="simple">
<li><p>add seasonal</p></li>
<li><p>invert the logarithm</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_fcst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1961-01    6.195931
1961-02    6.202857
1961-03    6.209740
1961-04    6.216580
1961-05    6.223378
1961-06    6.230132
1961-07    6.236843
1961-08    6.243512
1961-09    6.250137
1961-10    6.256719
1961-11    6.263259
1961-12    6.269755
Freq: M, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_fcst_orig</span> <span class="o">=</span> <span class="n">y_fcst</span> <span class="o">+</span> <span class="n">seasonal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>
<span class="n">y_fcst_orig_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y_fcst_orig</span><span class="p">)</span>

<span class="n">y_fcst_orig_orig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1949-01   NaN
1949-02   NaN
1949-03   NaN
1949-04   NaN
1949-05   NaN
1949-06   NaN
1949-07   NaN
1949-08   NaN
1949-09   NaN
1949-10   NaN
1949-11   NaN
1949-12   NaN
1961-01   NaN
1961-02   NaN
1961-03   NaN
1961-04   NaN
1961-05   NaN
1961-06   NaN
1961-07   NaN
1961-08   NaN
1961-09   NaN
1961-10   NaN
1961-11   NaN
1961-12   NaN
Freq: M, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>ok, that did not work. Something something pandas indices??</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_fcst_orig</span> <span class="o">=</span> <span class="n">y_fcst</span> <span class="o">+</span> <span class="n">seasonal</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_fcst_orig_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y_fcst_orig</span><span class="p">)</span>

<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_fcst_orig_orig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;,
 &lt;AxesSubplot: ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/2030e3872df26494531c6967287a9738275118333aef2b6a683cf190a662abdf.png" src="../../../../../_images/2030e3872df26494531c6967287a9738275118333aef2b6a683cf190a662abdf.png" />
</div>
</div>
<p>ok, done! and it only took us 10 years.</p>
<p>Maybe there is a better way?</p>
</section>
<section id="slightly-less-naive-approach-use-sktime-transformers-badly">
<h3>Slightly less naive approach - use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers (badly)<a class="headerlink" href="#slightly-less-naive-approach-use-sktime-transformers-badly" title="Link to this heading">#</a></h3>
<p>Ok, surely there is a way where I don’t have to fiddle with wildly varying interfaces of every step.</p>
<p>Solution: use transformers!</p>
<p>Same interface at every step!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.trend</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialTrendForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.boxcox</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.detrend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Deseasonalizer</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="n">t_log</span> <span class="o">=</span> <span class="n">LogTransformer</span><span class="p">()</span>
<span class="n">ylog</span> <span class="o">=</span> <span class="n">t_log</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">t_deseason</span> <span class="o">=</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">y_deseason</span> <span class="o">=</span> <span class="n">t_deseason</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ylog</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">PolynomialTrendForecaster</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_deseason</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)))</span>
<span class="n">y_fcst</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>hm, but now we need to invert the transformations…</p>
<p>fortunately transformers have an inverse transform, standard interface point</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_fcst_orig</span> <span class="o">=</span> <span class="n">t_deseason</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_fcst</span><span class="p">)</span>
<span class="c1"># the deseasonalizer remembered the seasonality component! nice!</span>

<span class="n">y_fcst_orig_orig</span> <span class="o">=</span> <span class="n">t_log</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_fcst_orig</span><span class="p">)</span>

<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_fcst_orig_orig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;,
 &lt;AxesSubplot: ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/2030e3872df26494531c6967287a9738275118333aef2b6a683cf190a662abdf.png" src="../../../../../_images/2030e3872df26494531c6967287a9738275118333aef2b6a683cf190a662abdf.png" />
</div>
</div>
</section>
<section id="expert-approach-use-sktime-transformers-with-pipelines">
<h3>Expert approach - use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers with pipelines!<a class="headerlink" href="#expert-approach-use-sktime-transformers-with-pipelines" title="Link to this heading">#</a></h3>
<p>Bragging rights included.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.trend</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialTrendForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.boxcox</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.detrend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Deseasonalizer</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">LogTransformer</span><span class="p">()</span> <span class="o">*</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">PolynomialTrendForecaster</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)))</span>
<span class="n">y_fcst</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_fcst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;,
 &lt;AxesSubplot: ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/2030e3872df26494531c6967287a9738275118333aef2b6a683cf190a662abdf.png" src="../../../../../_images/2030e3872df26494531c6967287a9738275118333aef2b6a683cf190a662abdf.png" />
</div>
</div>
<p>what happened here?</p>
<p>The “chain” operator <code class="docutils literal notranslate"><span class="pre">*</span></code> creates a “forecasting pipeline”</p>
<p>Has the same interface as all other forecasters! No additional data fiddling!</p>
<p>Transformers “slot in” as standardized components.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>TransformedTargetForecaster(steps=[LogTransformer(), Deseasonalizer(sp=12),
                                   PolynomialTrendForecaster(degree=2)])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">TransformedTargetForecaster</label><div class="sk-toggleable__content"><pre>TransformedTargetForecaster(steps=[LogTransformer(), Deseasonalizer(sp=12),
                                   PolynomialTrendForecaster(degree=2)])</pre></div></div></div></div></div></div></div>
</div>
<p>Let’s look at this in more detail:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers interface</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> pipeline building</p></li>
</ul>
</section>
</section>
<section id="transformers-interface-and-features">
<h2>3.2 Transformers - interface and features <a class="anchor" id="section_3_2"></a><a class="headerlink" href="#transformers-interface-and-features" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>transformer interface</p></li>
<li><p>transformer types</p></li>
<li><p>searching transformers by type</p></li>
<li><p>broadcasting/vectorization to panel &amp; hierarchical data</p></li>
<li><p>transformers and pipelines</p></li>
</ul>
<section id="what-are-transformers">
<h3>3.2.1 What are transformers? <a class="anchor" id="section_3_2_1"></a><a class="headerlink" href="#what-are-transformers" title="Link to this heading">#</a></h3>
<p>Transformer = modular data processing steps commonly used in machine learning</p>
<p>(“transformer” used in the sense of <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>)</p>
<p>Transformers are estimators that:</p>
<ul class="simple">
<li><p>are fitted to a batch of data via <code class="docutils literal notranslate"><span class="pre">fit(data)</span></code>, changing its state</p></li>
<li><p>are applied to another batch of data via <code class="docutils literal notranslate"><span class="pre">transform(X)</span></code>, producing transformed data</p></li>
<li><p>may have an <code class="docutils literal notranslate"><span class="pre">inverse_transform(X)</span></code></p></li>
</ul>
<p>In <code class="docutils literal notranslate"><span class="pre">sktime</span></code>, input <code class="docutils literal notranslate"><span class="pre">X</span></code> to <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> is typically a time series or a panel (collection of time series).</p>
<p>Basic use of an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> time series transformer is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. prepare the data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.series</span><span class="w"> </span><span class="kn">import</span> <span class="n">_make_series</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">_make_series</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>
<span class="c1"># X_train and X_test are both pandas.Series</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2000-01-01    4.708975
 2000-01-02    1.803052
 2000-01-03    2.403074
 2000-01-04    3.076577
 2000-01-05    2.902616
 2000-01-06    3.831219
 2000-01-07    2.121627
 Freq: D, dtype: float64,
 2000-01-08    4.858755
 2000-01-09    3.460329
 2000-01-10    2.280978
 2000-01-11    1.930733
 2000-01-12    4.604839
 Freq: D, dtype: float64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2. construct the transformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.boxcox</span><span class="w"> </span><span class="kn">import</span> <span class="n">BoxCoxTransformer</span>

<span class="c1"># trafo is an sktime estimator inheriting from BaseTransformer</span>
<span class="c1"># Box-Cox transform with lambda parameter fitted via mle</span>
<span class="n">trafo</span> <span class="o">=</span> <span class="n">BoxCoxTransformer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;mle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3. fit the transformer to training data</span>
<span class="n">trafo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># 4. apply the transformer to transform test data</span>
<span class="c1"># Box-Cox transform with lambda fitted on X_train</span>
<span class="n">X_transformed</span> <span class="o">=</span> <span class="n">trafo</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">X_transformed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-08    1.242107
2000-01-09    1.025417
2000-01-10    0.725243
2000-01-11    0.593567
2000-01-12    1.209380
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>If the training and test set is the same, step 3 and 4 can be carried out more concisely (and sometimes more efficiently) by using <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3+4. apply the transformer to fit and transform on the same data, X</span>
<span class="n">X_transformed</span> <span class="o">=</span> <span class="n">trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="different-types-of-transformers">
<h3>3.2.2 Different types of transformers <a class="anchor" id="section_3_2_2"></a><a class="headerlink" href="#different-types-of-transformers" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> distinguishes different types of transformer, depending on the input type of <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code>, and the output type of <code class="docutils literal notranslate"><span class="pre">transform</span></code>.</p>
<p>Transformers differ by:</p>
<ul class="simple">
<li><p>making use of an additional <code class="docutils literal notranslate"><span class="pre">y</span></code> argument in <code class="docutils literal notranslate"><span class="pre">fit</span></code> or <code class="docutils literal notranslate"><span class="pre">transform</span></code></p></li>
<li><p>whether the input to <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> is a single time series, a collection of time series, or scalar values (data frame row)</p></li>
<li><p>whether the output of <code class="docutils literal notranslate"><span class="pre">transform</span></code> is a single time series, a collection of time series, or scalar values (data frame row)</p></li>
<li><p>whether the input to <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> are one object or two. Two objects as input and a scalar output means the transformer is a distance or kernel function.</p></li>
</ul>
<p>More detail on this is given in the glossary (section 2.3).</p>
<p>To illustrate the difference, we compare two transformers with different output:</p>
<ul class="simple">
<li><p>the Box-Cox transformer <code class="docutils literal notranslate"><span class="pre">BoxCoxTrannsformer</span></code>, which transforms a time series to a time series</p></li>
<li><p>the summary transformer <code class="docutils literal notranslate"><span class="pre">SummaryTransformer</span></code>, which transforms a time series to scalars such as the mean</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># constructing the transformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.boxcox</span><span class="w"> </span><span class="kn">import</span> <span class="n">BoxCoxTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.summarize</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.series</span><span class="w"> </span><span class="kn">import</span> <span class="n">_make_series</span>

<span class="c1"># getting some data</span>
<span class="c1"># this is one pandas.Series</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">_make_series</span><span class="p">(</span><span class="n">n_timepoints</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># constructing the transformers</span>
<span class="n">boxcox_trafo</span> <span class="o">=</span> <span class="n">BoxCoxTransformer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;mle&quot;</span><span class="p">)</span>
<span class="n">summary_trafo</span> <span class="o">=</span> <span class="n">SummaryTransformer</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this produces a pandas Series</span>
<span class="n">boxcox_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000-01-01    3.217236
2000-01-02    6.125564
2000-01-03    5.264381
2000-01-04    3.811121
2000-01-05    1.966839
2000-01-06    2.621609
2000-01-07    3.851400
2000-01-08    3.199416
2000-01-09    0.000000
2000-01-10    6.629380
Freq: D, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this produces a pandas.DataFrame row</span>
<span class="n">summary_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>max</th>
      <th>0.1</th>
      <th>0.25</th>
      <th>0.5</th>
      <th>0.75</th>
      <th>0.9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.368131</td>
      <td>1.128705</td>
      <td>1.0</td>
      <td>4.881081</td>
      <td>2.339681</td>
      <td>2.963718</td>
      <td>3.376426</td>
      <td>4.0816</td>
      <td>4.67824</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For time series transformers, the metadata tags describe the expected output of <code class="docutils literal notranslate"><span class="pre">transform</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxcox_trafo</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s2">&quot;scitype:transform-output&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Series&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summary_trafo</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s2">&quot;scitype:transform-output&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Primitives&#39;
</pre></div>
</div>
</div>
</div>
<p>To find transformers, use <code class="docutils literal notranslate"><span class="pre">all_estimators</span></code> and filter by tags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;scitype:transform-output&quot;</span></code> - the output scitype. <code class="docutils literal notranslate"><span class="pre">Series</span></code> for time series, <code class="docutils literal notranslate"><span class="pre">Primitives</span></code> for primitive features (float, categories), <code class="docutils literal notranslate"><span class="pre">Panel</span></code> for collections of time series.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;scitype:transform-input&quot;</span></code> - the input scitype. <code class="docutils literal notranslate"><span class="pre">Series</span></code> for time series.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;scitype:instancewise&quot;</span></code> - If <code class="docutils literal notranslate"><span class="pre">True</span></code>, vectorized operation per series. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, uses multiple time series non-trivially.</p></li>
</ul>
<p>Example: find all transformers that output time series</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="c1"># now subset to transformers that extract scalar features</span>
<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;transformer&quot;</span><span class="p">,</span>
    <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;scitype:transform-output&quot;</span><span class="p">:</span> <span class="s2">&quot;Series&quot;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing plotly failed. Interactive plots will not work.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>estimator</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aggregator</td>
      <td>&lt;class 'sktime.transformations.hierarchical.ag...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AutoCorrelationTransformer</td>
      <td>&lt;class 'sktime.transformations.series.acf.Auto...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BoxCoxTransformer</td>
      <td>&lt;class 'sktime.transformations.series.boxcox.B...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ClaSPTransformer</td>
      <td>&lt;class 'sktime.transformations.series.clasp.Cl...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ClearSky</td>
      <td>&lt;class 'sktime.transformations.series.clear_sk...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>69</th>
      <td>TransformerPipeline</td>
      <td>&lt;class 'sktime.transformations.compose.Transfo...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>TruncationTransformer</td>
      <td>&lt;class 'sktime.transformations.panel.truncatio...</td>
    </tr>
    <tr>
      <th>71</th>
      <td>WhiteNoiseAugmenter</td>
      <td>&lt;class 'sktime.transformations.series.augmente...</td>
    </tr>
    <tr>
      <th>72</th>
      <td>WindowSummarizer</td>
      <td>&lt;class 'sktime.transformations.series.summariz...</td>
    </tr>
    <tr>
      <th>73</th>
      <td>YtoX</td>
      <td>&lt;class 'sktime.transformations.compose.YtoX'&gt;</td>
    </tr>
  </tbody>
</table>
<p>74 rows × 2 columns</p>
</div></div></div>
</div>
<p>A more complete overview on transformer types and tags is given in the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers tutorial.</p>
</section>
<section id="broadcasting-aka-vectorization-of-transformers">
<h3>3.2.3 Broadcasting aka vectorization of transformers <a class="anchor" id="section_3_2_3"></a><a class="headerlink" href="#broadcasting-aka-vectorization-of-transformers" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers may be natively univariate, or apply only to a single time series.</p>
<p>Even if this is the case, they broadcast across variables and instances of time series, where applicable (also known as vectorization in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> parlance).</p>
<p>This ensures that all <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers can be applied to multivariate and multi-instance (panel, hierarchical) time series data.</p>
<p>Example 1: broadcasting/vectorization of time series to time series transformer</p>
<p>The <code class="docutils literal notranslate"><span class="pre">BoxCoxTransformer</span></code> from previous sections applies to single instances of univariate time series. When multiple instances or variables are seen, it broadcasts across both:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.boxcox</span><span class="w"> </span><span class="kn">import</span> <span class="n">BoxCoxTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.hierarchical</span><span class="w"> </span><span class="kn">import</span> <span class="n">_make_hierarchical</span>

<span class="c1"># hierarchical data with 2 variables and 2 levels</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">_make_hierarchical</span><span class="p">(</span><span class="n">n_columns</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>c0</th>
      <th>c1</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th>time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">h0_0</th>
      <th rowspan="5" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>3.068024</td>
      <td>3.177475</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.917533</td>
      <td>3.615065</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>3.654595</td>
      <td>3.327944</td>
    </tr>
    <tr>
      <th>2000-01-04</th>
      <td>2.848652</td>
      <td>4.694433</td>
    </tr>
    <tr>
      <th>2000-01-05</th>
      <td>3.458690</td>
      <td>3.349914</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">h0_1</th>
      <th rowspan="5" valign="top">h1_3</th>
      <th>2000-01-08</th>
      <td>4.056444</td>
      <td>3.726508</td>
    </tr>
    <tr>
      <th>2000-01-09</th>
      <td>2.462253</td>
      <td>3.938115</td>
    </tr>
    <tr>
      <th>2000-01-10</th>
      <td>2.689640</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2000-01-11</th>
      <td>1.233706</td>
      <td>3.999155</td>
    </tr>
    <tr>
      <th>2000-01-12</th>
      <td>3.101318</td>
      <td>3.632666</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># constructing the transformers</span>
<span class="n">boxcox_trafo</span> <span class="o">=</span> <span class="n">BoxCoxTransformer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;mle&quot;</span><span class="p">)</span>

<span class="c1"># applying to X results in hierarchical data</span>
<span class="n">boxcox_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>c0</th>
      <th>c1</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th>time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">h0_0</th>
      <th rowspan="5" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>0.307301</td>
      <td>3.456645</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>0.305723</td>
      <td>4.416187</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>0.311191</td>
      <td>3.777609</td>
    </tr>
    <tr>
      <th>2000-01-04</th>
      <td>0.304881</td>
      <td>7.108861</td>
    </tr>
    <tr>
      <th>2000-01-05</th>
      <td>0.310189</td>
      <td>3.825267</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">h0_1</th>
      <th rowspan="5" valign="top">h1_3</th>
      <th>2000-01-08</th>
      <td>1.884165</td>
      <td>9.828613</td>
    </tr>
    <tr>
      <th>2000-01-09</th>
      <td>1.087370</td>
      <td>11.311330</td>
    </tr>
    <tr>
      <th>2000-01-10</th>
      <td>1.216886</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2000-01-11</th>
      <td>0.219210</td>
      <td>11.761224</td>
    </tr>
    <tr>
      <th>2000-01-12</th>
      <td>1.435712</td>
      <td>9.208733</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 2 columns</p>
</div></div></div>
</div>
<p>Fitted model components of vectorized transformers can be found in the <code class="docutils literal notranslate"><span class="pre">transformers_</span></code> attribute, or accessed via the universal <code class="docutils literal notranslate"><span class="pre">get_fitted_params</span></code> interface:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxcox_trafo</span><span class="o">.</span><span class="n">transformers_</span>
<span class="c1"># this is a pandas.DataFrame that contains the fitted transformers</span>
<span class="c1"># one per time series instance and variable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>c0</th>
      <th>c1</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">h0_0</th>
      <th>h1_0</th>
      <td>BoxCoxTransformer()</td>
      <td>BoxCoxTransformer()</td>
    </tr>
    <tr>
      <th>h1_1</th>
      <td>BoxCoxTransformer()</td>
      <td>BoxCoxTransformer()</td>
    </tr>
    <tr>
      <th>h1_2</th>
      <td>BoxCoxTransformer()</td>
      <td>BoxCoxTransformer()</td>
    </tr>
    <tr>
      <th>h1_3</th>
      <td>BoxCoxTransformer()</td>
      <td>BoxCoxTransformer()</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">h0_1</th>
      <th>h1_0</th>
      <td>BoxCoxTransformer()</td>
      <td>BoxCoxTransformer()</td>
    </tr>
    <tr>
      <th>h1_1</th>
      <td>BoxCoxTransformer()</td>
      <td>BoxCoxTransformer()</td>
    </tr>
    <tr>
      <th>h1_2</th>
      <td>BoxCoxTransformer()</td>
      <td>BoxCoxTransformer()</td>
    </tr>
    <tr>
      <th>h1_3</th>
      <td>BoxCoxTransformer()</td>
      <td>BoxCoxTransformer()</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxcox_trafo</span><span class="o">.</span><span class="n">get_fitted_params</span><span class="p">()</span>
<span class="c1"># this returns a dictionary</span>
<span class="c1"># the transformers DataFrame is available at the key &quot;transformers&quot;</span>
<span class="c1"># individual transformers are available at dataframe-like keys</span>
<span class="c1"># it also contains all fitted lambdas as keyed parameters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;transformers&#39;:                             c0                   c1
 h0   h1                                            
 h0_0 h1_0  BoxCoxTransformer()  BoxCoxTransformer()
      h1_1  BoxCoxTransformer()  BoxCoxTransformer()
      h1_2  BoxCoxTransformer()  BoxCoxTransformer()
      h1_3  BoxCoxTransformer()  BoxCoxTransformer()
 h0_1 h1_0  BoxCoxTransformer()  BoxCoxTransformer()
      h1_1  BoxCoxTransformer()  BoxCoxTransformer()
      h1_2  BoxCoxTransformer()  BoxCoxTransformer()
      h1_3  BoxCoxTransformer()  BoxCoxTransformer(),
 &quot;transformers.loc[(&#39;h0_0&#39;, &#39;h1_0&#39;),c0]&quot;: BoxCoxTransformer(),
 &quot;transformers.loc[(&#39;h0_0&#39;, &#39;h1_0&#39;),c0]__lambda&quot;: -3.1599525634239187,
 &quot;transformers.loc[(&#39;h0_0&#39;, &#39;h1_1&#39;),c1]&quot;: BoxCoxTransformer(),
 &quot;transformers.loc[(&#39;h0_0&#39;, &#39;h1_1&#39;),c1]__lambda&quot;: 0.37511296223989965}
</pre></div>
</div>
</div>
</div>
<p>Example 2: broadcasting/vectorization of time series to scalar features transformer</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SummaryTransformer</span></code> behaves similarly.
Multiple time series instances are transformed to different columns of the resulting data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.summarize</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryTransformer</span>

<span class="n">summary_trafo</span> <span class="o">=</span> <span class="n">SummaryTransformer</span><span class="p">()</span>

<span class="c1"># this produces a pandas DataFrame with more rows and columns</span>
<span class="c1"># rows correspond to different instances in X</span>
<span class="c1"># columns are multiplied and names prefixed by [variablename]__</span>
<span class="c1"># there is one column per variable and transformed feature</span>
<span class="n">summary_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>c0__mean</th>
      <th>c0__std</th>
      <th>c0__min</th>
      <th>c0__max</th>
      <th>c0__0.1</th>
      <th>c0__0.25</th>
      <th>c0__0.5</th>
      <th>c0__0.75</th>
      <th>c0__0.9</th>
      <th>c1__mean</th>
      <th>c1__std</th>
      <th>c1__min</th>
      <th>c1__max</th>
      <th>c1__0.1</th>
      <th>c1__0.25</th>
      <th>c1__0.5</th>
      <th>c1__0.75</th>
      <th>c1__0.9</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">h0_0</th>
      <th>h1_0</th>
      <td>3.202174</td>
      <td>0.732349</td>
      <td>2.498101</td>
      <td>5.283440</td>
      <td>2.709206</td>
      <td>2.834797</td>
      <td>2.975883</td>
      <td>3.348140</td>
      <td>3.635005</td>
      <td>3.360042</td>
      <td>0.744295</td>
      <td>1.910203</td>
      <td>4.694433</td>
      <td>2.278782</td>
      <td>3.194950</td>
      <td>3.377147</td>
      <td>3.722876</td>
      <td>3.981182</td>
    </tr>
    <tr>
      <th>h1_1</th>
      <td>2.594633</td>
      <td>0.850142</td>
      <td>1.000000</td>
      <td>4.040674</td>
      <td>1.618444</td>
      <td>1.988190</td>
      <td>2.742309</td>
      <td>3.084133</td>
      <td>3.349082</td>
      <td>3.637274</td>
      <td>1.006419</td>
      <td>2.376048</td>
      <td>5.112509</td>
      <td>2.402845</td>
      <td>2.703573</td>
      <td>3.644124</td>
      <td>4.535796</td>
      <td>4.873311</td>
    </tr>
    <tr>
      <th>h1_2</th>
      <td>3.649374</td>
      <td>1.181054</td>
      <td>1.422356</td>
      <td>5.359634</td>
      <td>2.249409</td>
      <td>2.881057</td>
      <td>3.813969</td>
      <td>4.319322</td>
      <td>5.021987</td>
      <td>2.945555</td>
      <td>1.245355</td>
      <td>1.684464</td>
      <td>6.469536</td>
      <td>1.795508</td>
      <td>2.324243</td>
      <td>2.757053</td>
      <td>3.159779</td>
      <td>3.547420</td>
    </tr>
    <tr>
      <th>h1_3</th>
      <td>2.865339</td>
      <td>0.745604</td>
      <td>1.654998</td>
      <td>4.718420</td>
      <td>2.313490</td>
      <td>2.477173</td>
      <td>2.839630</td>
      <td>3.137472</td>
      <td>3.372838</td>
      <td>3.394633</td>
      <td>0.971250</td>
      <td>1.866518</td>
      <td>5.236633</td>
      <td>2.506371</td>
      <td>2.653524</td>
      <td>3.259750</td>
      <td>4.192159</td>
      <td>4.419325</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">h0_1</th>
      <th>h1_0</th>
      <td>2.946692</td>
      <td>1.025167</td>
      <td>1.085568</td>
      <td>5.159135</td>
      <td>1.933525</td>
      <td>2.375844</td>
      <td>2.952310</td>
      <td>3.412478</td>
      <td>3.687086</td>
      <td>3.203431</td>
      <td>0.970914</td>
      <td>1.554428</td>
      <td>4.546142</td>
      <td>1.756260</td>
      <td>2.405147</td>
      <td>3.544128</td>
      <td>3.954901</td>
      <td>4.046171</td>
    </tr>
    <tr>
      <th>h1_1</th>
      <td>3.274710</td>
      <td>0.883594</td>
      <td>1.930773</td>
      <td>4.771649</td>
      <td>1.988411</td>
      <td>2.710401</td>
      <td>3.434244</td>
      <td>3.799033</td>
      <td>4.167242</td>
      <td>3.116279</td>
      <td>0.604060</td>
      <td>2.235531</td>
      <td>4.167924</td>
      <td>2.426392</td>
      <td>2.655720</td>
      <td>3.079178</td>
      <td>3.660901</td>
      <td>3.762036</td>
    </tr>
    <tr>
      <th>h1_2</th>
      <td>3.397527</td>
      <td>0.630344</td>
      <td>2.277090</td>
      <td>4.571272</td>
      <td>2.791987</td>
      <td>2.965040</td>
      <td>3.457581</td>
      <td>3.783002</td>
      <td>4.031893</td>
      <td>3.297039</td>
      <td>0.938834</td>
      <td>1.826276</td>
      <td>4.919249</td>
      <td>2.292343</td>
      <td>2.646870</td>
      <td>3.139703</td>
      <td>3.975298</td>
      <td>4.365553</td>
    </tr>
    <tr>
      <th>h1_3</th>
      <td>3.356722</td>
      <td>1.326547</td>
      <td>1.233706</td>
      <td>5.505544</td>
      <td>2.467667</td>
      <td>2.567089</td>
      <td>2.884737</td>
      <td>4.308726</td>
      <td>5.273261</td>
      <td>3.232578</td>
      <td>1.003957</td>
      <td>1.000000</td>
      <td>4.234051</td>
      <td>2.113028</td>
      <td>2.568151</td>
      <td>3.659943</td>
      <td>3.953375</td>
      <td>4.022143</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="transformers-as-pipeline-components">
<h3>3.2.4 Transformers as pipeline components <a class="anchor" id="section_3_2_4"></a><a class="headerlink" href="#transformers-as-pipeline-components" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers can be pipelined with any other <code class="docutils literal notranslate"><span class="pre">sktime</span></code> estimator type, including forecasters, classifiers, and other transformers.</p>
<p>Pipelines = estimators of the same type, same interface as specialized class</p>
<p>pipeline build operation: <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code> or via <code class="docutils literal notranslate"><span class="pre">*</span></code> dunder</p>
<p>Pipelining <code class="docutils literal notranslate"><span class="pre">pipe</span> <span class="pre">=</span> <span class="pre">trafo</span> <span class="pre">*</span> <span class="pre">est</span></code> produces <code class="docutils literal notranslate"><span class="pre">pipe</span></code> of same type as <code class="docutils literal notranslate"><span class="pre">est</span></code>.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">pipe.fit</span></code>, first <code class="docutils literal notranslate"><span class="pre">trafo.fit_transform</span></code>, then <code class="docutils literal notranslate"><span class="pre">est.fit</span></code> is executed on the result.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">pipe.predict</span></code>, first <code class="docutils literal notranslate"><span class="pre">trafo.transform</span></code>, then <code class="docutils literal notranslate"><span class="pre">est.predict</span></code> is executed.</p>
<p>(the arguments that are piped differ by type and can be looked up in the docstrings of pipeline classes, or specialized tutorials)</p>
<section id="example-1-forecaster-pipeline">
<h4>Example 1: forecaster pipeline<a class="headerlink" href="#example-1-forecaster-pipeline" title="Link to this heading">#</a></h4>
<p>we have seen this example above</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.trend</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialTrendForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.boxcox</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.detrend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Deseasonalizer</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">LogTransformer</span><span class="p">()</span> <span class="o">*</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">PolynomialTrendForecaster</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">pipe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>TransformedTargetForecaster(steps=[LogTransformer(), Deseasonalizer(sp=12),
                                   PolynomialTrendForecaster(degree=2)])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">TransformedTargetForecaster</label><div class="sk-toggleable__content"><pre>TransformedTargetForecaster(steps=[LogTransformer(), Deseasonalizer(sp=12),
                                   PolynomialTrendForecaster(degree=2)])</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is a forecaster with the same interface as Polynomial Trend Forecaster</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;,
 &lt;AxesSubplot: ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/9ad28bc4751afd42b32a9cf1839098a919b649e3c359b76f1bff12edf280ce83.png" src="../../../../../_images/9ad28bc4751afd42b32a9cf1839098a919b649e3c359b76f1bff12edf280ce83.png" />
</div>
</div>
</section>
<section id="example-2-classifier-pipeline">
<h4>Example 2: classifier pipeline<a class="headerlink" href="#example-2-classifier-pipeline" title="Link to this heading">#</a></h4>
<p>works the same with classifiers or other estimator types!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.exponent</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentTransformer</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">ExponentTransformer</span><span class="p">()</span> <span class="o">*</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">()</span>

<span class="c1"># this constructs a ClassifierPipeline, which is also a classifier</span>
<span class="n">pipe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ClassifierPipeline(classifier=KNeighborsTimeSeriesClassifier(),
                   transformers=[ExponentTransformer()])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">ClassifierPipeline</label><div class="sk-toggleable__content"><pre>ClassifierPipeline(classifier=KNeighborsTimeSeriesClassifier(),
                   transformers=[ExponentTransformer()])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" ><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">classifier: KNeighborsTimeSeriesClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsTimeSeriesClassifier()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" ><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsTimeSeriesClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsTimeSeriesClassifier()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_unit_test</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_unit_test</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;TRAIN&quot;</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_unit_test</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;TEST&quot;</span><span class="p">)</span>

<span class="c1"># this is a forecaster with the same interface as knn-classifier</span>
<span class="c1"># first applies exponent transform, then knn-classifier</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ClassifierPipeline(classifier=KNeighborsTimeSeriesClassifier(),
                   transformers=[ExponentTransformer()])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" ><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">ClassifierPipeline</label><div class="sk-toggleable__content"><pre>ClassifierPipeline(classifier=KNeighborsTimeSeriesClassifier(),
                   transformers=[ExponentTransformer()])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" ><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">classifier: KNeighborsTimeSeriesClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsTimeSeriesClassifier()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" ><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsTimeSeriesClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsTimeSeriesClassifier()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</section>
</section>
</section>
<section id="combining-transformers-feature-engineering">
<h2>3.3 Combining transformers, feature engineering <a class="anchor" id="section_3_3"></a><a class="headerlink" href="#combining-transformers-feature-engineering" title="Link to this heading">#</a></h2>
<p>transformers are natural pipeline components</p>
<ul class="simple">
<li><p>data processing steps</p></li>
<li><p>feature engineering steps</p></li>
<li><p>post processing steps</p></li>
</ul>
<p>they can be combined in a number of other ways:</p>
<ul class="simple">
<li><p>pipelining = sequential chaining</p></li>
<li><p>feature union = parallel, addition of features</p></li>
<li><p>feature subsetting = selecting columns</p></li>
<li><p>inversion = switch transform and inverse</p></li>
<li><p>multiplexing = switching between transformers</p></li>
<li><p>passthrough = switch on/ off</p></li>
</ul>
<section id="chaining-transformers-via">
<h3>Chaining transformers via <code class="docutils literal notranslate"><span class="pre">*</span></code><a class="headerlink" href="#chaining-transformers-via" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.difference</span><span class="w"> </span><span class="kn">import</span> <span class="n">Differencer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.summarize</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryTransformer</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Differencer</span><span class="p">()</span> <span class="o">*</span> <span class="n">SummaryTransformer</span><span class="p">()</span>

<span class="c1"># this constructs a TransformerPipeline, which is also a transformer</span>
<span class="n">pipe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-5 {color: black;background-color: white;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>TransformerPipeline(steps=[Differencer(), SummaryTransformer()])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" checked><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">TransformerPipeline</label><div class="sk-toggleable__content"><pre>TransformerPipeline(steps=[Differencer(), SummaryTransformer()])</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.hierarchical</span><span class="w"> </span><span class="kn">import</span> <span class="n">_bottom_hier_datagen</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">_bottom_hier_datagen</span><span class="p">(</span><span class="n">no_levels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">no_bottom_nodes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># this is a transformer with the same interface</span>
<span class="c1"># first applies differencer, then summary transform</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>max</th>
      <th>0.1</th>
      <th>0.25</th>
      <th>0.5</th>
      <th>0.75</th>
      <th>0.9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.222222</td>
      <td>33.636569</td>
      <td>-101.0</td>
      <td>87.00</td>
      <td>-37.700</td>
      <td>-16.000</td>
      <td>3.50</td>
      <td>22.25</td>
      <td>43.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48.111111</td>
      <td>810.876526</td>
      <td>-2680.3</td>
      <td>2416.86</td>
      <td>-826.462</td>
      <td>-323.145</td>
      <td>76.33</td>
      <td>448.86</td>
      <td>1021.974</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>compatible with sklearn transformers!</p>
<p>default applies sklearn transformer per individual time series as a data frame table</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Differencer</span><span class="p">()</span> <span class="o">*</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">pipe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-6 {color: black;background-color: white;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>TransformerPipeline(steps=[Differencer(),
                           TabularToSeriesAdaptor(transformer=StandardScaler())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox" checked><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">TransformerPipeline</label><div class="sk-toggleable__content"><pre>TransformerPipeline(steps=[Differencer(),
                           TabularToSeriesAdaptor(transformer=StandardScaler())])</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>passengers</th>
    </tr>
    <tr>
      <th>l1_agg</th>
      <th>timepoints</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">l1_node01</th>
      <th>1949-01</th>
      <td>-0.066296</td>
    </tr>
    <tr>
      <th>1949-02</th>
      <td>0.112704</td>
    </tr>
    <tr>
      <th>1949-03</th>
      <td>0.351370</td>
    </tr>
    <tr>
      <th>1949-04</th>
      <td>-0.155796</td>
    </tr>
    <tr>
      <th>1949-05</th>
      <td>-0.304963</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">l1_node02</th>
      <th>1960-08</th>
      <td>-0.623659</td>
    </tr>
    <tr>
      <th>1960-09</th>
      <td>-3.376512</td>
    </tr>
    <tr>
      <th>1960-10</th>
      <td>-1.565994</td>
    </tr>
    <tr>
      <th>1960-11</th>
      <td>-2.231567</td>
    </tr>
    <tr>
      <th>1960-12</th>
      <td>1.210249</td>
    </tr>
  </tbody>
</table>
<p>288 rows × 1 columns</p>
</div></div></div>
</div>
<p>pipeline-adaptor chains can be constructed manually:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sktime.transformations.compose.TransformerPipeline</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sktime.transformations.series.adapt.TabularToSeriesAdaptor</span></code> for <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></p></li>
</ul>
<p>composites are compatible with <code class="docutils literal notranslate"><span class="pre">get_params</span></code> / <code class="docutils literal notranslate"><span class="pre">set_params</span></code> parameter interface:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;steps&#39;: [Differencer(),
  TabularToSeriesAdaptor(transformer=StandardScaler())],
 &#39;Differencer&#39;: Differencer(),
 &#39;TabularToSeriesAdaptor&#39;: TabularToSeriesAdaptor(transformer=StandardScaler()),
 &#39;Differencer__lags&#39;: 1,
 &#39;Differencer__memory&#39;: &#39;all&#39;,
 &#39;Differencer__na_handling&#39;: &#39;fill_zero&#39;,
 &#39;TabularToSeriesAdaptor__fit_in_transform&#39;: False,
 &#39;TabularToSeriesAdaptor__transformer__copy&#39;: True,
 &#39;TabularToSeriesAdaptor__transformer__with_mean&#39;: True,
 &#39;TabularToSeriesAdaptor__transformer__with_std&#39;: True,
 &#39;TabularToSeriesAdaptor__transformer&#39;: StandardScaler()}
</pre></div>
</div>
</div>
</div>
</section>
<section id="feature-union-via">
<h3>Feature union via <code class="docutils literal notranslate"><span class="pre">+</span></code><a class="headerlink" href="#feature-union-via" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.difference</span><span class="w"> </span><span class="kn">import</span> <span class="n">Differencer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.lag</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lag</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Differencer</span><span class="p">()</span> <span class="o">+</span> <span class="n">Lag</span><span class="p">()</span>

<span class="c1"># this constructs a FeatureUnion, which is also a transformer</span>
<span class="n">pipe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-7 {color: black;background-color: white;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>FeatureUnion(transformer_list=[Differencer(), Lag()])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox" checked><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">FeatureUnion</label><div class="sk-toggleable__content"><pre>FeatureUnion(transformer_list=[Differencer(), Lag()])</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.hierarchical</span><span class="w"> </span><span class="kn">import</span> <span class="n">_bottom_hier_datagen</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">_bottom_hier_datagen</span><span class="p">(</span><span class="n">no_levels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">no_bottom_nodes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># applies both Differencer and Lag, returns transformed in different columns</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Differencer__passengers</th>
      <th>Lag__lag_0__passengers</th>
    </tr>
    <tr>
      <th>l1_agg</th>
      <th>timepoints</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">l1_node01</th>
      <th>1949-01</th>
      <td>0.00</td>
      <td>112.00</td>
    </tr>
    <tr>
      <th>1949-02</th>
      <td>6.00</td>
      <td>118.00</td>
    </tr>
    <tr>
      <th>1949-03</th>
      <td>14.00</td>
      <td>132.00</td>
    </tr>
    <tr>
      <th>1949-04</th>
      <td>-3.00</td>
      <td>129.00</td>
    </tr>
    <tr>
      <th>1949-05</th>
      <td>-8.00</td>
      <td>121.00</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">l1_node02</th>
      <th>1960-08</th>
      <td>-1920.80</td>
      <td>38845.27</td>
    </tr>
    <tr>
      <th>1960-09</th>
      <td>-10759.42</td>
      <td>28085.85</td>
    </tr>
    <tr>
      <th>1960-10</th>
      <td>-4546.78</td>
      <td>23539.07</td>
    </tr>
    <tr>
      <th>1960-11</th>
      <td>-6114.52</td>
      <td>17424.55</td>
    </tr>
    <tr>
      <th>1960-12</th>
      <td>3507.42</td>
      <td>20931.97</td>
    </tr>
  </tbody>
</table>
<p>288 rows × 2 columns</p>
</div></div></div>
</div>
<p>to retain the original columns, use the <code class="docutils literal notranslate"><span class="pre">Id</span></code> transformer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">Id</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.difference</span><span class="w"> </span><span class="kn">import</span> <span class="n">Differencer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.lag</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lag</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Id</span><span class="p">()</span> <span class="o">+</span> <span class="n">Differencer</span><span class="p">()</span> <span class="o">+</span> <span class="n">Lag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">index_out</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">)</span>

<span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Id__passengers</th>
      <th>Differencer__passengers</th>
      <th>Lag__lag_1__passengers</th>
      <th>Lag__lag_2__passengers</th>
    </tr>
    <tr>
      <th>l1_agg</th>
      <th>timepoints</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">l1_node01</th>
      <th>1949-01</th>
      <td>112.00</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1949-02</th>
      <td>118.00</td>
      <td>6.00</td>
      <td>112.00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1949-03</th>
      <td>132.00</td>
      <td>14.00</td>
      <td>118.00</td>
      <td>112.00</td>
    </tr>
    <tr>
      <th>1949-04</th>
      <td>129.00</td>
      <td>-3.00</td>
      <td>132.00</td>
      <td>118.00</td>
    </tr>
    <tr>
      <th>1949-05</th>
      <td>121.00</td>
      <td>-8.00</td>
      <td>129.00</td>
      <td>132.00</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">l1_node02</th>
      <th>1960-08</th>
      <td>38845.27</td>
      <td>-1920.80</td>
      <td>40766.07</td>
      <td>30877.65</td>
    </tr>
    <tr>
      <th>1960-09</th>
      <td>28085.85</td>
      <td>-10759.42</td>
      <td>38845.27</td>
      <td>40766.07</td>
    </tr>
    <tr>
      <th>1960-10</th>
      <td>23539.07</td>
      <td>-4546.78</td>
      <td>28085.85</td>
      <td>38845.27</td>
    </tr>
    <tr>
      <th>1960-11</th>
      <td>17424.55</td>
      <td>-6114.52</td>
      <td>23539.07</td>
      <td>28085.85</td>
    </tr>
    <tr>
      <th>1960-12</th>
      <td>20931.97</td>
      <td>3507.42</td>
      <td>17424.55</td>
      <td>23539.07</td>
    </tr>
  </tbody>
</table>
<p>288 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter inspection</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;flatten_transform_index&#39;: True,
 &#39;n_jobs&#39;: None,
 &#39;transformer_list&#39;: [Id(),
  Differencer(),
  Lag(index_out=&#39;original&#39;, lags=[1, 2])],
 &#39;transformer_weights&#39;: None,
 &#39;Id&#39;: Id(),
 &#39;Differencer&#39;: Differencer(),
 &#39;Lag&#39;: Lag(index_out=&#39;original&#39;, lags=[1, 2]),
 &#39;Id___output_convert&#39;: &#39;auto&#39;,
 &#39;Differencer__lags&#39;: 1,
 &#39;Differencer__memory&#39;: &#39;all&#39;,
 &#39;Differencer__na_handling&#39;: &#39;fill_zero&#39;,
 &#39;Lag__flatten_transform_index&#39;: True,
 &#39;Lag__freq&#39;: None,
 &#39;Lag__index_out&#39;: &#39;original&#39;,
 &#39;Lag__keep_column_names&#39;: False,
 &#39;Lag__lags&#39;: [1, 2]}
</pre></div>
</div>
</div>
</div>
</section>
<section id="subset-input-columns-via-colname">
<h3>Subset input columns via <code class="docutils literal notranslate"><span class="pre">[colname]</span></code><a class="headerlink" href="#subset-input-columns-via-colname" title="Link to this heading">#</a></h3>
<p>let’s say we want to apply <code class="docutils literal notranslate"><span class="pre">Differencer</span></code> to column 0, and <code class="docutils literal notranslate"><span class="pre">Lag</span></code> to column 1</p>
<p>also we keep the original columns for illustration</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.hierarchical</span><span class="w"> </span><span class="kn">import</span> <span class="n">_make_hierarchical</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">_make_hierarchical</span><span class="p">(</span>
    <span class="n">hierarchy_levels</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">n_columns</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_timepoints</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_timepoints</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>

<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>c0</th>
      <th>c1</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th>time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">h0_0</th>
      <th rowspan="3" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>3.356766</td>
      <td>2.649204</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.262487</td>
      <td>2.204119</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>2.087692</td>
      <td>2.186494</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_1</th>
      <th>2000-01-01</th>
      <td>4.311237</td>
      <td>3.129610</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>3.190134</td>
      <td>1.747807</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>4.231399</td>
      <td>2.483151</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">h0_1</th>
      <th rowspan="3" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>4.356575</td>
      <td>3.550554</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.865619</td>
      <td>2.783107</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>3.781770</td>
      <td>2.619533</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_1</th>
      <th>2000-01-01</th>
      <td>3.113704</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.673081</td>
      <td>2.561047</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>1.000000</td>
      <td>2.953516</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">Id</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.difference</span><span class="w"> </span><span class="kn">import</span> <span class="n">Differencer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.lag</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lag</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Id</span><span class="p">()</span> <span class="o">+</span> <span class="n">Differencer</span><span class="p">()[</span><span class="s2">&quot;c0&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">Lag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">index_out</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">)[</span><span class="s2">&quot;c1&quot;</span><span class="p">]</span>

<span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>Id__c0</th>
      <th>Id__c1</th>
      <th>TransformerPipeline_1__c0</th>
      <th>TransformerPipeline_2__lag_1__c1</th>
      <th>TransformerPipeline_2__lag_2__c1</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">h0_0</th>
      <th rowspan="3" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>3.356766</td>
      <td>2.649204</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.262487</td>
      <td>2.204119</td>
      <td>-1.094279</td>
      <td>2.649204</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>2.087692</td>
      <td>2.186494</td>
      <td>-0.174795</td>
      <td>2.204119</td>
      <td>2.649204</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_1</th>
      <th>2000-01-01</th>
      <td>4.311237</td>
      <td>3.129610</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>3.190134</td>
      <td>1.747807</td>
      <td>-1.121103</td>
      <td>3.129610</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>4.231399</td>
      <td>2.483151</td>
      <td>1.041265</td>
      <td>1.747807</td>
      <td>3.129610</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">h0_1</th>
      <th rowspan="3" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>4.356575</td>
      <td>3.550554</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.865619</td>
      <td>2.783107</td>
      <td>-1.490956</td>
      <td>3.550554</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>3.781770</td>
      <td>2.619533</td>
      <td>0.916151</td>
      <td>2.783107</td>
      <td>3.550554</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_1</th>
      <th>2000-01-01</th>
      <td>3.113704</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.673081</td>
      <td>2.561047</td>
      <td>-0.440623</td>
      <td>1.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>1.000000</td>
      <td>2.953516</td>
      <td>-1.673081</td>
      <td>2.561047</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>auto-generated names can be replaced by using <code class="docutils literal notranslate"><span class="pre">FeatureUnion</span></code> explicitly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureUnion</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">FeatureUnion</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">Id</span><span class="p">()),</span>
        <span class="p">(</span><span class="s2">&quot;diff&quot;</span><span class="p">,</span> <span class="n">Differencer</span><span class="p">()[</span><span class="s2">&quot;c0&quot;</span><span class="p">]),</span>
        <span class="p">(</span><span class="s2">&quot;lag&quot;</span><span class="p">,</span> <span class="n">Lag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">index_out</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">pipe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>original__c0</th>
      <th>original__c1</th>
      <th>diff__c0</th>
      <th>lag__lag_1__c0</th>
      <th>lag__lag_1__c1</th>
      <th>lag__lag_2__c0</th>
      <th>lag__lag_2__c1</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">h0_0</th>
      <th rowspan="3" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>3.356766</td>
      <td>2.649204</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.262487</td>
      <td>2.204119</td>
      <td>-1.094279</td>
      <td>3.356766</td>
      <td>2.649204</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>2.087692</td>
      <td>2.186494</td>
      <td>-0.174795</td>
      <td>2.262487</td>
      <td>2.204119</td>
      <td>3.356766</td>
      <td>2.649204</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_1</th>
      <th>2000-01-01</th>
      <td>4.311237</td>
      <td>3.129610</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>3.190134</td>
      <td>1.747807</td>
      <td>-1.121103</td>
      <td>4.311237</td>
      <td>3.129610</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>4.231399</td>
      <td>2.483151</td>
      <td>1.041265</td>
      <td>3.190134</td>
      <td>1.747807</td>
      <td>4.311237</td>
      <td>3.129610</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">h0_1</th>
      <th rowspan="3" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>4.356575</td>
      <td>3.550554</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.865619</td>
      <td>2.783107</td>
      <td>-1.490956</td>
      <td>4.356575</td>
      <td>3.550554</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>3.781770</td>
      <td>2.619533</td>
      <td>0.916151</td>
      <td>2.865619</td>
      <td>2.783107</td>
      <td>4.356575</td>
      <td>3.550554</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_1</th>
      <th>2000-01-01</th>
      <td>3.113704</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>2.673081</td>
      <td>2.561047</td>
      <td>-0.440623</td>
      <td>3.113704</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>1.000000</td>
      <td>2.953516</td>
      <td>-1.673081</td>
      <td>2.673081</td>
      <td>2.561047</td>
      <td>3.113704</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="turning-log-transform-into-exp-transform-via-invert">
<h3>turning log transform into exp transform via invert <code class="docutils literal notranslate"><span class="pre">~</span></code><a class="headerlink" href="#turning-log-transform-into-exp-transform-via-invert" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.boxcox</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogTransformer</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">LogTransformer</span><span class="p">()</span>

<span class="n">exp</span> <span class="o">=</span> <span class="o">~</span><span class="n">log</span>

<span class="c1"># this behaves like an &quot;e to the power of&quot; transformer now</span>
<span class="n">exp</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 2.71828183,  7.3890561 , 20.08553692])
</pre></div>
</div>
</div>
</div>
</section>
<section id="automl-structure-compositors-multiplexer-switch-and-on-off-switch">
<h3>autoML structure compositors: multiplexer switch <code class="docutils literal notranslate"><span class="pre">¦</span></code> and on/off switch <code class="docutils literal notranslate"><span class="pre">-</span></code><a class="headerlink" href="#automl-structure-compositors-multiplexer-switch-and-on-off-switch" title="Link to this heading">#</a></h3>
<p>expose decisions as parameter</p>
<ul class="simple">
<li><p>do we want differencer <em>or</em> lag? for tuning later</p></li>
<li><p>do we want [differencer and lag] or [original features and lag] ? for tuning later</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># differencer or lag</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.difference</span><span class="w"> </span><span class="kn">import</span> <span class="n">Differencer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.lag</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lag</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Differencer</span><span class="p">()</span> <span class="o">|</span> <span class="n">Lag</span><span class="p">()</span>

<span class="n">pipe</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;selected_transformer&#39;: None,
 &#39;transformers&#39;: [Differencer(), Lag()],
 &#39;Differencer&#39;: Differencer(),
 &#39;Lag&#39;: Lag(),
 &#39;Differencer__lags&#39;: 1,
 &#39;Differencer__memory&#39;: &#39;all&#39;,
 &#39;Differencer__na_handling&#39;: &#39;fill_zero&#39;,
 &#39;Lag__flatten_transform_index&#39;: True,
 &#39;Lag__freq&#39;: None,
 &#39;Lag__index_out&#39;: &#39;extend&#39;,
 &#39;Lag__keep_column_names&#39;: False,
 &#39;Lag__lags&#39;: 0}
</pre></div>
</div>
</div>
</div>
<p>the <code class="docutils literal notranslate"><span class="pre">selected_transformer</span></code> parameter exposes the choice:</p>
<p>does this behave as <code class="docutils literal notranslate"><span class="pre">Lag</span></code> or <code class="docutils literal notranslate"><span class="pre">Differencer</span></code>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># switch = Lag -&gt; this is a Lag transformer now!</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">selected_transformer</span><span class="o">=</span><span class="s2">&quot;Lag&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-8 {color: black;background-color: white;}#sk-container-id-8 pre{padding: 0;}#sk-container-id-8 div.sk-toggleable {background-color: white;}#sk-container-id-8 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-8 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-8 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-8 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-8 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-8 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-8 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-8 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-8 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-8 div.sk-item {position: relative;z-index: 1;}#sk-container-id-8 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-8 div.sk-item::before, #sk-container-id-8 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-8 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-8 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-8 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-8 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-8 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-8 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-8 div.sk-label-container {text-align: center;}#sk-container-id-8 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-8 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-8" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>MultiplexTransformer(selected_transformer=&#x27;Lag&#x27;,
                     transformers=[Differencer(), Lag()])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox" checked><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">MultiplexTransformer</label><div class="sk-toggleable__content"><pre>MultiplexTransformer(selected_transformer=&#x27;Lag&#x27;,
                     transformers=[Differencer(), Lag()])</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># switch = Lag -&gt; this is a Differencer now!</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">selected_transformer</span><span class="o">=</span><span class="s2">&quot;Differencer&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-9 {color: black;background-color: white;}#sk-container-id-9 pre{padding: 0;}#sk-container-id-9 div.sk-toggleable {background-color: white;}#sk-container-id-9 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-9 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-9 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-9 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-9 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-9 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-9 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-9 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-9 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-9 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-9 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-9 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-9 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-9 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-9 div.sk-item {position: relative;z-index: 1;}#sk-container-id-9 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-9 div.sk-item::before, #sk-container-id-9 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-9 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-9 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-9 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-9 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-9 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-9 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-9 div.sk-label-container {text-align: center;}#sk-container-id-9 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-9 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-9" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>MultiplexTransformer(selected_transformer=&#x27;Differencer&#x27;,
                     transformers=[Differencer(), Lag()])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox" checked><label for="sk-estimator-id-13" class="sk-toggleable__label sk-toggleable__label-arrow">MultiplexTransformer</label><div class="sk-toggleable__content"><pre>MultiplexTransformer(selected_transformer=&#x27;Differencer&#x27;,
                     transformers=[Differencer(), Lag()])</pre></div></div></div></div></div></div></div>
</div>
<p>similar, on/off switch with <code class="docutils literal notranslate"><span class="pre">~</span></code></p>
<p>same as multiplexer between wrapped transformer and <code class="docutils literal notranslate"><span class="pre">Id</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optional_differencer</span> <span class="o">=</span> <span class="o">-</span><span class="n">Differencer</span><span class="p">()</span>

<span class="c1"># this behaves as Differencer now</span>
<span class="n">optional_differencer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-10 {color: black;background-color: white;}#sk-container-id-10 pre{padding: 0;}#sk-container-id-10 div.sk-toggleable {background-color: white;}#sk-container-id-10 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-10 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-10 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-10 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-10 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-10 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-10 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-10 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-10 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-10 div.sk-item {position: relative;z-index: 1;}#sk-container-id-10 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-10 div.sk-item::before, #sk-container-id-10 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-10 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-10 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-10 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-10 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-10 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-10 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-10 div.sk-label-container {text-align: center;}#sk-container-id-10 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-10 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-10" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>OptionalPassthrough(transformer=Differencer())</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox" ><label for="sk-estimator-id-14" class="sk-toggleable__label sk-toggleable__label-arrow">OptionalPassthrough</label><div class="sk-toggleable__content"><pre>OptionalPassthrough(transformer=Differencer())</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-15" type="checkbox" ><label for="sk-estimator-id-15" class="sk-toggleable__label sk-toggleable__label-arrow">transformer: Differencer</label><div class="sk-toggleable__content"><pre>Differencer()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-16" type="checkbox" ><label for="sk-estimator-id-16" class="sk-toggleable__label sk-toggleable__label-arrow">Differencer</label><div class="sk-toggleable__content"><pre>Differencer()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is now just the identity transformer</span>
<span class="n">optional_differencer</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">passthrough</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-11 {color: black;background-color: white;}#sk-container-id-11 pre{padding: 0;}#sk-container-id-11 div.sk-toggleable {background-color: white;}#sk-container-id-11 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-11 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-11 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-11 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-11 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-11 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-11 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-11 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-11 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-11 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-11 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-11 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-11 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-11 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-11 div.sk-item {position: relative;z-index: 1;}#sk-container-id-11 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-11 div.sk-item::before, #sk-container-id-11 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-11 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-11 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-11 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-11 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-11 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-11 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-11 div.sk-label-container {text-align: center;}#sk-container-id-11 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-11 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-11" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>OptionalPassthrough(passthrough=True, transformer=Differencer())</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-17" type="checkbox" ><label for="sk-estimator-id-17" class="sk-toggleable__label sk-toggleable__label-arrow">OptionalPassthrough</label><div class="sk-toggleable__content"><pre>OptionalPassthrough(passthrough=True, transformer=Differencer())</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox" ><label for="sk-estimator-id-18" class="sk-toggleable__label sk-toggleable__label-arrow">transformer: Differencer</label><div class="sk-toggleable__content"><pre>Differencer()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox" ><label for="sk-estimator-id-19" class="sk-toggleable__label sk-toggleable__label-arrow">Differencer</label><div class="sk-toggleable__content"><pre>Differencer()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</section>
</section>
<section id="technical-details-transformer-types-and-signatures">
<h2>3.4 Technical details - transformer types and signatures <a class="anchor" id="section_3_4"></a><a class="headerlink" href="#technical-details-transformer-types-and-signatures" title="Link to this heading">#</a></h2>
<p>This section explains the different types of transformers found in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> in detail.</p>
<p>There are four main types of transformation in <code class="docutils literal notranslate"><span class="pre">sktime</span></code>:</p>
<ul class="simple">
<li><p>transforming a series/sequence into scalar- or category-valued features. Examples: <code class="docutils literal notranslate"><span class="pre">tsfresh</span></code>, or extracting <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">variance</span></code> overall.</p></li>
<li><p>transforming a series into another series. Examples: detrending, smoothing, filtering, lagging.</p></li>
<li><p>transforming a panel into another panel. Examples: principal component projection; applying individual series-to-series transformation to all series in the panel.</p></li>
<li><p>transforming a pair of series into a scalar value. Examples: dynamic time warping distance between series/sequences; generalized alignment kernel between series/sequences.</p></li>
</ul>
<p>Notably, the first three (series to primitive features, series to series, panel to panel) are covered by the same base class template and module. We call these transformers “time series transformers”, or, simply, “transformers”.
Kernels and distances for time series and sequences have the same mathematical signature and differ only in mathematical properties (e.g., definiteness assumptions) - they are covered by the more abstract scientific type of “pairwise transformer”.</p>
<p>Below, we give an overview in sub-sections:</p>
<ul class="simple">
<li><p>reviewing common data container formats for series and panels</p></li>
<li><p>showcasing the signature of time series transformers, that transform a single series or panel</p></li>
<li><p>showcasing the signature of pairwise transformers, that transform a pair of series to a scalar, e.g., distances or kernels</p></li>
<li><p>how to search <code class="docutils literal notranslate"><span class="pre">sktime</span></code> for transformers of a certain type</p></li>
</ul>
<section id="data-container-format">
<h3>3.4.1 Data container format<a class="anchor" id="section_3_4_1"></a><a class="headerlink" href="#data-container-format" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers apply to individual time series and panels. Panels are collections of time series, and we refer to each time series in a panel as an “instance” of the panel.
This is formalized as abstract “scientific types” <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">Panel</span></code>, with multiple possible in-memory representations, so-called “mtypes”.</p>
<p>For the purpose of this tutorial, we will be working with the most common mtypes. For more details and formal data type specifications, see the “datatypes and datasets” tutorial.</p>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> are commonly represented as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> for univariate time series and sequences</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> for uni- or multivariate time series and sequences</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Series.index</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame.index</span></code> are used for representing the time series or sequence index. <code class="docutils literal notranslate"><span class="pre">sktime</span></code> supports pandas integer, period and timestamp indices.</p>
<p><code class="docutils literal notranslate"><span class="pre">Panel</span></code>-s are commonly represented as:</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> in a specific format, defined by the <code class="docutils literal notranslate"><span class="pre">pd-multiindex</span></code> mtype. This has a 2-level index, for time points and instances</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, where all <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> are in the <code class="docutils literal notranslate"><span class="pre">Series</span></code> format. The different <code class="docutils literal notranslate"><span class="pre">list</span></code> elements are the different instances</p></li>
</ul>
<p>In either case, the “time” index must be a <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible time index type, as for <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datatypes</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_examples</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of a univariate series</span>
<span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of a multivariate series</span>
<span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd.DataFrame&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of a panel with mtype pd-multiindex</span>
<span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd-multiindex&quot;</span><span class="p">,</span> <span class="s2">&quot;Panel&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of the same panel with mtype df-list</span>
<span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;df-list&quot;</span><span class="p">,</span> <span class="s2">&quot;Panel&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> supports more mtypes, see the “datatypes and datasets” tutorial for more details.</p>
</section>
<section id="general-transformer-signature-time-series-transformers">
<h3>3.4.2 General transformer signature - time series transformers<a class="anchor" id="section_3_4_2"></a><a class="headerlink" href="#general-transformer-signature-time-series-transformers" title="Link to this heading">#</a></h3>
<p>Transformers for <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">Panel</span></code> have the same high-level interface. Depending which data type they are more commonly used for, they are found either in the <code class="docutils literal notranslate"><span class="pre">transformations.series</span></code> or <code class="docutils literal notranslate"><span class="pre">transformations.panel</span></code> module. As said, this does not imply a separate interface.</p>
<p>The most important interface points of transformers are:</p>
<ol class="arabic simple">
<li><p>construction with parameters, this is as with any other <code class="docutils literal notranslate"><span class="pre">sktime</span></code> estimator</p></li>
<li><p>fitting the transformer, via <code class="docutils literal notranslate"><span class="pre">fit</span></code></p></li>
<li><p>transforming data, via <code class="docutils literal notranslate"><span class="pre">transform</span></code></p></li>
<li><p>inverse transforming, via <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code> - not all transformers have this interface point, since not all are invertible</p></li>
<li><p>updating the transformer, via <code class="docutils literal notranslate"><span class="pre">update</span></code> - not all transformers have this interface point (<code class="docutils literal notranslate"><span class="pre">update</span></code> is currently work in progress, as of v0.8.x, contributions are appreciated)</p></li>
</ol>
<p>We show this using two example transformers below - one whose <code class="docutils literal notranslate"><span class="pre">transform</span></code> outputs <code class="docutils literal notranslate"><span class="pre">Series</span></code>, and one whose <code class="docutils literal notranslate"><span class="pre">transform</span></code> outputs primitive features (numbers or categories).</p>
<p>We will apply both transformations to the following <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">Panel</span></code> data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datatypes</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_examples</span>

<span class="c1"># univariate series used in the examples</span>
<span class="n">X_series</span> <span class="o">=</span> <span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
<span class="c1"># panel used in the examples</span>
<span class="n">X_panel</span> <span class="o">=</span> <span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd-multiindex&quot;</span><span class="p">,</span> <span class="s2">&quot;Panel&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_series</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_panel</span>
</pre></div>
</div>
</div>
</div>
<section id="example-transforming-series-to-series">
<h4>Example: transforming series to series<a class="headerlink" href="#example-transforming-series-to-series" title="Link to this heading">#</a></h4>
<p>The Box-Cox transformer applies the Box-Cox transform to individual values in series or panels. At the start, the transformer needs to be constructed with parameter settings, this is the same as for any <code class="docutils literal notranslate"><span class="pre">sktime</span></code> estimator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># constructing the transformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.boxcox</span><span class="w"> </span><span class="kn">import</span> <span class="n">BoxCoxTransformer</span>

<span class="n">my_boxcox_trafo</span> <span class="o">=</span> <span class="n">BoxCoxTransformer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;mle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we apply the constructed transformer <code class="docutils literal notranslate"><span class="pre">my_trafo</span></code> to a (single, univariate) series. First, the transformer is fitted:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fitting the transformer</span>
<span class="n">my_boxcox_trafo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, the transformer is applied, this results in a transformed series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># transforming the series</span>
<span class="n">my_boxcox_trafo</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Generally, the series passed to <code class="docutils literal notranslate"><span class="pre">transform</span></code> need not be the same as in <code class="docutils literal notranslate"><span class="pre">fit</span></code>, but if they are the same, the shorthand <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> can instead be used:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_boxcox_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The transformer can also be applied to <code class="docutils literal notranslate"><span class="pre">Panel</span></code> data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_boxcox_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_panel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note: the <code class="docutils literal notranslate"><span class="pre">BoxCoxTransformer</span></code> used has applied the Box-Cox transform to every series in the panel individually,
but that need not be the case transformers in general.</p>
</section>
<section id="example-transforming-series-to-primitive-features">
<h4>Example: transforming series to primitive features<a class="headerlink" href="#example-transforming-series-to-primitive-features" title="Link to this heading">#</a></h4>
<p>The summary transformer can be used to extract sample statistics such as mean and variance from a series. First, we construct the transformer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># constructing the transformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.summarize</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryTransformer</span>

<span class="n">my_summary_trafo</span> <span class="o">=</span> <span class="n">SummaryTransformer</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>As before, we can fit/apply with <code class="docutils literal notranslate"><span class="pre">fit</span></code>, <code class="docutils literal notranslate"><span class="pre">transform</span></code>, and <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">SummaryTransformer</span></code> returns primitive features, hence the output will be a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, each row corresponding to one series in the input.</p>
<p>If the input is a single series, the output of <code class="docutils literal notranslate"><span class="pre">transform</span></code> and <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> will be a one-row, nine-column <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, corresponding to the nine-number-summary of that one series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_summary_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If the input is a panel, the output of <code class="docutils literal notranslate"><span class="pre">transform</span></code> and <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> will be a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with as many rows as the <code class="docutils literal notranslate"><span class="pre">Panel</span></code> had series. The <code class="docutils literal notranslate"><span class="pre">i</span></code>th row has the summary statistics of the <code class="docutils literal notranslate"><span class="pre">i</span></code>th series in the panel <code class="docutils literal notranslate"><span class="pre">X_panel</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_summary_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_panel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="transformers-with-series-panel-output-vs-primitive-output">
<h4>Transformers with series/panel output vs primitive output<a class="headerlink" href="#transformers-with-series-panel-output-vs-primitive-output" title="Link to this heading">#</a></h4>
<p>Whether <code class="docutils literal notranslate"><span class="pre">transform</span></code> will return time series like objects (<code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">Panel</span></code>) or primitives (i.e. a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>) can be checked by using the <code class="docutils literal notranslate"><span class="pre">&quot;scitype:transform-output&quot;</span></code> tag. This is <code class="docutils literal notranslate"><span class="pre">&quot;Series&quot;</span></code> for behaviour as in the first example (<code class="docutils literal notranslate"><span class="pre">BoxCoxTransformer</span></code>), and <code class="docutils literal notranslate"><span class="pre">&quot;Primitives&quot;</span></code> for behaviour as in the second example (<code class="docutils literal notranslate"><span class="pre">SummaryTransformer</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_boxcox_trafo</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s2">&quot;scitype:transform-output&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_summary_trafo</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s2">&quot;scitype:transform-output&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Use of tags to characterize and search for transformers will be discussed in more detail in section 4.</p>
<p>NOTE: currently not all transformers are refactored to accept both <code class="docutils literal notranslate"><span class="pre">Series</span></code> to <code class="docutils literal notranslate"><span class="pre">Panel</span></code> arguments, the above may hence not fully work for all transformers. Contributions to the transformer refactor are very much appreciated.</p>
</section>
</section>
<section id="general-transformer-signature-pairwise-series-transformers">
<h3>3.4.3 General transformer signature - pairwise series transformers<a class="anchor" id="section_3_4_3"></a><a class="headerlink" href="#general-transformer-signature-pairwise-series-transformers" title="Link to this heading">#</a></h3>
<p>Pairwise series transformers model mathematical objects of signature <code class="docutils literal notranslate"><span class="pre">(Series,</span> <span class="pre">Series)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code>, or, in mathematical notation, $<span class="math notranslate nohighlight">\(\texttt{series} \times\texttt{series}\rightarrow\mathbb{R}\)</span>$
Common examples are distances between series, or (positive definite) kernels on series.</p>
<p>Pairwise transformers have a parametric constructor, like any other <code class="docutils literal notranslate"><span class="pre">sktime</span></code> object. The transformation is achieved by the method <code class="docutils literal notranslate"><span class="pre">transform</span></code>, or, equivalently, for brevity, by a call to the constructed object.</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">transform</span></code> always returns a 2D <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, and can be called in multiple ways:</p>
<ul class="simple">
<li><p>with two <code class="docutils literal notranslate"><span class="pre">Series</span></code> arguments <code class="docutils literal notranslate"><span class="pre">X,</span> <span class="pre">X2</span></code>, in which case a 1 x 1 array is returned. Denote this function by <code class="docutils literal notranslate"><span class="pre">t(X,</span> <span class="pre">X2)</span></code></p></li>
<li><p>with two <code class="docutils literal notranslate"><span class="pre">Panel</span></code> arguments <code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">X2</span></code>, in which case an <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">n</span></code> array is returned, where <code class="docutils literal notranslate"><span class="pre">m</span></code> is the number of instances in <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of instances in <code class="docutils literal notranslate"><span class="pre">X2</span></code>. The <code class="docutils literal notranslate"><span class="pre">(i,j)</span></code>-th entry corresponds to <code class="docutils literal notranslate"><span class="pre">t(Xi,</span> <span class="pre">X2j)</span></code>, where <code class="docutils literal notranslate"><span class="pre">Xi</span></code> is the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th <code class="docutils literal notranslate"><span class="pre">Series</span></code> in the <code class="docutils literal notranslate"><span class="pre">Panel</span></code> <code class="docutils literal notranslate"><span class="pre">X</span></code>, and <code class="docutils literal notranslate"><span class="pre">X2j</span></code> is the <code class="docutils literal notranslate"><span class="pre">j</span></code>-th <code class="docutils literal notranslate"><span class="pre">Series</span></code> in the <code class="docutils literal notranslate"><span class="pre">Panel</span></code> <code class="docutils literal notranslate"><span class="pre">X2</span></code>.</p></li>
<li><p>with one <code class="docutils literal notranslate"><span class="pre">Series</span></code> and one <code class="docutils literal notranslate"><span class="pre">Panel</span></code> argument, in which case the <code class="docutils literal notranslate"><span class="pre">Series</span></code> is interpreted as a 1-element <code class="docutils literal notranslate"><span class="pre">Panel</span></code>, with return as above.</p></li>
<li><p>with one single argument, <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">Panel</span></code>, in which case <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">X2</span></code> are assumed to be the same as the one argument, with behaviour as above.</p></li>
</ul>
<p>We show these in a few examples below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datatypes</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_examples</span>

<span class="c1"># unviariate series used in the examples</span>
<span class="n">X_series</span> <span class="o">=</span> <span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X2_series</span> <span class="o">=</span> <span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># panel used in the examples</span>
<span class="n">X_panel</span> <span class="o">=</span> <span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd-multiindex&quot;</span><span class="p">,</span> <span class="s2">&quot;Panel&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>First, we construct the pairwise transformer with parameters. In this case, the pairwise transformer is a distance (the mean Euclidean distance):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># constructing the transformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.dists_kernels</span><span class="w"> </span><span class="kn">import</span> <span class="n">AggrDist</span><span class="p">,</span> <span class="n">ScipyDist</span>

<span class="c1"># mean of paired Euclidean distances</span>
<span class="n">my_series_dist</span> <span class="o">=</span> <span class="n">AggrDist</span><span class="p">(</span><span class="n">ScipyDist</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can then evaluate the distance by <code class="docutils literal notranslate"><span class="pre">transform</span></code> or direct call:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># evaluate the metric on two series, via transform</span>
<span class="n">my_series_dist</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_series</span><span class="p">,</span> <span class="n">X2_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># evaluate the metric on two series, by direct call - this is the same</span>
<span class="n">my_series_dist</span><span class="p">(</span><span class="n">X_series</span><span class="p">,</span> <span class="n">X2_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># evaluate the metric on two identical panels of three series</span>
<span class="n">my_series_dist</span><span class="p">(</span><span class="n">X_panel</span><span class="p">,</span> <span class="n">X_panel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is the same as providing only one argument</span>
<span class="n">my_series_dist</span><span class="p">(</span><span class="n">X_panel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># one series, one panel</span>
<span class="c1"># we subset X_panel to univariate, since the distance in question</span>
<span class="c1">#     cannot compare series with different number of variables</span>
<span class="n">my_series_dist</span><span class="p">(</span><span class="n">X_series</span><span class="p">,</span> <span class="n">X_panel</span><span class="p">[[</span><span class="s2">&quot;var_1&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>Pairwise transformers are composable, and use the familiar <code class="docutils literal notranslate"><span class="pre">get_params</span></code> interface, just like any other <code class="docutils literal notranslate"><span class="pre">sktime</span></code> object and <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> estimator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_series_dist</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="general-transformer-signature-pairwise-transformers">
<h3>3.4.4 General transformer signature - pairwise transformers<a class="anchor" id="section_3_4_4"></a><a class="headerlink" href="#general-transformer-signature-pairwise-transformers" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> also provides functionality for pairwise transformers on tabular data, i.e., mathematical objects of signature <code class="docutils literal notranslate"><span class="pre">(DataFrame-row,</span> <span class="pre">DataFrame-row)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code>, or, in mathematical notation, $<span class="math notranslate nohighlight">\(\mathbb{R}^n \times\mathbb{R}^n\rightarrow\mathbb{R}\)</span>$.
Common examples are distances between series, or (positive definite) kernels on series.</p>
<p>The behaviour is as for series transformers, evaluation is callable by <code class="docutils literal notranslate"><span class="pre">transform(X,</span> <span class="pre">X2)</span></code> or a direct call.</p>
<p>Inputs to <code class="docutils literal notranslate"><span class="pre">transform</span></code> of a pairwise (tabular) transformer must always be <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.
The output is an <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">n</span></code> matrix, a 2D <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, with <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">len(X),</span> <span class="pre">n=len(X2)</span></code>.
The <code class="docutils literal notranslate"><span class="pre">(i,j)</span></code>-th entry corresponds to <code class="docutils literal notranslate"><span class="pre">t(Xi,</span> <span class="pre">X2j)</span></code>, where <code class="docutils literal notranslate"><span class="pre">Xi</span></code> is the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th row of <code class="docutils literal notranslate"><span class="pre">X</span></code>, and <code class="docutils literal notranslate"><span class="pre">X2j</span></code> is the <code class="docutils literal notranslate"><span class="pre">j</span></code>-th row of <code class="docutils literal notranslate"><span class="pre">X2</span></code>.
If <code class="docutils literal notranslate"><span class="pre">X2</span></code> is not passed, it defaults to <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<p>Example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datatypes</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_examples</span>

<span class="c1"># we retrieve some DataFrame examples</span>
<span class="n">X_tabular</span> <span class="o">=</span> <span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd.DataFrame&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X2_tabular</span> <span class="o">=</span> <span class="n">get_examples</span><span class="p">(</span><span class="s2">&quot;pd.DataFrame&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># constructing the transformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.dists_kernels</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScipyDist</span>

<span class="c1"># mean of paired Euclidean distances</span>
<span class="n">my_tabular_dist</span> <span class="o">=</span> <span class="n">ScipyDist</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># obtain matrix of distances between each pair of rows in X_tabular, X2_tabular</span>
<span class="n">my_tabular_dist</span><span class="p">(</span><span class="n">X_tabular</span><span class="p">,</span> <span class="n">X2_tabular</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="searching-for-transformers">
<h3>3.4.5 Searching for transformers<a class="anchor" id="section_3_4_5"></a><a class="headerlink" href="#searching-for-transformers" title="Link to this heading">#</a></h3>
<p>As with all <code class="docutils literal notranslate"><span class="pre">sktime</span></code> objects, we can use the <code class="docutils literal notranslate"><span class="pre">registry.all_estimators</span></code> utility to display all transformers in <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p>
<p>The relevant scitypes are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;transformer&quot;</span></code> for all transformers (as in Section 2.2)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;transformer-pairwise&quot;</span></code> for all pairwise transformers on tabular data (as in Section 2.4)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;transformer-panel&quot;</span></code> for all pairwise transformers on panel data (as in Section 2.3)</p></li>
</ul>
<p>To filter transformers (<code class="docutils literal notranslate"><span class="pre">&quot;transformer&quot;</span></code> scitype) further by input and output, use tags, most importantly:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;scitype:transform-output&quot;</span></code> - the output scitype that the transform produces. <code class="docutils literal notranslate"><span class="pre">Series</span></code> for time series, <code class="docutils literal notranslate"><span class="pre">Primitives</span></code> for primitive features (float, categories).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;scitype:instancewise&quot;</span></code> - whether transform uses all samples or acts by instance. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this is simply a vectorized operation per series. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, then fitting on a single series does not have the same result as fitting on multiple.</p></li>
</ul>
<p>These and further tags will be explained in more detail in Section 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># listing all pairwise panel transformers - distances, kernels on time series</span>
<span class="n">all_estimators</span><span class="p">(</span><span class="s2">&quot;transformer&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now subset to transformers that extract scalar features</span>
<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;transformer&quot;</span><span class="p">,</span>
    <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;scitype:transform-output&quot;</span><span class="p">:</span> <span class="s2">&quot;Primitives&quot;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># listing all pairwise (tabular) transformers - distances, kernels on vectors/df-rows</span>
<span class="n">all_estimators</span><span class="p">(</span><span class="s2">&quot;transformer-pairwise&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># listing all pairwise panel transformers - distances, kernels on time series</span>
<span class="n">all_estimators</span><span class="p">(</span><span class="s2">&quot;transformer-pairwise-panel&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="extension-guide-implementing-your-own-transformer">
<h2>3.5 Extension guide - implementing your own transformer <a class="anchor" id="section_3_5"></a><a class="headerlink" href="#extension-guide-implementing-your-own-transformer" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> is meant to be easily extensible, for direct contribution to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> as well as for local/private extension with custom methods.</p>
<p>To extend <code class="docutils literal notranslate"><span class="pre">sktime</span></code> with a new local or contributed transformer, a good workflow to follow is:</p>
<ol class="arabic simple">
<li><p>read through the <a class="reference external" href="https://github.com/alan-turing-institute/sktime/blob/main/extension_templates/transformer.py">transformer extension template</a> - this is a <code class="docutils literal notranslate"><span class="pre">python</span></code> file with <code class="docutils literal notranslate"><span class="pre">todo</span></code> blocks that mark the places in which changes need to be added.</p></li>
<li><p>optionally, if you are planning any major surgeries to the interface: look at the <a class="reference external" href="https://github.com/alan-turing-institute/sktime/blob/main/sktime/transformations/base.py">base class architecture</a> - note that “ordinary” extension (e.g., new algorithm) should be easily doable without this.</p></li>
<li><p>copy the transformer extension template to a local folder in your own repository (local/private extension), or to a suitable location in your clone of the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> or affiliated repository (if contributed extension), inside <code class="docutils literal notranslate"><span class="pre">sktime.transformations</span></code>; rename the file and update the file docstring appropriately.</p></li>
<li><p>address the “todo” parts. Usually, this means: changing the name of the class, setting the tag values, specifying hyper-parameters, filling in <code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">_fit</span></code>, <code class="docutils literal notranslate"><span class="pre">_transform</span></code>, and optional methods such as <code class="docutils literal notranslate"><span class="pre">_inverse_transform</span></code> or <code class="docutils literal notranslate"><span class="pre">_update</span></code> (for details see the extension template). You can add private methods as long as they do not override the default public interface. For more details, see the extension template.</p></li>
<li><p>to test your estimator manually: import your estimator and run it in the workflows in Section 2.2; then use it in the compositors in Section 2.3.</p></li>
<li><p>to test your estimator automatically: call <code class="docutils literal notranslate"><span class="pre">sktime.tests.test_all_estimators.check_estimator</span></code> on your estimator. You can call this on a class or object instance. Ensure you have specified test parameters in the <code class="docutils literal notranslate"><span class="pre">get_test_params</span></code> method, according to the extension template.</p></li>
</ol>
<p>In case of direct contribution to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> or one of its affiliated packages, additionally:</p>
<ul class="simple">
<li><p>add yourself as an author to the code, and to the <code class="docutils literal notranslate"><span class="pre">CODEOWNERS</span></code> for the new estimator file(s).</p></li>
<li><p>create a pull request that contains only the new estimators (and their inheritance tree, if it’s not just one class), as well as the automated tests as described above.</p></li>
<li><p>in the pull request, describe the estimator and optimally provide a publication or other technical reference for the strategy it implements.</p></li>
<li><p>before making the pull request, ensure that you have all necessary permissions to contribute the code to a permissive license (BSD-3) open source project.</p></li>
</ul>
</section>
<section id="summary">
<h2>3.6 Summary <a class="anchor" id="section_3_6"></a><a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>transformers are data processing steps with unified interface - <code class="docutils literal notranslate"><span class="pre">fit</span></code>, <code class="docutils literal notranslate"><span class="pre">transform</span></code>, and optional <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code></p></li>
<li><p>used as pipeline components for any learning task, forecasting, classification</p></li>
<li><p>different types by input/output - time series, primitives, pairs of time series, panels/hierarchical.</p></li>
<li><p>find transformers by tags such as <code class="docutils literal notranslate"><span class="pre">scitype:transform-output</span></code> and <code class="docutils literal notranslate"><span class="pre">scitype:instancewise</span></code> using <code class="docutils literal notranslate"><span class="pre">all_estimators</span></code></p></li>
<li><p>rich composition syntax - <code class="docutils literal notranslate"><span class="pre">*</span></code> for pipe, <code class="docutils literal notranslate"><span class="pre">+</span></code> for featureunion, <code class="docutils literal notranslate"><span class="pre">[in,</span> <span class="pre">out]</span></code> for variable subset, <code class="docutils literal notranslate"><span class="pre">|</span></code> for multiplex/switch</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides easy-to-use extension templates for transformers, build your own, plug and play</p></li>
</ul>
<hr class="docutils" />
<section id="credits-notebook-3-transformers">
<h3>Credits: notebook 3 - transformers<a class="headerlink" href="#credits-notebook-3-transformers" title="Link to this heading">#</a></h3>
<p>notebook creation: fkiraly</p>
<p>transformer pipelines &amp; compositors: fkiraly, mloning, miraep8<br />
forecaster pipelines: fkiraly, aiwalter<br />
classifier/regressor pipelines: fkiraly<br />
transformer base interface: mloning, fkiraly<br />
dunder interface: fkiraly, miraep8</p>
<p>Based on design ideas: sklearn, magrittr, mlr, mlj</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./.venv/lib/python3.11/site-packages/examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Overview of this notebook</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-in-sktime">3. Transformers in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="chapter3"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wherefore-transformers">3.1 Wherefore transformers? <a class="anchor" id="section_3_1"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-approach-don-t-do-this-at-home">Naive approach - don’t do this at home!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slightly-less-naive-approach-use-sktime-transformers-badly">Slightly less naive approach - use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers (badly)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expert-approach-use-sktime-transformers-with-pipelines">Expert approach - use <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers with pipelines!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-interface-and-features">3.2 Transformers - interface and features <a class="anchor" id="section_3_2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-transformers">3.2.1 What are transformers? <a class="anchor" id="section_3_2_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#different-types-of-transformers">3.2.2 Different types of transformers <a class="anchor" id="section_3_2_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting-aka-vectorization-of-transformers">3.2.3 Broadcasting aka vectorization of transformers <a class="anchor" id="section_3_2_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-as-pipeline-components">3.2.4 Transformers as pipeline components <a class="anchor" id="section_3_2_4"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-forecaster-pipeline">Example 1: forecaster pipeline</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-classifier-pipeline">Example 2: classifier pipeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-transformers-feature-engineering">3.3 Combining transformers, feature engineering <a class="anchor" id="section_3_3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chaining-transformers-via">Chaining transformers via <code class="docutils literal notranslate"><span class="pre">*</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-union-via">Feature union via <code class="docutils literal notranslate"><span class="pre">+</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subset-input-columns-via-colname">Subset input columns via <code class="docutils literal notranslate"><span class="pre">[colname]</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#turning-log-transform-into-exp-transform-via-invert">turning log transform into exp transform via invert <code class="docutils literal notranslate"><span class="pre">~</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automl-structure-compositors-multiplexer-switch-and-on-off-switch">autoML structure compositors: multiplexer switch <code class="docutils literal notranslate"><span class="pre">¦</span></code> and on/off switch <code class="docutils literal notranslate"><span class="pre">-</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-details-transformer-types-and-signatures">3.4 Technical details - transformer types and signatures <a class="anchor" id="section_3_4"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-container-format">3.4.1 Data container format<a class="anchor" id="section_3_4_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-transformer-signature-time-series-transformers">3.4.2 General transformer signature - time series transformers<a class="anchor" id="section_3_4_2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-transforming-series-to-series">Example: transforming series to series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-transforming-series-to-primitive-features">Example: transforming series to primitive features</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-with-series-panel-output-vs-primitive-output">Transformers with series/panel output vs primitive output</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-transformer-signature-pairwise-series-transformers">3.4.3 General transformer signature - pairwise series transformers<a class="anchor" id="section_3_4_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-transformer-signature-pairwise-transformers">3.4.4 General transformer signature - pairwise transformers<a class="anchor" id="section_3_4_4"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-transformers">3.4.5 Searching for transformers<a class="anchor" id="section_3_4_5"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extension-guide-implementing-your-own-transformer">3.5 Extension guide - implementing your own transformer <a class="anchor" id="section_3_5"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">3.6 Summary <a class="anchor" id="section_3_6"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credits-notebook-3-transformers">Credits: notebook 3 - transformers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>