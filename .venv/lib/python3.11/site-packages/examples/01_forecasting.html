
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Forecasting with sktime &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '.venv/lib/python3.11/site-packages/examples/01_forecasting';</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My sample book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F.venv/lib/python3.11/site-packages/examples/01_forecasting.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../_sources/.venv/lib/python3.11/site-packages/examples/01_forecasting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Forecasting with sktime</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">Package imports</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-forecasting-workflows">1. Basic forecasting workflows <a class="anchor" id="chapter1"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-container-format">1.1 Data container format<a class="anchor" id="section_1_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-deployment-workflow-batch-fitting-and-forecasting">1.2 Basic deployment workflow - batch fitting and forecasting<a class="anchor" id="section_1_2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-preparation-of-the-data">Step 1 - Preparation of the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-specifying-the-forecasting-horizon">Step 2 - Specifying the forecasting horizon</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-numpy-forecasting-horizon">Using a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> forecasting horizon</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-forecastinghorizon-based-forecasting-horizon">Using a <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> based forecasting horizon</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-specifying-the-forecasting-algorithm">Step 3 - Specifying the forecasting algorithm</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-fitting-the-forecaster-to-the-seen-data">Step 4 - Fitting the forecaster to the seen data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-requesting-forecasts">Step 5 - Requesting forecasts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-deployment-workflow-in-a-nutshell">1.2.1 The basic deployment workflow in a nutshell<a class="anchor" id="section_1_2_1"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasters-that-require-the-horizon-already-in-fit">1.2.2 Forecasters that require the horizon already in <code class="docutils literal notranslate"><span class="pre">fit</span></code> <a class="anchor" id="section_1_2_2"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasters-that-can-make-use-of-exogeneous-data">1.2.3 Forecasters that can make use of exogeneous data<a class="anchor" id="section_1_2_3"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multivariate-forecasting">1.2.4. Multivariate forecasting <a class="anchor" id="section_1_2_4"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-forecasting-prediction-intervals-quantile-variance-and-distributional-forecasts">1.2.5 Probabilistic forecasting: prediction intervals, quantile, variance, and distributional forecasts <a class="anchor" id="section_1_2_5"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-interval-interval-predictions"><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> - interval predictions</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-quantiles-quantile-forecasts"><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> - quantile forecasts</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-var-variance-predictions"><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> - variance predictions</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-proba-distribution-predictions"><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> - distribution predictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-forecasts-and-hierarchical-forecasts">1.2.6 Panel forecasts and hierarchical forecasts <a class="anchor" id="section_1_2_6"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-evaluation-workflow-evaluating-a-batch-of-forecasts-against-ground-truth-observations">1.3 Basic evaluation workflow - evaluating a batch of forecasts against ground truth observations<a class="anchor" id="section_1_3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-splitting-a-historical-data-set-in-to-a-temporal-train-and-test-batch">Step 1 - Splitting a historical data set in to a temporal train and test batch</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-making-forecasts-for-y-test-from-y-train">Step 2 - Making forecasts for y_test from y_train</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-3-and-4-specifying-a-forecasting-metric-evaluating-on-the-test-set">Steps 3 and 4 - Specifying a forecasting metric, evaluating on the test set</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-testing-performance-against-benchmarks">Step 5 - Testing performance against benchmarks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-batch-forecast-evaluation-workflow-in-a-nutshell-function-metric-interface">1.3.1 The basic batch forecast evaluation workflow in a nutshell - function metric interface<a class="anchor" id="section_1_3_1"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-batch-forecast-evaluation-workflow-in-a-nutshell-metric-class-interface">1.3.2 The basic batch forecast evaluation workflow in a nutshell - metric class interface<a class="anchor" id="section_1_3_2"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-deployment-workflow-rolling-updates-forecasts">1.4 Advanced deployment workflow: rolling updates &amp; forecasts<a class="anchor" id="section_1_4"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-a-forecaster-with-the-update-method">1.4.1 Updating a forecaster with the <code class="docutils literal notranslate"><span class="pre">update</span></code> method<a class="anchor" id="section_1_4_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-the-now-state-without-updating-the-model">1.4.2 Moving the “now” state without updating the model<a class="anchor" id="section_1_4_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#walk-forward-predictions-on-a-batch-of-data">1.4.3 Walk-forward predictions on a batch of data<a class="anchor" id="section_1_4_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-evaluation-workflow-rolling-re-sampling-and-aggregate-errors-rolling-back-testing">1.5 Advanced evaluation workflow: rolling re-sampling and aggregate errors, rolling back-testing<a class="anchor" id="section_1_5"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasters-in-sktime-lookup-properties-main-families">2. Forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> - lookup, properties, main families<a class="anchor" id="chapter2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#listing-all-forecasters-in-sktime">2.1 Listing all forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="section_2_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecaster-tags">2.2 Forecaster tags <a class="anchor" id="section_2_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#capability-tags-multivariate-probabilistic-hierarchical">2.2.1 Capability tags: multivariate, probabilistic, hierarchical <a class="anchor" id="section_2_2_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-and-listing-forecasters-by-tag">2.2.2 Finding and listing forecasters by tag <a class="anchor" id="section_2_2_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#listing-all-forecaster-tags">2.2.3 Listing all forecaster tags <a class="anchor" id="section_2_2_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-forecasters-in-sktime">2.3 Common forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="section_2_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exponential-smoothing-theta-forecaster-autoets-from-statsmodels">2.3.1 Exponential smoothing, theta forecaster, autoETS from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code><a class="anchor" id="section_2_3_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arima-and-autoarima">2.3.2 ARIMA and autoARIMA<a class="anchor" id="section_2_3_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bats-and-tbats">2.3.3 BATS and TBATS<a class="anchor" id="section_2_3_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#facebook-prophet">2.3.4 Facebook prophet<a class="anchor" id="section_2_3_4"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-space-model-structural-time-series">2.3.5 State Space Model (Structural Time Series)<a class="anchor" id="section_2_3_5"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autoarima-from-statsforecast">2.3.6 AutoARIMA from StatsForecast<a class="anchor" id="section_2_3_6"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-composition-patterns-pipelines-reduction-automl-and-more">3. Advanced composition patterns - pipelines, reduction, autoML, and more<a class="anchor" id="chapter3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduction-from-forecasting-to-regression">3.1 Reduction: from forecasting to regression<a class="anchor" id="section_3_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelining-detrending-and-deseasonalization">3.2 Pipelining, detrending and deseasonalization<a class="anchor" id="section_3_2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-forecasting-pipeline">3.2.1 The basic forecasting pipeline<a class="anchor" id="section_3_2_1"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-detrender-as-pipeline-component">3.2.2 The <code class="docutils literal notranslate"><span class="pre">Detrender</span></code> as pipeline component<a class="anchor" id="section_3_2_2"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#complex-pipeline-composites-and-parameter-inspection">3.2.3 Complex pipeline composites and parameter inspection<a class="anchor" id="section_3_2_3"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-tuning">3.3 Parameter tuning<a class="anchor" id="section_3_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-tuning-using-forecastinggridsearchcv">3.3.1 Basic tuning using <code class="docutils literal notranslate"><span class="pre">ForecastingGridSearchCV</span></code><a class="anchor" id="section_3_3_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-of-complex-composites">3.3.2 Tuning of complex composites<a class="anchor" id="section_3_3_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-the-metric-and-retrieving-scores">3.3.3 Selecting the metric and retrieving scores<a class="anchor" id="section_3_3_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automl-aka-automated-model-selection-ensembling-and-hedging">3.4 autoML  aka automated model selection, ensembling and hedging<a class="anchor" id="section_3_4"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automl-aka-automatic-model-selection-using-tuning-plus-multiplexer">3.4.1 autoML aka automatic model selection, using tuning plus multiplexer<a class="anchor" id="section_3_4_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automl-selecting-transformer-combinations-via-optimalpassthrough">3.4.2 autoML: selecting transformer combinations via <code class="docutils literal notranslate"><span class="pre">OptimalPassthrough</span></code><a class="anchor" id="section_3_4_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-ensembling-strategies">3.4.3 Simple ensembling strategies<a class="anchor" id="section_3_4_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction-weighted-ensembles-and-hedge-ensembles">3.4.4 Prediction weighted ensembles and hedge ensembles<a class="anchor" id="section_3_4_4"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extension-guide-implementing-your-own-forecaster">4. Extension guide - implementing your own forecaster<a class="anchor" id="chapter4"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">5. Summary<a class="anchor" id="chapter5"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-resources">Useful resources</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits:</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><strong>Set-up instructions:</strong> this notebook give a tutorial on the forecasting learning task supported by <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.
On binder, this should run out-of-the-box.</p>
<p>To run this notebook as intended, ensure that <code class="docutils literal notranslate"><span class="pre">sktime</span></code> with basic dependency requirements is installed in your python environment.</p>
<p>To run this notebook with a local development version of sktime, an editable developer installation is recommended, see the <a class="reference external" href="https://www.sktime.net/en/stable/installation.html#development-versions">sktime developer install guide</a> for instructions.</p>
<section class="tex2jax_ignore mathjax_ignore" id="forecasting-with-sktime">
<h1>Forecasting with sktime<a class="headerlink" href="#forecasting-with-sktime" title="Link to this heading">#</a></h1>
<p>In forecasting, past data is used to make temporal forward predictions of a time series. This is notably different from tabular prediction tasks supported by <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> and similar libraries.</p>
<img src="img/forecasting.png" width=750 />
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides a common, <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>-like interface to a variety of classical and ML-style forecasting algorithms, together with tools for building pipelines and composite machine learning models, including temporal tuning schemes, or reductions such as walk-forward application of <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> regressors.</p>
<p><strong>Section 1</strong> provides an overview of common forecasting workflows supported by <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p>
<p><strong>Section 2</strong> discusses the families of forecasters available in <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p>
<p><strong>Section 3</strong> discusses advanced composition patterns, including pipeline building, reduction, tuning, ensembling, and autoML.</p>
<p><strong>Section 4</strong> gives an introduction to how to write custom estimators compliant with the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> interface.</p>
<p>Further references:</p>
<ul class="simple">
<li><p>For further details on how forecasting is different from supervised prediction à la <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>, and pitfalls of misdiagnosing forecasting as supervised prediction, have a look at <a class="reference internal" href="01a_forecasting_sklearn.html"><span class="std std-doc">this notebook</span></a></p></li>
<li><p>For a scientific reference, take a look at <a class="reference external" href="https://arxiv.org/abs/2005.08067">our paper on forecasting with sktime</a> in which we discuss <code class="docutils literal notranslate"><span class="pre">sktime</span></code>’s forecasting module in more detail and use it to replicate and extend the M4 study.</p></li>
</ul>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#chapter1"><span class="xref myst">1. Basic forecasting workflows</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_1_1"><span class="xref myst">1.1 Data container format</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_2"><span class="xref myst">1.2 Basic deployment workflow - batch fitting and forecasting</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_1_2_1"><span class="xref myst">1.2.1 Basic deployment workflow in a nutshell</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_2_2"><span class="xref myst">1.2.2 Forecasters that require the horizon when fitting</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_2_3"><span class="xref myst">1.2.3 Forecasters that can make use of exogeneous data</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_2_4"><span class="xref myst">1.2.4 Multivariate Forecasters</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_2_5"><span class="xref myst">1.2.5 Prediction intervals and quantile forecasts</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_2_6"><span class="xref myst">1.2.6 Panel forecasts and hierarchical forecasts</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section_1_3"><span class="xref myst">1.3 Basic evaluation workflow - evaluating a batch of forecasts against ground truth observations</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_1_3_1"><span class="xref myst">1.3.1 The basic batch forecast evaluation workflow in a nutshell - function metric interface</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_3_2"><span class="xref myst">1.3.2 The basic batch forecast evaluation workflow in a nutshell - metric class interface</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section_1_4"><span class="xref myst">1.4 Advanced deployment workflow: rolling updates &amp; forecasts</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_1_4_1"><span class="xref myst">1.4.1 Updating a forecaster with the update method</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_4_2"><span class="xref myst">1.4.2 Moving the “now” state without updating the model</span></a></p></li>
<li><p><a class="reference internal" href="#section_1_4_3"><span class="xref myst">1.4.3 Walk-forward predictions on a batch of data</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section_1_5"><span class="xref myst">1.5 Advanced evaluation workflow: rolling re-sampling and aggregate errors, rolling back-testing</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#chapter2"><span class="xref myst">2. Forecasters in sktime - searching, tags, common families</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_2_1"><span class="xref myst">2.1 Forecaster lookup - the registry</span></a></p></li>
<li><p><a class="reference internal" href="#section_2_2"><span class="xref myst">2.2 Forecaster tags</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_2_2_1"><span class="xref myst">2.2.1 Capability tags: multivariate, probabilistic, hierarchical</span></a></p></li>
<li><p><a class="reference internal" href="#section_2_2_2"><span class="xref myst">2.2.2 Finding and listing forecasters by tag</span></a></p></li>
<li><p><a class="reference internal" href="#section_2_2_3"><span class="xref myst">2.2.3 Listing all forecaster tags</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section_2_3"><span class="xref myst">2.3 Common forecaster types</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_2_3_1"><span class="xref myst">2.3.1 Exponential smoothing, theta forecaster, autoETS from statsmodels</span></a></p></li>
<li><p><a class="reference internal" href="#section_2_3_2"><span class="xref myst">2.3.2 ARIMA and autoARIMA</span></a></p></li>
<li><p><a class="reference internal" href="#section_2_3_3"><span class="xref myst">2.3.3 BATS and TBATS</span></a></p></li>
<li><p><a class="reference internal" href="#section_2_3_4"><span class="xref myst">2.3.4 Facebook prophet</span></a></p></li>
<li><p><a class="reference internal" href="#section_2_3_5"><span class="xref myst">2.3.5 State Space Model (Structural Time Series)</span></a></p></li>
<li><p><a class="reference internal" href="#section_2_3_6"><span class="xref myst">2.3.6 AutoArima from StatsForecast</span></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#chapter3"><span class="xref myst">3. Advanced composition patterns - pipelines, reduction, autoML, and more</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_3_1"><span class="xref myst">3.1 Reduction: from forecasting to regression</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_2"><span class="xref myst">3.2 Pipelining, detrending and deseasonalization</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_3_2_1"><span class="xref myst">3.2.1 The basic forecasting pipeline</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_2_2"><span class="xref myst">3.2.2 The Detrender as pipeline component</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_2_3"><span class="xref myst">3.2.3 Complex pipeline composites and parameter inspection</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section_3_3"><span class="xref myst">3.3 Parameter tuning</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_3_3_1"><span class="xref myst">3.3.1 Basic tuning using ForecastingGridSearchCV</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_3_2"><span class="xref myst">3.3.2 Tuning of complex composites</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_3_3"><span class="xref myst">3.3.3 Selecting the metric and retrieving scores</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section_3_4"><span class="xref myst">3.4 autoML aka automated model selection, ensembling and hedging</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section_3_4_1"><span class="xref myst">3.4.1 autoML aka automatic model selection, using tuning plus multiplexer</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_4_2"><span class="xref myst">3.4.2 autoML: selecting transformer combinations via OptimalPassthrough</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_4_3"><span class="xref myst">3.4.3 Simple ensembling strategies</span></a></p></li>
<li><p><a class="reference internal" href="#section_3_4_4"><span class="xref myst">3.4.4 Prediction weighted ensembles and hedge ensembles</span></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#chapter4"><span class="xref myst">4. Extension guide - implementing your own forecaster</span></a></p></li>
<li><p><a class="reference internal" href="#chapter5"><span class="xref myst">5. Summary</span></a></p></li>
</ul>
<section id="package-imports">
<h3>Package imports<a class="headerlink" href="#package-imports" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># hide warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="basic-forecasting-workflows">
<h2>1. Basic forecasting workflows <a class="anchor" id="chapter1"></a><a class="headerlink" href="#basic-forecasting-workflows" title="Link to this heading">#</a></h2>
<p>This section explains the basic forecasting workflows, and key interface points for it.</p>
<p>We cover the following four workflows:</p>
<ul class="simple">
<li><p>Basic deployment workflow: batch fitting and forecasting</p></li>
<li><p>Basic evaluation workflow: evaluating a batch of forecasts against ground truth observations</p></li>
<li><p>Advanced deployment workflow: fitting and rolling updates/forecasts</p></li>
<li><p>Advanced evaluation workflow: using rolling forecast splits and computing split-wise and aggregate errors, including common back-testing schemes</p></li>
</ul>
<section id="data-container-format">
<h3>1.1 Data container format<a class="anchor" id="section_1_1"></a><a class="headerlink" href="#data-container-format" title="Link to this heading">#</a></h3>
<p>All workflows make common assumptions on the input data format.</p>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> uses <code class="docutils literal notranslate"><span class="pre">pandas</span></code> for representing time series:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> for time series and sequences, primarily. Rows represent time indices, columns represent variables.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> can also be used for univariate time series and sequences</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays (1D and 2D) can also be passed, but <code class="docutils literal notranslate"><span class="pre">pandas</span></code> use is encouraged.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Series.index</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame.index</span></code> are used for representing the time series or sequence index.
<code class="docutils literal notranslate"><span class="pre">sktime</span></code> supports pandas integer, period and timestamp indices for simple time series.</p>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> supports further, additional container formats for panel and hierarchical time series, these are discussed in Section 1.6.</p>
<p><strong>Example:</strong> as the running example in this tutorial, we use a textbook data set, the Box-Jenkins airline data set, which consists of the number of monthly totals of international airline passengers, from 1949 - 1960. Values are in thousands. See “Makridakis, Wheelwright and Hyndman (1998) Forecasting: methods and applications”, exercises sections 2 and 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_series</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="c1"># plotting for visualization</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1152x288 with 1 Axes&gt;,
 &lt;AxesSubplot:ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/0f814e95a37645a98f6540fa63069cc8a1163ea17127b1517923fc84b61c7359.png" src="../../../../../_images/0f814e95a37645a98f6540fa63069cc8a1163ea17127b1517923fc84b61c7359.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PeriodIndex([&#39;1949-01&#39;, &#39;1949-02&#39;, &#39;1949-03&#39;, &#39;1949-04&#39;, &#39;1949-05&#39;, &#39;1949-06&#39;,
             &#39;1949-07&#39;, &#39;1949-08&#39;, &#39;1949-09&#39;, &#39;1949-10&#39;,
             ...
             &#39;1960-03&#39;, &#39;1960-04&#39;, &#39;1960-05&#39;, &#39;1960-06&#39;, &#39;1960-07&#39;, &#39;1960-08&#39;,
             &#39;1960-09&#39;, &#39;1960-10&#39;, &#39;1960-11&#39;, &#39;1960-12&#39;],
            dtype=&#39;period[M]&#39;, length=144)
</pre></div>
</div>
</div>
</div>
<p>Generally, users are expected to use the in-built loading functionality of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">pandas</span></code>-compatible packages to load data sets for forecasting, such as <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> or the <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> constructors if data is available in another in-memory format, e.g., <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> forecasters may accept input in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>-adjacent formats, but will produce outputs in, and attempt to coerce inputs to, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> formats.</p>
<p>NOTE: if your favourite format is not properly converted or coerced, kindly consider to contribute that functionality to <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p>
</section>
<section id="basic-deployment-workflow-batch-fitting-and-forecasting">
<h3>1.2 Basic deployment workflow - batch fitting and forecasting<a class="anchor" id="section_1_2"></a><a class="headerlink" href="#basic-deployment-workflow-batch-fitting-and-forecasting" title="Link to this heading">#</a></h3>
<p>The simplest use case workflow is batch fitting and forecasting, i.e., fitting a forecasting model to one batch of past data, then asking for forecasts at time point in the future.</p>
<p>The steps in this workflow are as follows:</p>
<ol class="arabic simple">
<li><p>Preparation of the data</p></li>
<li><p>Specification of the time points for which forecasts are requested. This uses a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> or the <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> object.</p></li>
<li><p>Specification and instantiation of the forecaster. This follows a <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>-like syntax; forecaster objects follow the familiar <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> <code class="docutils literal notranslate"><span class="pre">BaseEstimator</span></code> interface.</p></li>
<li><p>Fitting the forecaster to the data, using the forecaster’s <code class="docutils literal notranslate"><span class="pre">fit</span></code> method</p></li>
<li><p>Making a forecast, using the forecaster’s <code class="docutils literal notranslate"><span class="pre">predict</span></code> method</p></li>
</ol>
<p>The below first outlines the vanilla variant of the basic deployment workflow, step-by-step.</p>
<p>At the end, one-cell workflows are provided, with common deviations from the pattern (Sections 1.2.1 and following).</p>
<section id="step-1-preparation-of-the-data">
<h4>Step 1 - Preparation of the data<a class="headerlink" href="#step-1-preparation-of-the-data" title="Link to this heading">#</a></h4>
<p>As discussed in Section 1.1, the data is assumed to be in <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> or <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_series</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># in the example, we use the airline data set.</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1152x288 with 1 Axes&gt;,
 &lt;AxesSubplot:ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/0f814e95a37645a98f6540fa63069cc8a1163ea17127b1517923fc84b61c7359.png" src="../../../../../_images/0f814e95a37645a98f6540fa63069cc8a1163ea17127b1517923fc84b61c7359.png" />
</div>
</div>
</section>
<section id="step-2-specifying-the-forecasting-horizon">
<h4>Step 2 - Specifying the forecasting horizon<a class="headerlink" href="#step-2-specifying-the-forecasting-horizon" title="Link to this heading">#</a></h4>
<p>Now we need to specify the forecasting horizon and pass that to our forecasting algorithm.</p>
<p>There are two main ways:</p>
<ul class="simple">
<li><p>Using a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> of integers. This assumes either integer index or periodic index (<code class="docutils literal notranslate"><span class="pre">PeriodIndex</span></code>) in the time series; the integer indicates the number of time points or periods ahead we want to make a forecast for. E.g., <code class="docutils literal notranslate"><span class="pre">1</span></code> means forecast the next period, <code class="docutils literal notranslate"><span class="pre">2</span></code> the second next period, and so on.</p></li>
<li><p>Using a <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> object. This can be used to define forecast horizons, using any supported index type as an argument. No periodic index is assumed.</p></li>
</ul>
<p>Forecasting horizons can be absolute, i.e., referencing specific time points in the future, or relative, i.e., referencing time differences to the present. As a default, the present is that latest time point seen in any <code class="docutils literal notranslate"><span class="pre">y</span></code> passed to the forecaster.</p>
<p><code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> based forecasting horizons are always relative; <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> objects can be both relative and absolute. In particular, absolute forecasting horizons can only be specified using <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code>.</p>
<section id="using-a-numpy-forecasting-horizon">
<h5>Using a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> forecasting horizon<a class="headerlink" href="#using-a-numpy-forecasting-horizon" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span>
<span class="n">fh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
       35, 36])
</pre></div>
</div>
</div>
</div>
<p>This will ask for monthly predictions for the next three years, since the original series period is 1 month.
In another example, to predict only the second and fifth month ahead, one could write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>  <span class="c1"># 2nd and 5th step ahead</span>
</pre></div>
</div>
</section>
<section id="using-a-forecastinghorizon-based-forecasting-horizon">
<h5>Using a <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> based forecasting horizon<a class="headerlink" href="#using-a-forecastinghorizon-based-forecasting-horizon" title="Link to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> object takes absolute indices as input, but considers the input absolute or relative depending on the <code class="docutils literal notranslate"><span class="pre">is_relative</span></code> flag.</p>
<p><code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> will automatically assume a relative horizon if temporal difference types from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> are passed; if value types from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> are passed, it will assume an absolute horizon.</p>
<p>To define an absolute <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> in our example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingHorizon</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fh</span> <span class="o">=</span> <span class="n">ForecastingHorizon</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;1961-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">)),</span> <span class="n">is_relative</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">fh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ForecastingHorizon([&#39;1961-01&#39;, &#39;1961-02&#39;, &#39;1961-03&#39;, &#39;1961-04&#39;, &#39;1961-05&#39;, &#39;1961-06&#39;,
             &#39;1961-07&#39;, &#39;1961-08&#39;, &#39;1961-09&#39;, &#39;1961-10&#39;, &#39;1961-11&#39;, &#39;1961-12&#39;,
             &#39;1962-01&#39;, &#39;1962-02&#39;, &#39;1962-03&#39;, &#39;1962-04&#39;, &#39;1962-05&#39;, &#39;1962-06&#39;,
             &#39;1962-07&#39;, &#39;1962-08&#39;, &#39;1962-09&#39;, &#39;1962-10&#39;, &#39;1962-11&#39;, &#39;1962-12&#39;,
             &#39;1963-01&#39;, &#39;1963-02&#39;, &#39;1963-03&#39;, &#39;1963-04&#39;, &#39;1963-05&#39;, &#39;1963-06&#39;,
             &#39;1963-07&#39;, &#39;1963-08&#39;, &#39;1963-09&#39;, &#39;1963-10&#39;, &#39;1963-11&#39;, &#39;1963-12&#39;],
            dtype=&#39;period[M]&#39;, is_relative=False)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code>-s can be converted from relative to absolute and back via the <code class="docutils literal notranslate"><span class="pre">to_relative</span></code> and <code class="docutils literal notranslate"><span class="pre">to_absolute</span></code> methods. Both of these conversions require a compatible <code class="docutils literal notranslate"><span class="pre">cutoff</span></code> to be passed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Period</span><span class="p">(</span><span class="s2">&quot;1960-12&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fh</span><span class="o">.</span><span class="n">to_relative</span><span class="p">(</span><span class="n">cutoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ForecastingHorizon([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
            18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
            35, 36],
           dtype=&#39;int64&#39;, is_relative=True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fh</span><span class="o">.</span><span class="n">to_absolute</span><span class="p">(</span><span class="n">cutoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ForecastingHorizon([&#39;1961-01&#39;, &#39;1961-02&#39;, &#39;1961-03&#39;, &#39;1961-04&#39;, &#39;1961-05&#39;, &#39;1961-06&#39;,
             &#39;1961-07&#39;, &#39;1961-08&#39;, &#39;1961-09&#39;, &#39;1961-10&#39;, &#39;1961-11&#39;, &#39;1961-12&#39;,
             &#39;1962-01&#39;, &#39;1962-02&#39;, &#39;1962-03&#39;, &#39;1962-04&#39;, &#39;1962-05&#39;, &#39;1962-06&#39;,
             &#39;1962-07&#39;, &#39;1962-08&#39;, &#39;1962-09&#39;, &#39;1962-10&#39;, &#39;1962-11&#39;, &#39;1962-12&#39;,
             &#39;1963-01&#39;, &#39;1963-02&#39;, &#39;1963-03&#39;, &#39;1963-04&#39;, &#39;1963-05&#39;, &#39;1963-06&#39;,
             &#39;1963-07&#39;, &#39;1963-08&#39;, &#39;1963-09&#39;, &#39;1963-10&#39;, &#39;1963-11&#39;, &#39;1963-12&#39;],
            dtype=&#39;period[M]&#39;, is_relative=False)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="step-3-specifying-the-forecasting-algorithm">
<h4>Step 3 - Specifying the forecasting algorithm<a class="headerlink" href="#step-3-specifying-the-forecasting-algorithm" title="Link to this heading">#</a></h4>
<p>To make forecasts, a forecasting algorithm needs to be specified. This is done using a <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>-like interface. Most importantly, all <code class="docutils literal notranslate"><span class="pre">sktime</span></code> forecasters follow the same interface, so the preceding and remaining steps are the same, no matter which forecaster is being chosen.</p>
<p>For this example, we choose the naive forecasting method of predicting the last seen value. More complex specifications are possible, using pipeline and reduction construction syntax; this will be covered later in Section 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-fitting-the-forecaster-to-the-seen-data">
<h4>Step 4 - Fitting the forecaster to the seen data<a class="headerlink" href="#step-4-fitting-the-forecaster-to-the-seen-data" title="Link to this heading">#</a></h4>
<p>Now the forecaster needs to be fitted to the seen data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NaiveForecaster()
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-requesting-forecasts">
<h4>Step 5 - Requesting forecasts<a class="headerlink" href="#step-5-requesting-forecasts" title="Link to this heading">#</a></h4>
<p>Finally, we request forecasts for the specified forecasting horizon. This needs to be done after fitting the forecaster:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting predictions and past data</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1152x288 with 1 Axes&gt;,
 &lt;AxesSubplot:ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/5d3a8f034c5b64ed52d8f31530f56fe11ea538fb582630e0020b8420b1cff9ae.png" src="../../../../../_images/5d3a8f034c5b64ed52d8f31530f56fe11ea538fb582630e0020b8420b1cff9ae.png" />
</div>
</div>
</section>
<section id="the-basic-deployment-workflow-in-a-nutshell">
<h4>1.2.1 The basic deployment workflow in a nutshell<a class="anchor" id="section_1_2_1"></a><a class="headerlink" href="#the-basic-deployment-workflow-in-a-nutshell" title="Link to this heading">#</a></h4>
<p>For convenience, we present the basic deployment workflow in one cell.
This uses the same data, but different forecaster: predicting the latest value observed in the same month.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingHorizon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 1: data specification</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="c1"># step 2: specifying forecasting horizon</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span>

<span class="c1"># step 3: specifying the forecasting algorithm</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># step 4: fitting the forecaster</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># step 5: querying predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># optional: plotting predictions and past data</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1152x288 with 1 Axes&gt;,
 &lt;AxesSubplot:ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/d17deff09a11d1a86ad0b8930ad8ed2b89905fd49e834ff5a7b37e8c52950190.png" src="../../../../../_images/d17deff09a11d1a86ad0b8930ad8ed2b89905fd49e834ff5a7b37e8c52950190.png" />
</div>
</div>
</section>
<section id="forecasters-that-require-the-horizon-already-in-fit">
<h4>1.2.2 Forecasters that require the horizon already in <code class="docutils literal notranslate"><span class="pre">fit</span></code> <a class="anchor" id="section_1_2_2"></a><a class="headerlink" href="#forecasters-that-require-the-horizon-already-in-fit" title="Link to this heading">#</a></h4>
<p>Some forecasters need the forecasting horizon provided already in <code class="docutils literal notranslate"><span class="pre">fit</span></code>. Such forecasters will produce informative error messages when it is not passed in <code class="docutils literal notranslate"><span class="pre">fit</span></code>. All forecaster will remember the horizon when already passed in <code class="docutils literal notranslate"><span class="pre">fit</span></code> for prediction. The modified workflow to allow for such forecasters in addition is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 1: data specification</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="c1"># step 2: specifying forecasting horizon</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span>

<span class="c1"># step 3: specifying the forecasting algorithm</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># step 4: fitting the forecaster</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>

<span class="c1"># step 5: querying predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="forecasters-that-can-make-use-of-exogeneous-data">
<h4>1.2.3 Forecasters that can make use of exogeneous data<a class="anchor" id="section_1_2_3"></a><a class="headerlink" href="#forecasters-that-can-make-use-of-exogeneous-data" title="Link to this heading">#</a></h4>
<p>Many forecasters can make use of exogeneous time series, i.e., other time series that are not forecast, but are useful for forecasting <code class="docutils literal notranslate"><span class="pre">y</span></code>. Exogeneous time series are always passed as an <code class="docutils literal notranslate"><span class="pre">X</span></code> argument, in <code class="docutils literal notranslate"><span class="pre">fit</span></code>, <code class="docutils literal notranslate"><span class="pre">predict</span></code>, and other methods (see below). Exogeneous time series should always be passed as <code class="docutils literal notranslate"><span class="pre">pandas.DataFrames</span></code>. Most forecasters that can deal with exogeneous time series will assume that the time indices of <code class="docutils literal notranslate"><span class="pre">X</span></code> passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> are a super-set of the time indices in <code class="docutils literal notranslate"><span class="pre">y</span></code> passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code>; and that the time indices of <code class="docutils literal notranslate"><span class="pre">X</span></code> passed to <code class="docutils literal notranslate"><span class="pre">predict</span></code> are a super-set of time indices in <code class="docutils literal notranslate"><span class="pre">fh</span></code>, although this is not a general interface restriction. Forecasters that do not make use of exogeneous time series still accept the argument (and do not use it internally).</p>
<p>The general workflow for passing exogeneous data is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 1: data specification</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="c1"># we create some dummy exogeneous data</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># step 2: specifying forecasting horizon</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span>

<span class="c1"># step 3: specifying the forecasting algorithm</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># step 4: fitting the forecaster</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>

<span class="c1"># step 5: querying predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>NOTE: as in workflows 1.2.1 and 1.2.2, some forecasters that use exogeneous variables may also require the forecasting horizon only in <code class="docutils literal notranslate"><span class="pre">predict</span></code>. Such forecasters may also be called with steps 4 and 5 being</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="multivariate-forecasting">
<h4>1.2.4. Multivariate forecasting <a class="anchor" id="section_1_2_4"></a><a class="headerlink" href="#multivariate-forecasting" title="Link to this heading">#</a></h4>
<p>All forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> support multivariate forecasts - some forecasters are “genuine” multivariate, all others “apply by column”.</p>
<p>Below is an example of the general multivariate forecasting workflow, using the <code class="docutils literal notranslate"><span class="pre">VAR</span></code> (vector auto-regression) forecaster on the Longley dataset from <code class="docutils literal notranslate"><span class="pre">sktime.datasets</span></code>. The workflow is the same as in the univariate forecasters, but the input has more than one variables (columns).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_longley</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.var</span><span class="w"> </span><span class="kn">import</span> <span class="n">VAR</span>

<span class="n">_</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_longley</span><span class="p">()</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;UNEMP&quot;</span><span class="p">,</span> <span class="s2">&quot;ARMED&quot;</span><span class="p">,</span> <span class="s2">&quot;POP&quot;</span><span class="p">])</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">VAR</span><span class="p">()</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The input to the multivariate forecaster <code class="docutils literal notranslate"><span class="pre">y</span></code> is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> where each column is a variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GNPDEFL</th>
      <th>GNP</th>
    </tr>
    <tr>
      <th>Period</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1947</th>
      <td>83.0</td>
      <td>234289.0</td>
    </tr>
    <tr>
      <th>1948</th>
      <td>88.5</td>
      <td>259426.0</td>
    </tr>
    <tr>
      <th>1949</th>
      <td>88.2</td>
      <td>258054.0</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>89.5</td>
      <td>284599.0</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>96.2</td>
      <td>328975.0</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>98.1</td>
      <td>346999.0</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>99.0</td>
      <td>365385.0</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>100.0</td>
      <td>363112.0</td>
    </tr>
    <tr>
      <th>1955</th>
      <td>101.2</td>
      <td>397469.0</td>
    </tr>
    <tr>
      <th>1956</th>
      <td>104.6</td>
      <td>419180.0</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>108.4</td>
      <td>442769.0</td>
    </tr>
    <tr>
      <th>1958</th>
      <td>110.8</td>
      <td>444546.0</td>
    </tr>
    <tr>
      <th>1959</th>
      <td>112.6</td>
      <td>482704.0</td>
    </tr>
    <tr>
      <th>1960</th>
      <td>114.2</td>
      <td>502601.0</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>115.7</td>
      <td>518173.0</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>116.9</td>
      <td>554894.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result of the multivariate forecaster <code class="docutils literal notranslate"><span class="pre">y_pred</span></code> is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> where columns are the predicted values for each variable. The variables in <code class="docutils literal notranslate"><span class="pre">y_pred</span></code> are the same as in <code class="docutils literal notranslate"><span class="pre">y</span></code>, the input to the multivariate forecaster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GNPDEFL</th>
      <th>GNP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1963</th>
      <td>121.688295</td>
      <td>578514.398653</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>124.353664</td>
      <td>601873.015890</td>
    </tr>
    <tr>
      <th>1965</th>
      <td>126.847886</td>
      <td>625411.588754</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As said above, all forecasters accept multivariate input and will produce multivariate forecasts.
There are two categories:</p>
<ul class="simple">
<li><p>forecasters that are genuinely multivariate, such as <code class="docutils literal notranslate"><span class="pre">VAR</span></code>. Forecasts for one endogeneous (<code class="docutils literal notranslate"><span class="pre">y</span></code>) variable will depend on values of other variables.</p></li>
<li><p>forecasters that are univariate, such as <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>. Forecasts will be made by endogeneous (<code class="docutils literal notranslate"><span class="pre">y</span></code>) variable, and not be affected by other variables.</p></li>
</ul>
<p>To display complete list of multivariate forecasters, search for forecasters with <code class="docutils literal notranslate"><span class="pre">'multivariate'</span></code> or <code class="docutils literal notranslate"><span class="pre">'both'</span></code> tag value for the tag <code class="docutils literal notranslate"><span class="pre">'scitype:y'</span></code>, as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="k">for</span> <span class="n">forecaster</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">(</span><span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;scitype:y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;multivariate&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">]}):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">forecaster</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Univariate forecasters have tag value <code class="docutils literal notranslate"><span class="pre">'univariate'</span></code>, and will fit one model per column.
To access the column-wise models, access the <code class="docutils literal notranslate"><span class="pre">forecasters_</span></code> parameter, which stores the fitted forecasters in a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, fitted forecasters being in the column with the variable for which the forecast is being made:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_longley</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>

<span class="n">_</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_longley</span><span class="p">()</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;UNEMP&quot;</span><span class="p">,</span> <span class="s2">&quot;ARMED&quot;</span><span class="p">,</span> <span class="s2">&quot;POP&quot;</span><span class="p">])</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">()</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">forecasters_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GNPDEFL</th>
      <th>GNP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>forecasters</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="probabilistic-forecasting-prediction-intervals-quantile-variance-and-distributional-forecasts">
<h4>1.2.5 Probabilistic forecasting: prediction intervals, quantile, variance, and distributional forecasts <a class="anchor" id="section_1_2_5"></a><a class="headerlink" href="#probabilistic-forecasting-prediction-intervals-quantile-variance-and-distributional-forecasts" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides a unified interface to make probabilistic forecasts.
The following methods are possibly available for probabilistic forecasts:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> produces interval forecasts. Additionally to any <code class="docutils literal notranslate"><span class="pre">predict</span></code> arguments, an argument <code class="docutils literal notranslate"><span class="pre">coverage</span></code> (nominal interval coverage) must be provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> produces quantile forecasts. Additionally to any <code class="docutils literal notranslate"><span class="pre">predict</span></code> arguments, an argument <code class="docutils literal notranslate"><span class="pre">alpha</span></code> (quantile values) must be provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> produces variance forecasts. This has same arguments as <code class="docutils literal notranslate"><span class="pre">predict</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> produces full distributional forecasts. This has same arguments as <code class="docutils literal notranslate"><span class="pre">predict</span></code>.</p></li>
</ul>
<p>Not all forecasters are capable of returning probabilistic forecast, but if a forecasters provides one kind of probabilistic forecast, it is also capable of returning the others. The list of forecasters with such capability can be queried by <code class="docutils literal notranslate"><span class="pre">registry.all_estimators</span></code>, searching for those where the <code class="docutils literal notranslate"><span class="pre">capability:pred_int</span></code> tag has value<code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>The basic workflow for probabilistic forecasts is similar to the basic forecasting workflow, with the difference that instead of <code class="docutils literal notranslate"><span class="pre">predict</span></code>, one of the probabilistic forecasting methods is used:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.theta</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThetaForecaster</span>

<span class="c1"># until fit, identical with the simple workflow</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ThetaForecaster</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ThetaForecaster(sp=12)
</pre></div>
</div>
</div>
</div>
<p>Now we present the different probabilistic forecasting methods.</p>
<section id="predict-interval-interval-predictions">
<h5><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> - interval predictions<a class="headerlink" href="#predict-interval-interval-predictions" title="Link to this heading">#</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> takes an argument <code class="docutils literal notranslate"><span class="pre">coverage</span></code>, which is a float (or list of floats), the nominal coverage of the prediction interval(s) queried. <code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> produces symmetric prediction intervals, for example, a coverage of <code class="docutils literal notranslate"><span class="pre">0.9</span></code> returns a “lower” forecast at quantile <code class="docutils literal notranslate"><span class="pre">0.5</span> <span class="pre">-</span> <span class="pre">coverage/2</span> <span class="pre">=</span> <span class="pre">0.05</span></code>, and an “upper” forecast at quantile <code class="docutils literal notranslate"><span class="pre">0.5</span> <span class="pre">+</span> <span class="pre">coverage/2</span> <span class="pre">=</span> <span class="pre">0.95</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coverage</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">y_pred_ints</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span><span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">)</span>
<span class="n">y_pred_ints</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Coverage</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>418.280122</td>
      <td>464.281951</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>402.215882</td>
      <td>456.888054</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>459.966115</td>
      <td>522.110499</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>442.589311</td>
      <td>511.399213</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>443.525029</td>
      <td>518.409479</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>506.585817</td>
      <td>587.087736</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>561.496771</td>
      <td>647.248955</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>557.363325</td>
      <td>648.062362</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>477.658059</td>
      <td>573.047750</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>407.915093</td>
      <td>507.775353</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>346.942927</td>
      <td>451.082014</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>394.708224</td>
      <td>502.957139</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The return <code class="docutils literal notranslate"><span class="pre">y_pred_ints</span></code> is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with a column multi-index: The first level is variable name from <code class="docutils literal notranslate"><span class="pre">y</span></code> in fit (or <code class="docutils literal notranslate"><span class="pre">Coverage</span></code> if no variable names were present), second level coverage fractions for which intervals were computed, in the same order as in input <code class="docutils literal notranslate"><span class="pre">coverage</span></code>; third level columns <code class="docutils literal notranslate"><span class="pre">lower</span></code> and <code class="docutils literal notranslate"><span class="pre">upper</span></code>. Rows are the indices for which forecasts were made (same as in <code class="docutils literal notranslate"><span class="pre">y_pred</span></code> or <code class="docutils literal notranslate"><span class="pre">fh</span></code>). Entries are lower/upper (as column name) bound of the nominal coverage predictive interval for the index in the same row.</p>
<p>Pretty-plotting the predictive interval forecasts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">plotting</span>

<span class="c1"># also requires predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_series</span><span class="p">(</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">],</span> <span class="n">pred_interval</span><span class="o">=</span><span class="n">y_pred_ints</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../_images/1b611aa4b167a49583fb0c71140dacf9da1ec036f304ca7db24793071ec3097e.png" src="../../../../../_images/1b611aa4b167a49583fb0c71140dacf9da1ec036f304ca7db24793071ec3097e.png" />
</div>
</div>
</section>
<section id="predict-quantiles-quantile-forecasts">
<h5><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> - quantile forecasts<a class="headerlink" href="#predict-quantiles-quantile-forecasts" title="Link to this heading">#</a></h5>
<p>sktime offers <code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> as a unified interface to return quantile values of predictions. Similar to <code class="docutils literal notranslate"><span class="pre">predict_interval</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> has an argument <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, containing the quantile values being queried. Similar to the case of the <code class="docutils literal notranslate"><span class="pre">predict_interval</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha</span></code> can be a <code class="docutils literal notranslate"><span class="pre">float</span></code>, or a <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">floats</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_quantiles</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_quantiles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="mf">0.275</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">])</span>
<span class="n">y_pred_quantiles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Quantiles</th>
    </tr>
    <tr>
      <th></th>
      <th>0.275</th>
      <th>0.975</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>432.922220</td>
      <td>468.688317</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>419.617697</td>
      <td>462.124924</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>479.746288</td>
      <td>528.063108</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>464.491078</td>
      <td>517.990290</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>467.360287</td>
      <td>525.582417</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>532.209080</td>
      <td>594.798752</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>588.791161</td>
      <td>655.462877</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>586.232268</td>
      <td>656.750127</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>508.020008</td>
      <td>582.184819</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>439.699997</td>
      <td>517.340642</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>380.089755</td>
      <td>461.057159</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>429.163185</td>
      <td>513.325951</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">y_pred_quantiles</span></code>, the output of predict_quantiles, is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with a two-level column multiindex. The first level is variable name from <code class="docutils literal notranslate"><span class="pre">y</span></code> in fit (or <code class="docutils literal notranslate"><span class="pre">Quantiles</span></code> if no variable names were present), second level are the quantile values (from <code class="docutils literal notranslate"><span class="pre">alpha</span></code>) for which quantile predictions were queried. Rows are the indices for which forecasts were made (same as in <code class="docutils literal notranslate"><span class="pre">y_pred</span></code> or <code class="docutils literal notranslate"><span class="pre">fh</span></code>). Entries are the quantile predictions for that variable, that quantile value, for the time index in the same row.</p>
<p>Remark: for clarity: quantile and (symmetric) interval forecasts can be translated into each other as follows.</p>
<p><strong>alpha &lt; 0.5:</strong> The alpha-quantile prediction is equal to the lower bound of a predictive interval with coverage = (0.5 - alpha) * 2</p>
<p><strong>alpha &gt; 0.5:</strong> The alpha-quantile prediction is equal to the upper bound of a predictive interval with coverage = (alpha - 0.5) * 2</p>
</section>
<section id="predict-var-variance-predictions">
<h5><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> - variance predictions<a class="headerlink" href="#predict-var-variance-predictions" title="Link to this heading">#</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> produces variance predictions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_var</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_var</span><span class="p">()</span>
<span class="n">y_pred_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>195.540039</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>276.196489</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>356.852939</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>437.509389</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>518.165839</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>598.822289</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>679.478739</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>760.135189</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>840.791639</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>921.448089</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>1002.104539</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>1082.760989</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The format of the output <code class="docutils literal notranslate"><span class="pre">y_pred_var</span></code> is the same as for <code class="docutils literal notranslate"><span class="pre">predict</span></code>, except that this is always coerced to a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, and entries are not point predictions but variance predictions.</p>
</section>
<section id="predict-proba-distribution-predictions">
<h5><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> - distribution predictions<a class="headerlink" href="#predict-proba-distribution-predictions" title="Link to this heading">#</a></h5>
<p>To predict full predictive distributions, <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> can be used.
As this returns <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> objects, the deep learning dependency set <code class="docutils literal notranslate"><span class="pre">dl</span></code> of <code class="docutils literal notranslate"><span class="pre">sktime</span></code> (which includes <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> and <code class="docutils literal notranslate"><span class="pre">tensorflow-probability</span></code> dependencies) must be installed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_proba</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">()</span>
<span class="n">y_pred_proba</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;tfp.distributions.Normal &#39;Normal&#39; batch_shape=[12, 1] event_shape=[] dtype=float32&gt;
</pre></div>
</div>
</div>
</div>
<p>Distributions returned by <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> are by default marginal at time points, not joint over time points.
More precisely, the returned <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> object is formatted and to be interpreted as follows:</p>
<ul class="simple">
<li><p>Batch shape is 1D and same length as fh</p></li>
<li><p>Event shape is 1D, with length equal to number of variables being forecast</p></li>
<li><p>i-th (batch) distribution is forecast for i-th entry of fh</p></li>
<li><p>j-th (event) component is j-th variable, same order as y in <code class="docutils literal notranslate"><span class="pre">fit</span></code>/<code class="docutils literal notranslate"><span class="pre">update</span></code></p></li>
</ul>
<p>To return joint forecast distributions, the <code class="docutils literal notranslate"><span class="pre">marginal</span></code> parameter can be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> (currently work in progress). In this case, a <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> with 2D event shape <code class="docutils literal notranslate"><span class="pre">(len(fh),</span> <span class="pre">len(y))</span></code> is returned.</p>
</section>
</section>
<section id="panel-forecasts-and-hierarchical-forecasts">
<h4>1.2.6 Panel forecasts and hierarchical forecasts <a class="anchor" id="section_1_2_6"></a><a class="headerlink" href="#panel-forecasts-and-hierarchical-forecasts" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides a unified interface to make panel and hierarchical forecasts.</p>
<p>All <code class="docutils literal notranslate"><span class="pre">sktime</span></code> forecasters can be applied to panel and hierarchical data, which needs to be presented in specific input formats.
Forecasters that are not genuinely panel or hierarchical forecasters will be applied by instance.</p>
<p>The recommended (not the only) format to pass panel and hierarchical data is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> row. In this <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>, the last level must be in an <code class="docutils literal notranslate"><span class="pre">sktime</span></code> compatible time index format, the remaining levels are panel or hierarchy nodes.</p>
<p>Example data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.hierarchical</span><span class="w"> </span><span class="kn">import</span> <span class="n">_bottom_hier_datagen</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">_bottom_hier_datagen</span><span class="p">(</span><span class="n">no_levels</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>passengers</th>
    </tr>
    <tr>
      <th>l2_agg</th>
      <th>l1_agg</th>
      <th>timepoints</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">l2_node01</th>
      <th rowspan="5" valign="top">l1_node04</th>
      <th>1949-01</th>
      <td>1751.046693</td>
    </tr>
    <tr>
      <th>1949-02</th>
      <td>1847.272729</td>
    </tr>
    <tr>
      <th>1949-03</th>
      <td>2072.660808</td>
    </tr>
    <tr>
      <th>1949-04</th>
      <td>2024.264252</td>
    </tr>
    <tr>
      <th>1949-05</th>
      <td>1895.470000</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">l2_node03</th>
      <th rowspan="5" valign="top">l1_node05</th>
      <th>1960-08</th>
      <td>7843.728855</td>
    </tr>
    <tr>
      <th>1960-09</th>
      <td>6557.204770</td>
    </tr>
    <tr>
      <th>1960-10</th>
      <td>5942.431795</td>
    </tr>
    <tr>
      <th>1960-11</th>
      <td>5016.687658</td>
    </tr>
    <tr>
      <th>1960-12</th>
      <td>5563.869028</td>
    </tr>
  </tbody>
</table>
<p>864 rows × 1 columns</p>
</div></div></div>
</div>
<p>As stated, all forecasters, genuinely hierarchical or not, can be applied, with all workflows described in this section, to produce hierarchical forecasts.</p>
<p>The syntax is exactly the same as for plain time series, except for the hierarchy levels in input and output data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>

<span class="n">fh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">()</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>passengers</th>
    </tr>
    <tr>
      <th>l2_agg</th>
      <th>l1_agg</th>
      <th>timepoints</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">l2_node01</th>
      <th rowspan="3" valign="top">l1_node04</th>
      <th>1961-01</th>
      <td>7025.301868</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>6932.869186</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>6843.846928</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">l2_node02</th>
      <th rowspan="3" valign="top">l1_node01</th>
      <th>1961-01</th>
      <td>426.544850</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>421.282983</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>416.207550</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">l1_node02</th>
      <th>1961-01</th>
      <td>2831.238136</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>2796.463164</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>2762.919857</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">l1_node03</th>
      <th>1961-01</th>
      <td>3281.334598</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>3235.589398</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>3191.591150</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">l1_node06</th>
      <th>1961-01</th>
      <td>699.784723</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>687.976011</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>676.678320</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">l2_node03</th>
      <th rowspan="3" valign="top">l1_node05</th>
      <th>1961-01</th>
      <td>5492.522368</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>5423.732250</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>5357.407064</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Similar to multivariate forecasting, forecasters that are not genuinely hierarchical fit by instance.
The forecasters fitted by instance can be accessed in the <code class="docutils literal notranslate"><span class="pre">forecasters_</span></code> parameter, which is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> where forecasters for a given instance are placed in the row with the index of the instance for which they make forecasts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">forecasters_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>forecasters</th>
    </tr>
    <tr>
      <th>l2_agg</th>
      <th>l1_agg</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>l2_node01</th>
      <th>l1_node04</th>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">l2_node02</th>
      <th>l1_node01</th>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>l1_node02</th>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>l1_node03</th>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>l1_node06</th>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>l2_node03</th>
      <th>l1_node05</th>
      <td>ARIMA()</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If the data is both hierarchical and multivariate, and the forecaster cannot genuinely deal with either, the <code class="docutils literal notranslate"><span class="pre">forecasters_</span></code> attribute will have both column indices, for variables, and row indices, for instances, with forecasters fitted per instance and variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.hierarchical</span><span class="w"> </span><span class="kn">import</span> <span class="n">_make_hierarchical</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">_make_hierarchical</span><span class="p">(</span><span class="n">n_columns</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">()</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">forecasters_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>c0</th>
      <th>c1</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">h0_0</th>
      <th>h1_0</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>h1_1</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>h1_2</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>h1_3</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">h0_1</th>
      <th>h1_0</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>h1_1</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>h1_2</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
    <tr>
      <th>h1_3</th>
      <td>ARIMA()</td>
      <td>ARIMA()</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Further details on hierarchical forecasting, including reduction, aggregation, reconciliation, are presented in the “hierarchical forecasting” tutorial.</p>
</section>
</section>
<section id="basic-evaluation-workflow-evaluating-a-batch-of-forecasts-against-ground-truth-observations">
<h3>1.3 Basic evaluation workflow - evaluating a batch of forecasts against ground truth observations<a class="anchor" id="section_1_3"></a><a class="headerlink" href="#basic-evaluation-workflow-evaluating-a-batch-of-forecasts-against-ground-truth-observations" title="Link to this heading">#</a></h3>
<p>It is good practice to evaluate statistical performance of a forecaster before deploying it, and regularly re-evaluate performance if in continuous deployment. The evaluation workflow for the basic batch forecasting task, as solved by the workflow in Section 1.2, consists of comparing batch forecasts with actuals. This is sometimes called (batch-wise) backtesting.</p>
<p>The basic evaluation workflow is as follows:</p>
<ol class="arabic simple">
<li><p>Splitting a representatively chosen historical series into a temporal training and test set. The test set should be temporally in the future of the training set.</p></li>
<li><p>Obtaining batch forecasts, as in Section 1.2, by fitting a forecaster to the training set, and querying predictions for the test set</p></li>
<li><p>Specifying a quantitative performance metric to compare the actual test set against predictions</p></li>
<li><p>Computing the quantitative performance on the test set</p></li>
<li><p>Testing whether this performance is statistically better than a chosen baseline performance</p></li>
</ol>
<p>NOTE: Step 5 (testing) is currently not supported in <code class="docutils literal notranslate"><span class="pre">sktime</span></code>, but is on the development roadmap. For the time being, it is advised to use custom implementations of appropriate methods (e.g., Diebold-Mariano test; stationary confidence intervals).</p>
<p>NOTE: Note that this evaluation set-up determines how well a given algorithm would have performed on past data. Results are only insofar representative as future performance can be assumed to mirror past performance. This can be argued under certain assumptions (e.g., stationarity), but will in general be false. Monitoring of forecasting performance is hence advised in case an algorithm is applied multiple times.</p>
<p><strong>Example:</strong> In the example, we will us the same airline data as in Section 1.2. But, instead of predicting the next 3 years, we hold out the last 3 years of the airline data (below: <code class="docutils literal notranslate"><span class="pre">y_test</span></code>), and see how the forecaster would have performed three years ago, when asked to forecast the most recent 3 years (below: <code class="docutils literal notranslate"><span class="pre">y_pred</span></code>), from the years before (below: <code class="docutils literal notranslate"><span class="pre">y_train</span></code>). “how” is measured by a quantitative performance metric (below: <code class="docutils literal notranslate"><span class="pre">mean_absolute_percentage_error</span></code>). This is then considered as an indication of how well the forecaster would perform in the coming 3 years (what was done in Section 1.2). This may or may not be a stretch depending on statistical assumptions and data properties (caution: it often is a stretch - past performance is in general not indicative of future performance).</p>
<section id="step-1-splitting-a-historical-data-set-in-to-a-temporal-train-and-test-batch">
<h4>Step 1 - Splitting a historical data set in to a temporal train and test batch<a class="headerlink" href="#step-1-splitting-a-historical-data-set-in-to-a-temporal-train-and-test-batch" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">temporal_train_test_split</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
<span class="c1"># we will try to forecast y_test from y_train</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting for illustration</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../_images/f7ae5ff0eb8343537576b865174957c9131e59615816cb0cbd659e9c34299509.png" src="../../../../../_images/f7ae5ff0eb8343537576b865174957c9131e59615816cb0cbd659e9c34299509.png" />
</div>
</div>
</section>
<section id="step-2-making-forecasts-for-y-test-from-y-train">
<h4>Step 2 - Making forecasts for y_test from y_train<a class="headerlink" href="#step-2-making-forecasts-for-y-test-from-y-train" title="Link to this heading">#</a></h4>
<p>This is almost verbatim the workflow in Section 1.2, using <code class="docutils literal notranslate"><span class="pre">y_train</span></code> to predict the indices of <code class="docutils literal notranslate"><span class="pre">y_test</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we can simply take the indices from `y_test` where they already are stored</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">ForecastingHorizon</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">is_relative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>

<span class="c1"># y_pred will contain the predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting for illustration</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1152x288 with 1 Axes&gt;,
 &lt;AxesSubplot:ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/fd26a62fa71978b11daaf5aadc7fbf9026a063fc1883c91325c7c86b624f5fa1.png" src="../../../../../_images/fd26a62fa71978b11daaf5aadc7fbf9026a063fc1883c91325c7c86b624f5fa1.png" />
</div>
</div>
</section>
<section id="steps-3-and-4-specifying-a-forecasting-metric-evaluating-on-the-test-set">
<h4>Steps 3 and 4 - Specifying a forecasting metric, evaluating on the test set<a class="headerlink" href="#steps-3-and-4-specifying-a-forecasting-metric-evaluating-on-the-test-set" title="Link to this heading">#</a></h4>
<p>The next step is to specify a forecasting metric. These are functions that return a number when input with prediction and actual series. They are different from <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> metrics in that they accept series with indices rather than <code class="docutils literal notranslate"><span class="pre">np.array</span></code>s. Forecasting metrics can be invoked in two ways:</p>
<ul class="simple">
<li><p>using the lean function interface, e.g., <code class="docutils literal notranslate"><span class="pre">mean_absolute_percentage_error</span></code> which is a python function <code class="docutils literal notranslate"><span class="pre">(y_true</span> <span class="pre">:</span> <span class="pre">pd.Series,</span> <span class="pre">y_pred</span> <span class="pre">:</span> <span class="pre">pd.Series)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code></p></li>
<li><p>using the composable class interface, e.g., <code class="docutils literal notranslate"><span class="pre">MeanAbsolutePercentageError</span></code>, which is a python class, callable with the same signature</p></li>
</ul>
<p>Casual users may opt to use the function interface. The class interface supports advanced use cases, such as parameter modification, custom metric composition, tuning over metric parameters (not covered in this tutorial)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># option 1: using the lean function interface</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># note: the FIRST argument is the ground truth, the SECOND argument are the forecasts</span>
<span class="c1">#       the order matters for most metrics in general</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13189432350948402
</pre></div>
</div>
</div>
</div>
<p>To properly interpret numbers like this, it is useful to understand properties of the metric in question (e.g., lower is better), and to compare against suitable baselines and contender algorithms (see step 5).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting</span><span class="w"> </span><span class="kn">import</span> <span class="n">MeanAbsolutePercentageError</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># option 2: using the composable class interface</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">MeanAbsolutePercentageError</span><span class="p">(</span><span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># the class interface allows to easily construct variants of the MAPE</span>
<span class="c1">#  e.g., the non-symmetric version</span>
<span class="c1"># it also allows for inspection of metric properties</span>
<span class="c1">#  e.g., are higher values better (answer: no)?</span>
<span class="n">mape</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s2">&quot;lower_is_better&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># evaluation works exactly like in option 2, but with the instantiated object</span>
<span class="n">mape</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13189432350948402
</pre></div>
</div>
</div>
</div>
<p>NOTE: Some metrics, such as <code class="docutils literal notranslate"><span class="pre">mean_absolute_scaled_error</span></code>, also require the training set for evaluation. In this case, the training set should be passed as a <code class="docutils literal notranslate"><span class="pre">y_train</span></code> argument. Refer to the API reference on individual metrics.</p>
<p>NOTE: The workflow is the same for forecasters that make use of exogeneous data - no <code class="docutils literal notranslate"><span class="pre">X</span></code> is passed to the metrics.</p>
</section>
<section id="step-5-testing-performance-against-benchmarks">
<h4>Step 5 - Testing performance against benchmarks<a class="headerlink" href="#step-5-testing-performance-against-benchmarks" title="Link to this heading">#</a></h4>
<p>In general, forecast performances should be quantitatively tested against benchmark performances.</p>
<p>Currently (<code class="docutils literal notranslate"><span class="pre">sktime</span></code> v0.12.x), this is a roadmap development item. Contributions are very welcome.</p>
</section>
<section id="the-basic-batch-forecast-evaluation-workflow-in-a-nutshell-function-metric-interface">
<h4>1.3.1 The basic batch forecast evaluation workflow in a nutshell - function metric interface<a class="anchor" id="section_1_3_1"></a><a class="headerlink" href="#the-basic-batch-forecast-evaluation-workflow-in-a-nutshell-function-metric-interface" title="Link to this heading">#</a></h4>
<p>For convenience, we present the basic batch forecast evaluation workflow in one cell.
This cell is using the lean function metric interface.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingHorizon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">temporal_train_test_split</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 1: splitting historical data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>

<span class="c1"># step 2: running the basic forecasting workflow</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">ForecastingHorizon</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">is_relative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>

<span class="c1"># step 3: specifying the evaluation metric and</span>
<span class="c1"># step 4: computing the forecast performance</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># step 5: testing forecast performance against baseline</span>
<span class="c1"># under development</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13189432350948402
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-basic-batch-forecast-evaluation-workflow-in-a-nutshell-metric-class-interface">
<h4>1.3.2 The basic batch forecast evaluation workflow in a nutshell - metric class interface<a class="anchor" id="section_1_3_2"></a><a class="headerlink" href="#the-basic-batch-forecast-evaluation-workflow-in-a-nutshell-metric-class-interface" title="Link to this heading">#</a></h4>
<p>For convenience, we present the basic batch forecast evaluation workflow in one cell.
This cell is using the advanced class specification interface for metrics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingHorizon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting</span><span class="w"> </span><span class="kn">import</span> <span class="n">MeanAbsolutePercentageError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">temporal_train_test_split</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 1: splitting historical data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>

<span class="c1"># step 2: running the basic forecasting workflow</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">ForecastingHorizon</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">is_relative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>

<span class="c1"># step 3: specifying the evaluation metric</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">MeanAbsolutePercentageError</span><span class="p">(</span><span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># if function interface is used, just use the function directly in step 4</span>

<span class="c1"># step 4: computing the forecast performance</span>
<span class="n">mape</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="c1"># step 5: testing forecast performance against baseline</span>
<span class="c1"># under development</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13189432350948402
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="advanced-deployment-workflow-rolling-updates-forecasts">
<h3>1.4 Advanced deployment workflow: rolling updates &amp; forecasts<a class="anchor" id="section_1_4"></a><a class="headerlink" href="#advanced-deployment-workflow-rolling-updates-forecasts" title="Link to this heading">#</a></h3>
<p>A common use case requires the forecaster to regularly update with new data and make forecasts on a rolling basis. This is especially useful if the same kind of forecast has to be made at regular time points, e.g., daily or weekly. <code class="docutils literal notranslate"><span class="pre">sktime</span></code> forecasters support this type of deployment workflow via the <code class="docutils literal notranslate"><span class="pre">update</span></code> and <code class="docutils literal notranslate"><span class="pre">update_predict</span></code> methods.</p>
</section>
<section id="updating-a-forecaster-with-the-update-method">
<h3>1.4.1 Updating a forecaster with the <code class="docutils literal notranslate"><span class="pre">update</span></code> method<a class="anchor" id="section_1_4_1"></a><a class="headerlink" href="#updating-a-forecaster-with-the-update-method" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">update</span></code> method can be called when a forecaster is already fitted, to ingest new data and make updated forecasts - this is referred to as an “update step”.</p>
<p>After the update, the forecaster’s internal “now” state (the <code class="docutils literal notranslate"><span class="pre">cutoff</span></code>) is set to the latest time stamp seen in the update batch (assumed to be later than previously seen data).</p>
<p>The general pattern is as follows:</p>
<ol class="arabic simple">
<li><p>Specify a forecasting strategy</p></li>
<li><p>Specify a relative forecasting horizon</p></li>
<li><p>Fit the forecaster to an initial batch of data using <code class="docutils literal notranslate"><span class="pre">fit</span></code></p></li>
<li><p>Make forecasts for the relative forecasting horizon, using <code class="docutils literal notranslate"><span class="pre">predict</span></code></p></li>
<li><p>Obtain new data; use <code class="docutils literal notranslate"><span class="pre">update</span></code> to ingest new data</p></li>
<li><p>Make forecasts using <code class="docutils literal notranslate"><span class="pre">predict</span></code> for the updated data</p></li>
<li><p>Repeat 5 and 6 as often as required</p></li>
</ol>
<p><strong>Example</strong>: suppose that, in the airline example, we want to make forecasts a year ahead, but every month, starting December 1957. The first few months, forecasts would be made as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.ets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoETS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_series</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we prepare the full data set for convenience</span>
<span class="c1"># note that in the scenario we will &quot;know&quot; only part of this at certain time points</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># December 1957</span>

<span class="c1"># this is the data known in December 1957</span>
<span class="n">y_1957Dec</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">36</span><span class="p">]</span>

<span class="c1"># step 1: specifying the forecasting strategy</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">AutoETS</span><span class="p">(</span><span class="n">auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># step 2: specifying the forecasting horizon: one year ahead, all months</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

<span class="c1"># step 3: this is the first time we use the model, so we fit it</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_1957Dec</span><span class="p">)</span>

<span class="c1"># step 4: obtaining the first batch of forecasts for Jan 1958 - Dec 1958</span>
<span class="n">y_pred_1957Dec</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting predictions and past data</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_1957Dec</span><span class="p">,</span> <span class="n">y_pred_1957Dec</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_1957Dec&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred_1957Dec&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1152x288 with 1 Axes&gt;,
 &lt;AxesSubplot:ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/94686a76c8e2fc058ef2dfea2609383f6d9a7eb4841606ba666fb0391d839217.png" src="../../../../../_images/94686a76c8e2fc058ef2dfea2609383f6d9a7eb4841606ba666fb0391d839217.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># January 1958</span>

<span class="c1"># new data is observed:</span>
<span class="n">y_1958Jan</span> <span class="o">=</span> <span class="n">y</span><span class="p">[[</span><span class="o">-</span><span class="mi">36</span><span class="p">]]</span>

<span class="c1"># step 5: we update the forecaster with the new data</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">y_1958Jan</span><span class="p">)</span>

<span class="c1"># step 6: making forecasts with the updated data</span>
<span class="n">y_pred_1958Jan</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># note that the fh is relative, so forecasts are automatically for 1 month later</span>
<span class="c1">#  i.e., from Feb 1958 to Jan 1959</span>
<span class="n">y_pred_1958Jan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1958-02    341.514630
1958-03    392.849241
1958-04    378.518543
1958-05    375.658188
1958-06    426.006944
1958-07    470.569699
1958-08    467.100443
1958-09    414.450926
1958-10    360.957054
1958-11    315.202860
1958-12    357.898458
1959-01    363.036833
Freq: M, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting predictions and past data</span>
<span class="n">plot_series</span><span class="p">(</span>
    <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">35</span><span class="p">],</span>
    <span class="n">y_pred_1957Dec</span><span class="p">,</span>
    <span class="n">y_pred_1958Jan</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_1957Dec&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred_1957Dec&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred_1958Jan&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1152x288 with 1 Axes&gt;,
 &lt;AxesSubplot:ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/628dcd7b5c3c77db793aedff7d7c1768bbf1c1e6b5dcabbdafc93936089b09aa.png" src="../../../../../_images/628dcd7b5c3c77db793aedff7d7c1768bbf1c1e6b5dcabbdafc93936089b09aa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># February 1958</span>

<span class="c1"># new data is observed:</span>
<span class="n">y_1958Feb</span> <span class="o">=</span> <span class="n">y</span><span class="p">[[</span><span class="o">-</span><span class="mi">35</span><span class="p">]]</span>

<span class="c1"># step 5: we update the forecaster with the new data</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">y_1958Feb</span><span class="p">)</span>

<span class="c1"># step 6: making forecasts with the updated data</span>
<span class="n">y_pred_1958Feb</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting predictions and past data</span>
<span class="n">plot_series</span><span class="p">(</span>
    <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">35</span><span class="p">],</span>
    <span class="n">y_pred_1957Dec</span><span class="p">,</span>
    <span class="n">y_pred_1958Jan</span><span class="p">,</span>
    <span class="n">y_pred_1958Feb</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_1957Dec&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred_1957Dec&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred_1958Jan&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred_1958Feb&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1152x288 with 1 Axes&gt;,
 &lt;AxesSubplot:ylabel=&#39;Number of airline passengers&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../_images/09b30845ed625dfac20c2bd27f7c11748a7639443d68dfbc941350a259591591.png" src="../../../../../_images/09b30845ed625dfac20c2bd27f7c11748a7639443d68dfbc941350a259591591.png" />
</div>
</div>
<p>… and so on.</p>
<p>A shorthand for running first <code class="docutils literal notranslate"><span class="pre">update</span></code> and then <code class="docutils literal notranslate"><span class="pre">predict</span></code> is <code class="docutils literal notranslate"><span class="pre">update_predict_single</span></code> - for some algorithms, this may be more efficient than the separate calls to <code class="docutils literal notranslate"><span class="pre">update</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># March 1958</span>

<span class="c1"># new data is observed:</span>
<span class="n">y_1958Mar</span> <span class="o">=</span> <span class="n">y</span><span class="p">[[</span><span class="o">-</span><span class="mi">34</span><span class="p">]]</span>

<span class="c1"># step 5&amp;6: update/predict in one step</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">update_predict_single</span><span class="p">(</span><span class="n">y_1958Mar</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1958-04    349.161935
1958-05    346.920065
1958-06    394.051656
1958-07    435.839910
1958-08    433.316755
1958-09    384.841740
1958-10    335.535138
1958-11    293.171527
1958-12    333.275492
1959-01    338.595127
1959-02    336.983070
1959-03    388.121198
Freq: M, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="moving-the-now-state-without-updating-the-model">
<h3>1.4.2 Moving the “now” state without updating the model<a class="anchor" id="section_1_4_2"></a><a class="headerlink" href="#moving-the-now-state-without-updating-the-model" title="Link to this heading">#</a></h3>
<p>In the rolling deployment mode, may be useful to move the estimator’s “now” state (the <code class="docutils literal notranslate"><span class="pre">cutoff</span></code>) to later, for example if no new data was observed, but time has progressed; or, if computations take too long, and forecasts have to be queried.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">update</span></code> interface provides an option for this, via the <code class="docutils literal notranslate"><span class="pre">update_params</span></code> argument of <code class="docutils literal notranslate"><span class="pre">update</span></code> and other update functions.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">update_params</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, no model update computations are performed; only data is stored, and the internal “now” state (the <code class="docutils literal notranslate"><span class="pre">cutoff</span></code>) is set to the most recent date.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># April 1958</span>

<span class="c1"># new data is observed:</span>
<span class="n">y_1958Apr</span> <span class="o">=</span> <span class="n">y</span><span class="p">[[</span><span class="o">-</span><span class="mi">33</span><span class="p">]]</span>

<span class="c1"># step 5: perform an update without re-computing the model parameters</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">y_1958Apr</span><span class="p">,</span> <span class="n">update_params</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoETS(auto=True, n_jobs=-1, sp=12)
</pre></div>
</div>
</div>
</div>
</section>
<section id="walk-forward-predictions-on-a-batch-of-data">
<h3>1.4.3 Walk-forward predictions on a batch of data<a class="anchor" id="section_1_4_3"></a><a class="headerlink" href="#walk-forward-predictions-on-a-batch-of-data" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> can also simulate the update/predict deployment mode with a full batch of data.</p>
<p>This is not useful in deployment, as it requires all data to be available in advance; however, it is useful in playback, such as for simulations or model evaluation.</p>
<p>The update/predict playback mode can be called using <code class="docutils literal notranslate"><span class="pre">update_predict</span></code> and a re-sampling constructor which encodes the precise walk-forward scheme.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from sktime.datasets import load_airline</span>
<span class="c1"># from sktime.forecasting.ets import AutoETS</span>
<span class="c1"># from sktime.split import ExpandingWindowSplitter</span>
<span class="c1"># from sktime.utils.plotting import plot_series</span>
</pre></div>
</div>
</div>
</div>
<p>NOTE: commented out - this part of the interface is currently undergoing a re-work. Contributions and PR are appreciated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for playback, the full data needs to be loaded in advance</span>
<span class="c1"># y = load_airline()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 1: specifying the forecasting strategy</span>
<span class="c1"># forecaster = AutoETS(auto=True, sp=12, n_jobs=-1)</span>

<span class="c1"># step 2: specifying the forecasting horizon</span>
<span class="c1"># fh - np.arange(1, 13)</span>

<span class="c1"># step 3: specifying the cross-validation scheme</span>
<span class="c1"># cv = ExpandingWindowSplitter()</span>

<span class="c1"># step 4: fitting the forecaster - fh should be passed here</span>
<span class="c1"># forecaster.fit(y[:-36], fh=fh)</span>

<span class="c1"># step 5: rollback</span>
<span class="c1"># y_preds = forecaster.update_predict(y, cv)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="advanced-evaluation-workflow-rolling-re-sampling-and-aggregate-errors-rolling-back-testing">
<h3>1.5 Advanced evaluation workflow: rolling re-sampling and aggregate errors, rolling back-testing<a class="anchor" id="section_1_5"></a><a class="headerlink" href="#advanced-evaluation-workflow-rolling-re-sampling-and-aggregate-errors-rolling-back-testing" title="Link to this heading">#</a></h3>
<p>To evaluate forecasters with respect to their performance in rolling forecasting, the forecaster needs to be tested in a set-up mimicking rolling forecasting, usually on past data. Note that the batch back-testing as in Section 1.3 would not be an appropriate evaluation set-up for rolling deployment, as that tests only a single forecast batch.</p>
<p>The advanced evaluation workflow can be carried out using the <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> benchmarking function.
<code class="docutils literal notranslate"><span class="pre">evaluate</span></code> takes as arguments:</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">forecaster</span></code> to be evaluated</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> re-sampling strategy for temporal splitting (<code class="docutils literal notranslate"><span class="pre">cv</span></code> below), e.g., <code class="docutils literal notranslate"><span class="pre">ExpandingWindowSplitter</span></code> or <code class="docutils literal notranslate"><span class="pre">SlidingWindowSplitter</span></code></p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">strategy</span></code> (string): whether the forecaster should be always be refitted or just fitted once and then updated</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.model_evaluation</span><span class="w"> </span><span class="kn">import</span> <span class="n">evaluate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpandingWindowSplitter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">AutoARIMA</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cv</span> <span class="o">=</span> <span class="n">ExpandingWindowSplitter</span><span class="p">(</span>
    <span class="n">step_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="n">initial_window</span><span class="o">=</span><span class="mi">72</span>
<span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;refit&quot;</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>test_MeanAbsolutePercentageError</th>
      <th>fit_time</th>
      <th>pred_time</th>
      <th>len_train_window</th>
      <th>cutoff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.061710</td>
      <td>4.026436</td>
      <td>0.006171</td>
      <td>72</td>
      <td>1954-12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.050042</td>
      <td>5.211994</td>
      <td>0.006386</td>
      <td>84</td>
      <td>1955-12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.029802</td>
      <td>8.024385</td>
      <td>0.005885</td>
      <td>96</td>
      <td>1956-12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.053773</td>
      <td>4.231226</td>
      <td>0.005654</td>
      <td>108</td>
      <td>1957-12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.073820</td>
      <td>5.250797</td>
      <td>0.006525</td>
      <td>120</td>
      <td>1958-12</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.030976</td>
      <td>11.651850</td>
      <td>0.006294</td>
      <td>132</td>
      <td>1959-12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualization of a forecaster evaluation</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_series</span><span class="p">(</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_pred&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_pred&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_pred&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_pred&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_pred&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_pred&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
    <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">],</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_true&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;y_pred (Backtest &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../_images/3f33ee09505f01678bce633bb2a4b709868c9a9cd028577b4590bb00117cea52.png" src="../../../../../_images/3f33ee09505f01678bce633bb2a4b709868c9a9cd028577b4590bb00117cea52.png" />
</div>
</div>
<p>Todo: performance metrics, averages, and testing - contributions to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> and the tutorial are welcome.</p>
</section>
</section>
<section id="forecasters-in-sktime-lookup-properties-main-families">
<h2>2. Forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> - lookup, properties, main families<a class="anchor" id="chapter2"></a><a class="headerlink" href="#forecasters-in-sktime-lookup-properties-main-families" title="Link to this heading">#</a></h2>
<p>This section summarizes how to:</p>
<ul class="simple">
<li><p>search for forecasters in sktime</p></li>
<li><p>properties of forecasters, corresponding search options and tags</p></li>
<li><p>commonly used types of forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code></p></li>
</ul>
<section id="listing-all-forecasters-in-sktime">
<h3>2.1 Listing all forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="section_2_1"></a><a class="headerlink" href="#listing-all-forecasters-in-sktime" title="Link to this heading">#</a></h3>
<p>Generally, all forecasters available in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> can be listed with the <code class="docutils literal notranslate"><span class="pre">all_estimators</span></code> command.</p>
<p>This will list all forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code>, even those whose soft dependencies are not installed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="n">all_estimators</span><span class="p">(</span><span class="s2">&quot;forecaster&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>estimator</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ARIMA</td>
      <td>&lt;class 'sktime.forecasting.arima.ARIMA'&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AutoARIMA</td>
      <td>&lt;class 'sktime.forecasting.arima.AutoARIMA'&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AutoETS</td>
      <td>&lt;class 'sktime.forecasting.ets.AutoETS'&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AutoEnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._ensemble.A...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BATS</td>
      <td>&lt;class 'sktime.forecasting.bats.BATS'&gt;</td>
    </tr>
    <tr>
      <th>5</th>
      <td>BaggingForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._bagging.Ba...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ColumnEnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._column_ens...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ConformalIntervals</td>
      <td>&lt;class 'sktime.forecasting.conformal.Conformal...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Croston</td>
      <td>&lt;class 'sktime.forecasting.croston.Croston'&gt;</td>
    </tr>
    <tr>
      <th>9</th>
      <td>DirRecTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>DirRecTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>DirectTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>DirectTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>DontUpdate</td>
      <td>&lt;class 'sktime.forecasting.stream._update.Dont...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>DynamicFactor</td>
      <td>&lt;class 'sktime.forecasting.dynamic_factor.Dyna...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>EnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._ensemble.E...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ExponentialSmoothing</td>
      <td>&lt;class 'sktime.forecasting.exp_smoothing.Expon...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ForecastX</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.F...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>ForecastingGridSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ForecastingPipeline</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.F...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>ForecastingRandomizedSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>MultioutputTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Mul...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>MultioutputTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Mul...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>MultiplexForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._multiplexe...</td>
    </tr>
    <tr>
      <th>24</th>
      <td>NaiveForecaster</td>
      <td>&lt;class 'sktime.forecasting.naive.NaiveForecast...</td>
    </tr>
    <tr>
      <th>25</th>
      <td>NaiveVariance</td>
      <td>&lt;class 'sktime.forecasting.naive.NaiveVariance'&gt;</td>
    </tr>
    <tr>
      <th>26</th>
      <td>OnlineEnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.online_learning._on...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>PolynomialTrendForecaster</td>
      <td>&lt;class 'sktime.forecasting.trend.PolynomialTre...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Prophet</td>
      <td>&lt;class 'sktime.forecasting.fbprophet.Prophet'&gt;</td>
    </tr>
    <tr>
      <th>29</th>
      <td>ReconcilerForecaster</td>
      <td>&lt;class 'sktime.forecasting.reconcile.Reconcile...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>RecursiveTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Rec...</td>
    </tr>
    <tr>
      <th>31</th>
      <td>RecursiveTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Rec...</td>
    </tr>
    <tr>
      <th>32</th>
      <td>SARIMAX</td>
      <td>&lt;class 'sktime.forecasting.sarimax.SARIMAX'&gt;</td>
    </tr>
    <tr>
      <th>33</th>
      <td>STLForecaster</td>
      <td>&lt;class 'sktime.forecasting.trend.STLForecaster'&gt;</td>
    </tr>
    <tr>
      <th>34</th>
      <td>StackingForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._stack.Stac...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>StatsForecastAutoARIMA</td>
      <td>&lt;class 'sktime.forecasting.statsforecast.Stats...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>TBATS</td>
      <td>&lt;class 'sktime.forecasting.tbats.TBATS'&gt;</td>
    </tr>
    <tr>
      <th>37</th>
      <td>ThetaForecaster</td>
      <td>&lt;class 'sktime.forecasting.theta.ThetaForecast...</td>
    </tr>
    <tr>
      <th>38</th>
      <td>TransformedTargetForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.T...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>TrendForecaster</td>
      <td>&lt;class 'sktime.forecasting.trend.TrendForecast...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>UnobservedComponents</td>
      <td>&lt;class 'sktime.forecasting.structural.Unobserv...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>UpdateEvery</td>
      <td>&lt;class 'sktime.forecasting.stream._update.Upda...</td>
    </tr>
    <tr>
      <th>42</th>
      <td>UpdateRefitsEvery</td>
      <td>&lt;class 'sktime.forecasting.stream._update.Upda...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>VAR</td>
      <td>&lt;class 'sktime.forecasting.var.VAR'&gt;</td>
    </tr>
    <tr>
      <th>44</th>
      <td>VARMAX</td>
      <td>&lt;class 'sktime.forecasting.varmax.VARMAX'&gt;</td>
    </tr>
    <tr>
      <th>45</th>
      <td>VECM</td>
      <td>&lt;class 'sktime.forecasting.vecm.VECM'&gt;</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The entries of the last column of the resulting dataframe are classes which could be directly used for construction, or simply inspected for the correct import path.</p>
<p>For logic that loops over forecasters, the default output format may be more convenient:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster_list</span> <span class="o">=</span> <span class="n">all_estimators</span><span class="p">(</span><span class="s2">&quot;forecaster&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># this returns a list of (name, estimator) tuples</span>
<span class="n">forecaster_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;ARIMA&#39;, sktime.forecasting.arima.ARIMA)
</pre></div>
</div>
</div>
</div>
</section>
<section id="forecaster-tags">
<h3>2.2 Forecaster tags <a class="anchor" id="section_2_2"></a><a class="headerlink" href="#forecaster-tags" title="Link to this heading">#</a></h3>
<p>All forecasters <code class="docutils literal notranslate"><span class="pre">sktime</span></code> have so-called tags which describe properties of the estimator, e.g., whether it is multivariate, probabilistic, or not. Use of tags, inspection, and retrieval will be described in this section.</p>
</section>
<section id="capability-tags-multivariate-probabilistic-hierarchical">
<h3>2.2.1 Capability tags: multivariate, probabilistic, hierarchical <a class="anchor" id="section_2_2_1"></a><a class="headerlink" href="#capability-tags-multivariate-probabilistic-hierarchical" title="Link to this heading">#</a></h3>
<p>Every forecaster has tags, which are key-value pairs that can describe capabilities or internal implementation details.</p>
<p>The most important “capability” style tags are the following:</p>
<p><code class="docutils literal notranslate"><span class="pre">requires-fh-in-fit</span></code> - a boolean. Whether the forecaster requires the forecasting horizon <code class="docutils literal notranslate"><span class="pre">fh</span></code> already in <code class="docutils literal notranslate"><span class="pre">fit</span></code> (<code class="docutils literal notranslate"><span class="pre">True</span></code>), or whether it can be passed late in <code class="docutils literal notranslate"><span class="pre">predict</span></code> (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">scitype:y</span></code> - a string. Whether the forecaster is univariate (<code class="docutils literal notranslate"><span class="pre">&quot;univariate&quot;</span></code>), strictly multivariate (<code class="docutils literal notranslate"><span class="pre">&quot;multivariate&quot;</span></code>), or can deal with any number of variables (<code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">capability:pred_int</span></code> - a boolean. Whether the forecaster can return probabilistic predictions via <code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> etc, see Section 1.5.</p>
<p><code class="docutils literal notranslate"><span class="pre">ignores-exogeneous-X</span></code> - a boolean. Whether the forecaster makes use of exogeneous variables <code class="docutils literal notranslate"><span class="pre">X</span></code> (<code class="docutils literal notranslate"><span class="pre">False</span></code>) or not (<code class="docutils literal notranslate"><span class="pre">True</span></code>). If the forecaster does not use <code class="docutils literal notranslate"><span class="pre">X</span></code>, it can still be passed for interface uniformity, and will be ignored.</p>
<p><code class="docutils literal notranslate"><span class="pre">handles-missing-data</span></code> - a boolean. Whether the forecaster can deal with missing data in the inputs <code class="docutils literal notranslate"><span class="pre">X</span></code> or <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>Tags of a forecaster instance can be inspected via the <code class="docutils literal notranslate"><span class="pre">get_tags</span></code> (lists all tags) and <code class="docutils literal notranslate"><span class="pre">get_tag</span></code> (gets value for one tag) methods.</p>
<p>Tag values may depend on hyper-parameter choices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>

<span class="n">ARIMA</span><span class="p">()</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;scitype:y&#39;: &#39;univariate&#39;,
 &#39;ignores-exogeneous-X&#39;: False,
 &#39;capability:pred_int&#39;: True,
 &#39;handles-missing-data&#39;: True,
 &#39;y_inner_mtype&#39;: &#39;pd.Series&#39;,
 &#39;X_inner_mtype&#39;: &#39;pd.DataFrame&#39;,
 &#39;requires-fh-in-fit&#39;: False,
 &#39;X-y-must-have-same-index&#39;: True,
 &#39;enforce_index_type&#39;: None,
 &#39;fit_is_empty&#39;: False,
 &#39;python_version&#39;: None,
 &#39;python_dependencies&#39;: &#39;pmdarima&#39;}
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">y_inner_mtype</span></code> and <code class="docutils literal notranslate"><span class="pre">X_inner_mtype</span></code> indicate whether the forecaster can deal with panel or hierarchical data natively - if an panel or hierarchical mtype occurs here, it does (see data types tutorial).</p>
<p>An explanation for all tags can be obtained using the <code class="docutils literal notranslate"><span class="pre">all_tags</span></code> utility, see Section 2.2.3.</p>
</section>
<section id="finding-and-listing-forecasters-by-tag">
<h3>2.2.2 Finding and listing forecasters by tag <a class="anchor" id="section_2_2_2"></a><a class="headerlink" href="#finding-and-listing-forecasters-by-tag" title="Link to this heading">#</a></h3>
<p>To list forecasters with their tags, the <code class="docutils literal notranslate"><span class="pre">all_estimators</span></code> utility can be used with its <code class="docutils literal notranslate"><span class="pre">return_tags</span></code> argument.</p>
<p>The resulting data frame can then be used for table queries or sub-setting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;forecaster&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scitype:y&quot;</span><span class="p">,</span> <span class="s2">&quot;requires-fh-in-fit&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>estimator</th>
      <th>scitype:y</th>
      <th>requires-fh-in-fit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ARIMA</td>
      <td>&lt;class 'sktime.forecasting.arima.ARIMA'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AutoARIMA</td>
      <td>&lt;class 'sktime.forecasting.arima.AutoARIMA'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AutoETS</td>
      <td>&lt;class 'sktime.forecasting.ets.AutoETS'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AutoEnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._ensemble.A...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BATS</td>
      <td>&lt;class 'sktime.forecasting.bats.BATS'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>BaggingForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._bagging.Ba...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ColumnEnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._column_ens...</td>
      <td>both</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ConformalIntervals</td>
      <td>&lt;class 'sktime.forecasting.conformal.Conformal...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Croston</td>
      <td>&lt;class 'sktime.forecasting.croston.Croston'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>DirRecTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
      <td>univariate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>10</th>
      <td>DirRecTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
      <td>univariate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>11</th>
      <td>DirectTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
      <td>univariate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>12</th>
      <td>DirectTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
      <td>univariate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>13</th>
      <td>DontUpdate</td>
      <td>&lt;class 'sktime.forecasting.stream._update.Dont...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>14</th>
      <td>DynamicFactor</td>
      <td>&lt;class 'sktime.forecasting.dynamic_factor.Dyna...</td>
      <td>multivariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>EnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._ensemble.E...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ExponentialSmoothing</td>
      <td>&lt;class 'sktime.forecasting.exp_smoothing.Expon...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ForecastX</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.F...</td>
      <td>univariate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>18</th>
      <td>ForecastingGridSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
      <td>both</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ForecastingPipeline</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.F...</td>
      <td>both</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>ForecastingRandomizedSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
      <td>both</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>MultioutputTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Mul...</td>
      <td>univariate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>22</th>
      <td>MultioutputTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Mul...</td>
      <td>univariate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>23</th>
      <td>MultiplexForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._multiplexe...</td>
      <td>both</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>NaiveForecaster</td>
      <td>&lt;class 'sktime.forecasting.naive.NaiveForecast...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>25</th>
      <td>NaiveVariance</td>
      <td>&lt;class 'sktime.forecasting.naive.NaiveVariance'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>OnlineEnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.online_learning._on...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>PolynomialTrendForecaster</td>
      <td>&lt;class 'sktime.forecasting.trend.PolynomialTre...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Prophet</td>
      <td>&lt;class 'sktime.forecasting.fbprophet.Prophet'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>ReconcilerForecaster</td>
      <td>&lt;class 'sktime.forecasting.reconcile.Reconcile...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>RecursiveTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Rec...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31</th>
      <td>RecursiveTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Rec...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>SARIMAX</td>
      <td>&lt;class 'sktime.forecasting.sarimax.SARIMAX'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>33</th>
      <td>STLForecaster</td>
      <td>&lt;class 'sktime.forecasting.trend.STLForecaster'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>34</th>
      <td>StackingForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._stack.Stac...</td>
      <td>univariate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>35</th>
      <td>StatsForecastAutoARIMA</td>
      <td>&lt;class 'sktime.forecasting.statsforecast.Stats...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>36</th>
      <td>TBATS</td>
      <td>&lt;class 'sktime.forecasting.tbats.TBATS'&gt;</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>ThetaForecaster</td>
      <td>&lt;class 'sktime.forecasting.theta.ThetaForecast...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>TransformedTargetForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.T...</td>
      <td>both</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39</th>
      <td>TrendForecaster</td>
      <td>&lt;class 'sktime.forecasting.trend.TrendForecast...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>UnobservedComponents</td>
      <td>&lt;class 'sktime.forecasting.structural.Unobserv...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>UpdateEvery</td>
      <td>&lt;class 'sktime.forecasting.stream._update.Upda...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>UpdateRefitsEvery</td>
      <td>&lt;class 'sktime.forecasting.stream._update.Upda...</td>
      <td>univariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>VAR</td>
      <td>&lt;class 'sktime.forecasting.var.VAR'&gt;</td>
      <td>multivariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>44</th>
      <td>VARMAX</td>
      <td>&lt;class 'sktime.forecasting.varmax.VARMAX'&gt;</td>
      <td>multivariate</td>
      <td>False</td>
    </tr>
    <tr>
      <th>45</th>
      <td>VECM</td>
      <td>&lt;class 'sktime.forecasting.vecm.VECM'&gt;</td>
      <td>multivariate</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To filter beforehand on certain tags and tag values, the <code class="docutils literal notranslate"><span class="pre">filter_tags</span></code> argument can be used:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this lists all forecasters that can deal with multivariate data</span>
<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;forecaster&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;scitype:y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;multivariate&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">]}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>estimator</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ColumnEnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._column_ens...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DynamicFactor</td>
      <td>&lt;class 'sktime.forecasting.dynamic_factor.Dyna...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ForecastingGridSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ForecastingPipeline</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.F...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ForecastingRandomizedSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>MultiplexForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._multiplexe...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TransformedTargetForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.T...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>VAR</td>
      <td>&lt;class 'sktime.forecasting.var.VAR'&gt;</td>
    </tr>
    <tr>
      <th>8</th>
      <td>VARMAX</td>
      <td>&lt;class 'sktime.forecasting.varmax.VARMAX'&gt;</td>
    </tr>
    <tr>
      <th>9</th>
      <td>VECM</td>
      <td>&lt;class 'sktime.forecasting.vecm.VECM'&gt;</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Important note: as said above, tag values can depend on hyper-parameter settings, e.g., a <code class="docutils literal notranslate"><span class="pre">ForecastingPipeline</span></code> can handle multivariate data only if the forecaster in it can handle multivariate data.</p>
<p>In retrieval as above, the tags for a class are usually set to indicate the most general potential value, e.g., if for some parameter choice the estimator can handle multivariate, it will appear on the list.</p>
</section>
<section id="listing-all-forecaster-tags">
<h3>2.2.3 Listing all forecaster tags <a class="anchor" id="section_2_2_3"></a><a class="headerlink" href="#listing-all-forecaster-tags" title="Link to this heading">#</a></h3>
<p>To list all forecaster tags with an explanation of the tag, the <code class="docutils literal notranslate"><span class="pre">all_tags</span></code> utility can be used:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_tags</span>

<span class="c1"># wrapping this in a pandas DataFrame for pretty display</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_tags</span><span class="p">(</span><span class="n">estimator_types</span><span class="o">=</span><span class="s2">&quot;forecaster&quot;</span><span class="p">))[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>X-y-must-have-same-index</td>
      <td>do X/y in fit/update and X/fh in predict have ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>X_inner_mtype</td>
      <td>which machine type(s) is the internal _fit/_pr...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>capability:pred_int</td>
      <td>does the forecaster implement predict_interval...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>capability:pred_var</td>
      <td>does the forecaster implement predict_variance?</td>
    </tr>
    <tr>
      <th>4</th>
      <td>enforce_index_type</td>
      <td>passed to input checks, input conversion index...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ignores-exogeneous-X</td>
      <td>does forecaster ignore exogeneous data (X)?</td>
    </tr>
    <tr>
      <th>6</th>
      <td>requires-fh-in-fit</td>
      <td>does forecaster require fh passed already in f...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>scitype:y</td>
      <td>which series type does the forecaster support?...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>y_inner_mtype</td>
      <td>which machine type(s) is the internal _fit/_pr...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="common-forecasters-in-sktime">
<h3>2.3 Common forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="section_2_3"></a><a class="headerlink" href="#common-forecasters-in-sktime" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> supports a number of commonly used forecasters, many of them interfaced from state-of-art forecasting packages. All forecasters are available under the unified <code class="docutils literal notranslate"><span class="pre">sktime</span></code> interface.</p>
<p>Some classes that are currently stably supported are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ExponentialSmoothing</span></code>, <code class="docutils literal notranslate"><span class="pre">ThetaForecaster</span></code>, and <code class="docutils literal notranslate"><span class="pre">autoETS</span></code> from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and <code class="docutils literal notranslate"><span class="pre">AutoARIMA</span></code> from <code class="docutils literal notranslate"><span class="pre">pmdarima</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AutoARIMA</span></code> from <code class="docutils literal notranslate"><span class="pre">statsforecast</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BATS</span></code> and <code class="docutils literal notranslate"><span class="pre">TBATS</span></code> from <code class="docutils literal notranslate"><span class="pre">tbats</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PolynomialTrend</span></code> for forecasting polynomial trends</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prophet</span></code> which interfaces Facebook <code class="docutils literal notranslate"><span class="pre">prophet</span></code></p></li>
</ul>
<p>This is not the full list, use <code class="docutils literal notranslate"><span class="pre">all_estimators</span></code> as demonstrated in Sections 2.1 and 2.2 for that.</p>
<p>For illustration, all estimators below will be presented on the basic forecasting workflow - though they also support the advanced forecasting and evaluation workflows under the unified <code class="docutils literal notranslate"><span class="pre">sktime</span></code> interface (see Section 1).</p>
<p>For use in the other workflows, simply replace the “forecaster specification block” (”<code class="docutils literal notranslate"><span class="pre">forecaster=</span></code>”) by the forecaster specification block in the examples presented below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports necessary for this chapter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingHorizon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">temporal_train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_series</span>

<span class="c1"># data loading for illustration (see section 1 for explanation)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">ForecastingHorizon</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">is_relative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exponential-smoothing-theta-forecaster-autoets-from-statsmodels">
<h3>2.3.1 Exponential smoothing, theta forecaster, autoETS from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code><a class="anchor" id="section_2_3_1"></a><a class="headerlink" href="#exponential-smoothing-theta-forecaster-autoets-from-statsmodels" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> interfaces a number of statistical forecasting algorithms from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>: exponential smoothing, theta, and auto-ETS.</p>
<p>For example, to use exponential smoothing with an additive trend component and multiplicative seasonality on the airline data set, we can write the following. Note that since this is monthly data, a good choic for seasonal periodicity (sp) is 12 (= hypothesized periodicity of a year).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.exp_smoothing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s2">&quot;additive&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.05114163237371178
</pre></div>
</div>
<img alt="../../../../../_images/e04bcc488ea98fb71213ebef20908a4f6c8b41b0f5b8fd5edacb755d94a1883e.png" src="../../../../../_images/e04bcc488ea98fb71213ebef20908a4f6c8b41b0f5b8fd5edacb755d94a1883e.png" />
</div>
</div>
<p>The exponential smoothing of state space model can also be automated similar
to the <a class="reference external" href="https://www.rdocumentation.org/packages/forecast/versions/8.13/topics/ets">ets</a> function in R. This is implemented in the <code class="docutils literal notranslate"><span class="pre">AutoETS</span></code> forecaster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.ets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoETS</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">AutoETS</span><span class="p">(</span><span class="n">auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.06186318537056982
</pre></div>
</div>
<img alt="../../../../../_images/33b3787d11d5e69d01a66a09278b7881c1871b50a1553199b496db86cb5887b6.png" src="../../../../../_images/33b3787d11d5e69d01a66a09278b7881c1871b50a1553199b496db86cb5887b6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># todo: explain Theta; explain how to get theta-lines</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="arima-and-autoarima">
<h3>2.3.2 ARIMA and autoARIMA<a class="anchor" id="section_2_3_2"></a><a class="headerlink" href="#arima-and-autoarima" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> interfaces <code class="docutils literal notranslate"><span class="pre">pmdarima</span></code> for its ARIMA class models.
For a classical ARIMA model with set parameters, use the <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> forecaster:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span>
    <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.04356744885278522
</pre></div>
</div>
<img alt="../../../../../_images/751f12e3c1c9a39ab7f0c398f1dfba583eda7ed0d7d4fe4bab158463c562b92f.png" src="../../../../../_images/751f12e3c1c9a39ab7f0c398f1dfba583eda7ed0d7d4fe4bab158463c562b92f.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">AutoARIMA</span></code> is an automatically tuned <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> variant that obtains the optimal pdq parameters automatically:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoARIMA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">AutoARIMA</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.041489714388809135
</pre></div>
</div>
<img alt="../../../../../_images/16c8fd9cb7d46bbf46f252cb8c2f9178bea6b1978c9ef15bfc64819d311a87c8.png" src="../../../../../_images/16c8fd9cb7d46bbf46f252cb8c2f9178bea6b1978c9ef15bfc64819d311a87c8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">AutoARIMA</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.040936759322166255
</pre></div>
</div>
<img alt="../../../../../_images/16c8fd9cb7d46bbf46f252cb8c2f9178bea6b1978c9ef15bfc64819d311a87c8.png" src="../../../../../_images/16c8fd9cb7d46bbf46f252cb8c2f9178bea6b1978c9ef15bfc64819d311a87c8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to obtain the fitted parameters, run</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">get_fitted_params</span><span class="p">()</span>
<span class="c1"># should these not include pdq?</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ar.L1&#39;: -0.24111779230017605,
 &#39;sigma2&#39;: 92.74986650446229,
 &#39;order&#39;: (1, 1, 0),
 &#39;seasonal_order&#39;: (0, 1, 0, 12),
 &#39;aic&#39;: 704.0011679023331,
 &#39;aicc&#39;: 704.1316026849419,
 &#39;bic&#39;: 709.1089216855343,
 &#39;hqic&#39;: 706.0650836393346}
</pre></div>
</div>
</div>
</div>
</section>
<section id="bats-and-tbats">
<h3>2.3.3 BATS and TBATS<a class="anchor" id="section_2_3_3"></a><a class="headerlink" href="#bats-and-tbats" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> interfaces BATS and TBATS from the <a class="reference external" href="https://github.com/intive-DataScience/tbats"><code class="docutils literal notranslate"><span class="pre">tbats</span></code></a> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.bats</span><span class="w"> </span><span class="kn">import</span> <span class="n">BATS</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">BATS</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">use_trend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_box_cox</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.08185558959286515
</pre></div>
</div>
<img alt="../../../../../_images/75d5d2a75c434d6893c9787b602f19ce50d5ea684afa1bd7744ea0d2b0d7340d.png" src="../../../../../_images/75d5d2a75c434d6893c9787b602f19ce50d5ea684afa1bd7744ea0d2b0d7340d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.tbats</span><span class="w"> </span><span class="kn">import</span> <span class="n">TBATS</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">TBATS</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">use_trend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_box_cox</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.08024090844021753
</pre></div>
</div>
<img alt="../../../../../_images/b9e0b634ffc79056e90990be59c3923009154b5b024c5169bb9f2b38525c9518.png" src="../../../../../_images/b9e0b634ffc79056e90990be59c3923009154b5b024c5169bb9f2b38525c9518.png" />
</div>
</div>
</section>
<section id="facebook-prophet">
<h3>2.3.4 Facebook prophet<a class="anchor" id="section_2_3_4"></a><a class="headerlink" href="#facebook-prophet" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides an interface to <a class="reference external" href="https://github.com/facebook/prophet"><code class="docutils literal notranslate"><span class="pre">fbprophet</span></code></a> by Facebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.fbprophet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prophet</span>
</pre></div>
</div>
</div>
</div>
<p>The current interface does not support period indices, only pd.DatetimeIndex. Consider improving this by contributing the <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert index to pd.DatetimeIndex</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">)</span>
<span class="n">z_train</span><span class="p">,</span> <span class="n">z_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span>
    <span class="n">seasonality_mode</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span>
    <span class="n">n_changepoints</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">),</span>
    <span class="n">add_country_holidays</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;country_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Germany&quot;</span><span class="p">},</span>
    <span class="n">yearly_seasonality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">weekly_seasonality</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">daily_seasonality</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">z_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">to_relative</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">y_pred</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">index</span>

<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.07276862950407971
</pre></div>
</div>
<img alt="../../../../../_images/1aad8ad36d23afa7632ca134c9ffd1c2599b49ce3a8928f778af6970feebc5e6.png" src="../../../../../_images/1aad8ad36d23afa7632ca134c9ffd1c2599b49ce3a8928f778af6970feebc5e6.png" />
</div>
</div>
</section>
<section id="state-space-model-structural-time-series">
<h3>2.3.5 State Space Model (Structural Time Series)<a class="anchor" id="section_2_3_5"></a><a class="headerlink" href="#state-space-model-structural-time-series" title="Link to this heading">#</a></h3>
<p>We can also use the <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.statespace.structural.UnobservedComponents.html"><code class="docutils literal notranslate"><span class="pre">UnobservedComponents</span></code></a> class from <a class="reference external" href="https://www.statsmodels.org/stable/index.html"><code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></a> to generate predictions using a state space model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.structural</span><span class="w"> </span><span class="kn">import</span> <span class="n">UnobservedComponents</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can model seasonality using Fourier modes as in the Prophet model.</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">UnobservedComponents</span><span class="p">(</span>
    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;local linear trend&quot;</span><span class="p">,</span> <span class="n">freq_seasonal</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;period&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;harmonics&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}]</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0497366365924174
</pre></div>
</div>
<img alt="../../../../../_images/f8555f9d4566384617149254a83e64f933990056aef292f5bd749434b49a1a49.png" src="../../../../../_images/f8555f9d4566384617149254a83e64f933990056aef292f5bd749434b49a1a49.png" />
</div>
</div>
</section>
<section id="autoarima-from-statsforecast">
<h3>2.3.6 AutoARIMA from <a class="reference external" href="https://github.com/Nixtla/statsforecast">StatsForecast</a><a class="anchor" id="section_2_3_6"></a><a class="headerlink" href="#autoarima-from-statsforecast" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> interfaces <code class="docutils literal notranslate"><span class="pre">StatsForecast</span></code> for its <code class="docutils literal notranslate"><span class="pre">AutoARIMA</span></code> class models. <code class="docutils literal notranslate"><span class="pre">AutoARIMA</span></code> is an automatically tuned <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> variant that obtains the optimal pdq parameters automatically:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.statsforecast</span><span class="w"> </span><span class="kn">import</span> <span class="n">StatsForecastAutoARIMA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">StatsForecastAutoARIMA</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.04093539044441262
</pre></div>
</div>
<img alt="../../../../../_images/5aadbdb5d904415c9fb96b93314fc2808dd2c0d48fb0dc8caeb83004b83b8d9e.png" src="../../../../../_images/5aadbdb5d904415c9fb96b93314fc2808dd2c0d48fb0dc8caeb83004b83b8d9e.png" />
</div>
</div>
</section>
</section>
<section id="advanced-composition-patterns-pipelines-reduction-automl-and-more">
<h2>3. Advanced composition patterns - pipelines, reduction, autoML, and more<a class="anchor" id="chapter3"></a><a class="headerlink" href="#advanced-composition-patterns-pipelines-reduction-automl-and-more" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> supports a number of advanced composition patterns to create forecasters out of simpler components:</p>
<ul class="simple">
<li><p>Reduction - building a forecaster from estimators of “simpler” scientific types, like <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> regressors. A common example is feature/label tabulation by rolling window, aka the “direct reduction strategy”.</p></li>
<li><p>Tuning - determining values for hyper-parameters of a forecaster in a data-driven manner. A common example is grid search on temporally rolling re-sampling of train/test splits.</p></li>
<li><p>Pipelining - concatenating transformers with a forecaster to obtain one forecaster. A common example is detrending and deseasonalizing then forecasting, an instance of this is the common “STL forecaster”.</p></li>
<li><p>AutoML, also known as automated model selection - using automated tuning strategies to select not only hyper-parameters but entire forecasting strategies. A common example is on-line multiplexer tuning.</p></li>
</ul>
<p>For illustration, all estimators below will be presented on the basic forecasting workflow - though they also support the advanced forecasting and evaluation workflows under the unified <code class="docutils literal notranslate"><span class="pre">sktime</span></code> interface (see Section 1).</p>
<p>For use in the other workflows, simply replace the “forecaster specification block” (”<code class="docutils literal notranslate"><span class="pre">forecaster=</span></code>”) by the forecaster specification block in the examples presented below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports necessary for this chapter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingHorizon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">temporal_train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_series</span>

<span class="c1"># data loading for illustration (see section 1 for explanation)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">ForecastingHorizon</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">is_relative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="reduction-from-forecasting-to-regression">
<h3>3.1 Reduction: from forecasting to regression<a class="anchor" id="section_3_1"></a><a class="headerlink" href="#reduction-from-forecasting-to-regression" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides a meta-estimator that allows the use of any <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> estimator for forecasting.</p>
<ul class="simple">
<li><p><strong>modular</strong> and <strong>compatible with scikit-learn</strong>, so that we can easily apply any scikit-learn regressor to solve our forecasting problem,</p></li>
<li><p><strong>parametric</strong> and <strong>tuneable</strong>, allowing us to tune hyper-parameters such as the window length or strategy to generate forecasts</p></li>
<li><p><strong>adaptive</strong>, in the sense that it adapts the scikit-learn’s estimator interface to that of a forecaster, making sure that we can tune and properly evaluate our model</p></li>
</ul>
<p><strong>Example</strong>: we will define a tabulation reduction strategy to convert a k-nearest neighbors regressor (<code class="docutils literal notranslate"><span class="pre">sklearn</span></code> <code class="docutils literal notranslate"><span class="pre">KNeighborsRegressor</span></code>) into a forecaster. The composite algorithm is an object compliant with the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> forecaster interface (picture: big robot), and contains the regressor as a parameter accessible component (picture: little robot). In <code class="docutils literal notranslate"><span class="pre">fit</span></code>, the composite algorithm uses a sliding window strategy to tabulate the data, and fit the regressor to the tabulated data (picture: left half). In <code class="docutils literal notranslate"><span class="pre">predict</span></code>, the composite algorithm presents the regressor with the last observed window to obtain predictions (picture: right half).</p>
<img src="img/forecasting-to-regression-reduction.png" width="500"/>
<p>Below, the composite is constructed using the shorthand function <code class="docutils literal notranslate"><span class="pre">make_reduction</span></code> which produces a <code class="docutils literal notranslate"><span class="pre">sktime</span></code> estimator of forecaster scitype. It is called with a constructed <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> regressor, <code class="docutils literal notranslate"><span class="pre">regressor</span></code>, and additional parameter which can be later tuned as hyper-parameters</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_reduction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regressor</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">make_reduction</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;recursive&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.12887507224382988
</pre></div>
</div>
<img alt="../../../../../_images/f4991ec5298a2ec6caffc3379a45da0d8956dff7958f5351afdf1962ac2d332f.png" src="../../../../../_images/f4991ec5298a2ec6caffc3379a45da0d8956dff7958f5351afdf1962ac2d332f.png" />
</div>
</div>
<p>In the above example we use the “recursive” reduction strategy. Other implemented strategies are:</p>
<ul class="simple">
<li><p>“direct”,</p></li>
<li><p>“dirrec”,</p></li>
<li><p>“multioutput”.</p></li>
</ul>
<p>Parameters can be inspected using <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> compatible <code class="docutils literal notranslate"><span class="pre">get_params</span></code> functionality (and set using <code class="docutils literal notranslate"><span class="pre">set_params</span></code>). This provides tunable and nested access to parameters of the <code class="docutils literal notranslate"><span class="pre">KNeighborsRegressor</span></code> (as <code class="docutils literal notranslate"><span class="pre">estimator_etc</span></code>), and the <code class="docutils literal notranslate"><span class="pre">window_length</span></code> of the reduction strategy. Note that the <code class="docutils literal notranslate"><span class="pre">strategy</span></code> is not accessible, as underneath the utility function this is mapped on separate algorithm classes. For tuning over algorithms, see the “autoML” section below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;estimator__algorithm&#39;: &#39;auto&#39;,
 &#39;estimator__leaf_size&#39;: 30,
 &#39;estimator__metric&#39;: &#39;minkowski&#39;,
 &#39;estimator__metric_params&#39;: None,
 &#39;estimator__n_jobs&#39;: None,
 &#39;estimator__n_neighbors&#39;: 1,
 &#39;estimator__p&#39;: 2,
 &#39;estimator__weights&#39;: &#39;uniform&#39;,
 &#39;estimator&#39;: KNeighborsRegressor(n_neighbors=1),
 &#39;transformers&#39;: None,
 &#39;window_length&#39;: 15}
</pre></div>
</div>
</div>
</div>
</section>
<section id="pipelining-detrending-and-deseasonalization">
<h3>3.2 Pipelining, detrending and deseasonalization<a class="anchor" id="section_3_2"></a><a class="headerlink" href="#pipelining-detrending-and-deseasonalization" title="Link to this heading">#</a></h3>
<p>A common composition motif is pipelining: for example, first deseasonalizing or detrending the data, then forecasting the detrended/deseasonalized series. When forecasting, one needs to add the trend and seasonal component back to the data.</p>
<section id="the-basic-forecasting-pipeline">
<h4>3.2.1 The basic forecasting pipeline<a class="anchor" id="section_3_2_1"></a><a class="headerlink" href="#the-basic-forecasting-pipeline" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides a generic pipeline object for this kind of composite modelling, the <code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code>. It chains an arbitrary number of transformations with a forecaster. The transformations can either be pre-processing transformations or a post-processing transformations. An example of a forecaster with pre-processing
transformations can be seen below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformedTargetForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.detrend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Deseasonalizer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">TransformedTargetForecaster</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;deseasonalize&quot;</span><span class="p">,</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;forecast&quot;</span><span class="p">,</span> <span class="n">ARIMA</span><span class="p">()),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13969973496344534
</pre></div>
</div>
<img alt="../../../../../_images/1cd253b9ef0ccd4a1b04d2017862dc2471836be2bed60e37ef501d5d4178b7ec.png" src="../../../../../_images/1cd253b9ef0ccd4a1b04d2017862dc2471836be2bed60e37ef501d5d4178b7ec.png" />
</div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code> is constructed with a list of steps, each a pair of name and estimator, where the last estimator is a forecaster scitype. The pre-processing transformers should be series-to-series transformers which possess both a <code class="docutils literal notranslate"><span class="pre">transform</span></code> and an <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code> method. The resulting estimator is of forecaster scitype and has all interface defining methods. In <code class="docutils literal notranslate"><span class="pre">fit</span></code>, all transformers apply <code class="docutils literal notranslate"><span class="pre">fit_transforms</span></code> to the data, then the forecaster’s <code class="docutils literal notranslate"><span class="pre">fit</span></code>; in <code class="docutils literal notranslate"><span class="pre">predict</span></code>, first the forecaster’s <code class="docutils literal notranslate"><span class="pre">predict</span></code> is applied, then the transformers’ <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code> in reverse order.</p>
<p>The same pipeline, as above, can also be constructed with the multiplication dunder method <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<p>This creates a <code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code> as above, with components given default names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">ARIMA</span><span class="p">()</span>
<span class="n">forecaster</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransformedTargetForecaster(steps=[Deseasonalizer(model=&#39;multiplicative&#39;,
                                                  sp=12),
                                   ARIMA()])
</pre></div>
</div>
</div>
</div>
<p>The names in a dunder constructed pipeline are made unique in case, e.g., two deseasonalizers are used.</p>
<p>Example of a multiple seasonality model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">ARIMA</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;steps&#39;: [Deseasonalizer(model=&#39;multiplicative&#39;, sp=12),
  Deseasonalizer(model=&#39;multiplicative&#39;, sp=3),
  ARIMA()],
 &#39;Deseasonalizer_1&#39;: Deseasonalizer(model=&#39;multiplicative&#39;, sp=12),
 &#39;Deseasonalizer_2&#39;: Deseasonalizer(model=&#39;multiplicative&#39;, sp=3),
 &#39;ARIMA&#39;: ARIMA(),
 &#39;Deseasonalizer_1__model&#39;: &#39;multiplicative&#39;,
 &#39;Deseasonalizer_1__sp&#39;: 12,
 &#39;Deseasonalizer_2__model&#39;: &#39;multiplicative&#39;,
 &#39;Deseasonalizer_2__sp&#39;: 3,
 &#39;ARIMA__concentrate_scale&#39;: False,
 &#39;ARIMA__enforce_invertibility&#39;: True,
 &#39;ARIMA__enforce_stationarity&#39;: True,
 &#39;ARIMA__hamilton_representation&#39;: False,
 &#39;ARIMA__maxiter&#39;: 50,
 &#39;ARIMA__measurement_error&#39;: False,
 &#39;ARIMA__method&#39;: &#39;lbfgs&#39;,
 &#39;ARIMA__mle_regression&#39;: True,
 &#39;ARIMA__order&#39;: (1, 0, 0),
 &#39;ARIMA__out_of_sample_size&#39;: 0,
 &#39;ARIMA__scoring&#39;: &#39;mse&#39;,
 &#39;ARIMA__scoring_args&#39;: None,
 &#39;ARIMA__seasonal_order&#39;: (0, 0, 0, 0),
 &#39;ARIMA__simple_differencing&#39;: False,
 &#39;ARIMA__start_params&#39;: None,
 &#39;ARIMA__suppress_warnings&#39;: False,
 &#39;ARIMA__time_varying_regression&#39;: False,
 &#39;ARIMA__trend&#39;: None,
 &#39;ARIMA__with_intercept&#39;: True}
</pre></div>
</div>
</div>
</div>
<p>We can also create a pipeline with post-processing transformations, these are transformations <em>after</em> the forecaster, in a dunder pipeline or a <code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code>.</p>
<p>Below is an example of a multiple seasonality model, with integer rounding post-processing of the predictions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.func_transform</span><span class="w"> </span><span class="kn">import</span> <span class="n">FunctionTransformer</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">()</span> <span class="o">*</span> <span class="n">FunctionTransformer</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">round</span><span class="p">())</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1958-01    334.0
1958-02    338.0
1958-03    317.0
Freq: M, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Both pre- and post-processing transformers can be present, in this case the post-processing transformations will be applied after the <code class="docutils literal notranslate"><span class="pre">inverse-transform</span></code> of the pre-processing ones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">ARIMA</span><span class="p">()</span>
    <span class="o">*</span> <span class="n">FunctionTransformer</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">round</span><span class="p">())</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1958-01    339.0
1958-02    334.0
1958-03    381.0
Freq: M, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-detrender-as-pipeline-component">
<h4>3.2.2 The <code class="docutils literal notranslate"><span class="pre">Detrender</span></code> as pipeline component<a class="anchor" id="section_3_2_2"></a><a class="headerlink" href="#the-detrender-as-pipeline-component" title="Link to this heading">#</a></h4>
<p>For detrending, we can use the <code class="docutils literal notranslate"><span class="pre">Detrender</span></code>. This is an estimator of series-to-transformer scitype that wraps an arbitrary forecaster. For example, for linear detrending, we can use <code class="docutils literal notranslate"><span class="pre">PolynomialTrendForecaster</span></code> to fit a linear trend, and then subtract/add it using the <code class="docutils literal notranslate"><span class="pre">Detrender</span></code> transformer inside <code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code>.</p>
<p>To understand better what happens, we first examine the detrender separately:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.trend</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialTrendForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.detrend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Detrender</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># linear detrending</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">PolynomialTrendForecaster</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">Detrender</span><span class="p">(</span><span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">)</span>
<span class="n">yt</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>

<span class="c1"># internally, the Detrender uses the in-sample predictions</span>
<span class="c1"># of the PolynomialTrendForecaster</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">PolynomialTrendForecaster</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fh_ins</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span>  <span class="c1"># in-sample forecasting horizon</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="o">=</span><span class="n">fh_ins</span><span class="p">)</span>

<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;fitted linear trend&quot;</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../_images/56bcff71063f16d7d39c7028510c1e278a0daa3d5e8cbfd2dbdecd478d57ff19.png" src="../../../../../_images/56bcff71063f16d7d39c7028510c1e278a0daa3d5e8cbfd2dbdecd478d57ff19.png" />
</div>
</div>
<p>Since the <code class="docutils literal notranslate"><span class="pre">Detrender</span></code> is of scitype series-to-series-transformer, it can be used in the <code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code> for detrending any forecaster:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">TransformedTargetForecaster</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;deseasonalize&quot;</span><span class="p">,</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;detrend&quot;</span><span class="p">,</span> <span class="n">Detrender</span><span class="p">(</span><span class="n">forecaster</span><span class="o">=</span><span class="n">PolynomialTrendForecaster</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">))),</span>
        <span class="p">(</span><span class="s2">&quot;forecast&quot;</span><span class="p">,</span> <span class="n">ARIMA</span><span class="p">()),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.05610168219854761
</pre></div>
</div>
<img alt="../../../../../_images/1409a57197c90b789705ec62033a063934835c1f7aff5820ad8925d233798df4.png" src="../../../../../_images/1409a57197c90b789705ec62033a063934835c1f7aff5820ad8925d233798df4.png" />
</div>
</div>
</section>
<section id="complex-pipeline-composites-and-parameter-inspection">
<h4>3.2.3 Complex pipeline composites and parameter inspection<a class="anchor" id="section_3_2_3"></a><a class="headerlink" href="#complex-pipeline-composites-and-parameter-inspection" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> follows the <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> philosophy of composability and nested parameter inspection. As long as an estimator has the right scitype, it can be used as part of any composition principle requiring that scitype. Above, we have already seen the example of a forecaster inside a <code class="docutils literal notranslate"><span class="pre">Detrender</span></code>, which is an estimator of scitype series-to-series-transformer, with one component of forecaster scitype. Similarly, in a <code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code>, we can use the reduction composite from Section 3.1 as the last forecaster element in the pipeline, which inside has an estimator of tabular regressor scitype, the <code class="docutils literal notranslate"><span class="pre">KNeighborsRegressor</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_reduction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">TransformedTargetForecaster</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;deseasonalize&quot;</span><span class="p">,</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;detrend&quot;</span><span class="p">,</span> <span class="n">Detrender</span><span class="p">(</span><span class="n">forecaster</span><span class="o">=</span><span class="n">PolynomialTrendForecaster</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">))),</span>
        <span class="p">(</span>
            <span class="s2">&quot;forecast&quot;</span><span class="p">,</span>
            <span class="n">make_reduction</span><span class="p">(</span>
                <span class="n">KNeighborsRegressor</span><span class="p">(),</span>
                <span class="n">window_length</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.058708387889316475
</pre></div>
</div>
<img alt="../../../../../_images/993cef364d274c480d46bd2e0601d262d5d47e2274b7a74e0b9c62b3d9661f68.png" src="../../../../../_images/993cef364d274c480d46bd2e0601d262d5d47e2274b7a74e0b9c62b3d9661f68.png" />
</div>
</div>
<p>As with <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> models, we can inspect and access parameters  of any component via <code class="docutils literal notranslate"><span class="pre">get_params</span></code> and <code class="docutils literal notranslate"><span class="pre">set_params</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;steps&#39;: [(&#39;deseasonalize&#39;, Deseasonalizer(model=&#39;multiplicative&#39;, sp=12)),
  (&#39;detrend&#39;, Detrender(forecaster=PolynomialTrendForecaster())),
  (&#39;forecast&#39;,
   RecursiveTabularRegressionForecaster(estimator=KNeighborsRegressor(),
                                        window_length=15))],
 &#39;deseasonalize&#39;: Deseasonalizer(model=&#39;multiplicative&#39;, sp=12),
 &#39;detrend&#39;: Detrender(forecaster=PolynomialTrendForecaster()),
 &#39;forecast&#39;: RecursiveTabularRegressionForecaster(estimator=KNeighborsRegressor(),
                                      window_length=15),
 &#39;deseasonalize__model&#39;: &#39;multiplicative&#39;,
 &#39;deseasonalize__sp&#39;: 12,
 &#39;detrend__forecaster__degree&#39;: 1,
 &#39;detrend__forecaster__regressor&#39;: None,
 &#39;detrend__forecaster__with_intercept&#39;: True,
 &#39;detrend__forecaster&#39;: PolynomialTrendForecaster(),
 &#39;forecast__estimator__algorithm&#39;: &#39;auto&#39;,
 &#39;forecast__estimator__leaf_size&#39;: 30,
 &#39;forecast__estimator__metric&#39;: &#39;minkowski&#39;,
 &#39;forecast__estimator__metric_params&#39;: None,
 &#39;forecast__estimator__n_jobs&#39;: None,
 &#39;forecast__estimator__n_neighbors&#39;: 5,
 &#39;forecast__estimator__p&#39;: 2,
 &#39;forecast__estimator__weights&#39;: &#39;uniform&#39;,
 &#39;forecast__estimator&#39;: KNeighborsRegressor(),
 &#39;forecast__transformers&#39;: None,
 &#39;forecast__window_length&#39;: 15}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="parameter-tuning">
<h3>3.3 Parameter tuning<a class="anchor" id="section_3_3"></a><a class="headerlink" href="#parameter-tuning" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides parameter tuning strategies as compositors of forecaster scitype, similar to <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>’s <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code>.</p>
</section>
<section id="basic-tuning-using-forecastinggridsearchcv">
<h3>3.3.1 Basic tuning using <code class="docutils literal notranslate"><span class="pre">ForecastingGridSearchCV</span></code><a class="anchor" id="section_3_3_1"></a><a class="headerlink" href="#basic-tuning-using-forecastinggridsearchcv" title="Link to this heading">#</a></h3>
<p>The compositor <code class="docutils literal notranslate"><span class="pre">ForecastingGridSearchCV</span></code> (and other tuners) are constructed with a forecaster to tune, a cross-validation constructor, a <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> parameter grid, and parameters specific to the tuning strategy. Cross-validation constructors follow the <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> interface for re-samplers, and can be slotted in exchangeably.</p>
<p>As an example, we show tuning of the window length in the reduction compositor from Section 3.1, using temporal sliding window tuning:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_reduction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingGridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlidingWindowSplitter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regressor</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">make_reduction</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;recursive&quot;</span><span class="p">)</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;window_length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]}</span>

<span class="c1"># We fit the forecaster on an initial window which is 80% of the historical data</span>
<span class="c1"># then use temporal sliding window cross-validation to find the optimal hyper-parameters</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">SlidingWindowSplitter</span><span class="p">(</span><span class="n">initial_window</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">gscv</span> <span class="o">=</span> <span class="n">ForecastingGridSearchCV</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;refit&quot;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As with other composites, the resulting forecaster provides the unified interface of <code class="docutils literal notranslate"><span class="pre">sktime</span></code> forecasters - window splitting, tuning, etc requires no manual effort and is done behind the unified interface:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gscv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.16607972017556033
</pre></div>
</div>
<img alt="../../../../../_images/d0a6bde742834032a83d83669a1c60a22725f98c6911f8d54dcbc73fb4a8f300.png" src="../../../../../_images/d0a6bde742834032a83d83669a1c60a22725f98c6911f8d54dcbc73fb4a8f300.png" />
</div>
</div>
<p>Tuned parameters can be accessed in the <code class="docutils literal notranslate"><span class="pre">best_params_</span></code> attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;window_length&#39;: 7}
</pre></div>
</div>
</div>
</div>
<p>An instance of the best forecaster, with hyper-parameters set, can be retrieved by accessing the <code class="docutils literal notranslate"><span class="pre">best_forecaster_</span></code> attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">best_forecaster_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RecursiveTabularRegressionForecaster(estimator=KNeighborsRegressor(),
                                     window_length=7)
</pre></div>
</div>
</div>
</div>
</section>
<section id="tuning-of-complex-composites">
<h3>3.3.2 Tuning of complex composites<a class="anchor" id="section_3_3_2"></a><a class="headerlink" href="#tuning-of-complex-composites" title="Link to this heading">#</a></h3>
<p>As in <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>, parameters of nested components can be tuned by accessing their <code class="docutils literal notranslate"><span class="pre">get_params</span></code> key - by default this is <code class="docutils literal notranslate"><span class="pre">[estimatorname]__[parametername]</span></code> if <code class="docutils literal notranslate"><span class="pre">[estimatorname]</span></code> is the name of the component, and <code class="docutils literal notranslate"><span class="pre">[parametername]</span></code> the name of a parameter within the estimator <code class="docutils literal notranslate"><span class="pre">[estimatorname]</span></code>.</p>
<p>For example, below we tune the <code class="docutils literal notranslate"><span class="pre">KNeighborsRegressor</span></code> component’s <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code>, in addition to tuning <code class="docutils literal notranslate"><span class="pre">window_length</span></code>. The tuneable parameters can easily be queried using <code class="docutils literal notranslate"><span class="pre">forecaster.get_params()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_reduction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingGridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlidingWindowSplitter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;window_length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="s2">&quot;estimator__n_neighbors&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)}</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">make_reduction</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;recursive&quot;</span><span class="p">)</span>

<span class="n">cv</span> <span class="o">=</span> <span class="n">SlidingWindowSplitter</span><span class="p">(</span><span class="n">initial_window</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">gscv</span> <span class="o">=</span> <span class="n">ForecastingGridSearchCV</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gscv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13988948769413537
</pre></div>
</div>
<img alt="../../../../../_images/ca6263598af8e42b32d8881c16a607e305f0db795aab0005ea1a89a4002adb74.png" src="../../../../../_images/ca6263598af8e42b32d8881c16a607e305f0db795aab0005ea1a89a4002adb74.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;estimator__n_neighbors&#39;: 2, &#39;window_length&#39;: 12}
</pre></div>
</div>
</div>
</div>
<p>An alternative to the above is tuning the regressor separately, using <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>’s <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> and a separate parameter grid. As this does not use the “overall” performance metric to tune the inner regressor, performance of the composite forecaster may vary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="c1"># tuning the &#39;n_estimator&#39; hyperparameter of RandomForestRegressor from scikit-learn</span>
<span class="n">regressor_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_neighbors&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)}</span>
<span class="n">forecaster_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;window_length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]}</span>

<span class="c1"># create a tunnable regressor with GridSearchCV</span>
<span class="n">regressor</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">KNeighborsRegressor</span><span class="p">(),</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">regressor_param_grid</span><span class="p">)</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">make_reduction</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;recursive&quot;</span><span class="p">)</span>

<span class="n">cv</span> <span class="o">=</span> <span class="n">SlidingWindowSplitter</span><span class="p">(</span><span class="n">initial_window</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">gscv</span> <span class="o">=</span> <span class="n">ForecastingGridSearchCV</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">forecaster_param_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gscv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.14493362646957736
</pre></div>
</div>
<img alt="../../../../../_images/84eda5fad48a3580931063552ba9b0a37e3cc641bd97abe6fef398dd25e92593.png" src="../../../../../_images/84eda5fad48a3580931063552ba9b0a37e3cc641bd97abe6fef398dd25e92593.png" />
</div>
</div>
<p>NOTE: a smart implementation of this would use caching to save partial results from the inner tuning and reduce runtime substantially - currently <code class="docutils literal notranslate"><span class="pre">sktime</span></code> does not support this. Consider helping to improve <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p>
</section>
<section id="selecting-the-metric-and-retrieving-scores">
<h3>3.3.3 Selecting the metric and retrieving scores<a class="anchor" id="section_3_3_3"></a><a class="headerlink" href="#selecting-the-metric-and-retrieving-scores" title="Link to this heading">#</a></h3>
<p>All tuning algorithms in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> allow the user to set a score; for forecasting the default is mean absolute percentage error. The score can be set using the <code class="docutils literal notranslate"><span class="pre">score</span></code> argument, to any scorer function or class, as in Section 1.3.</p>
<p>Re-sampling tuners retain performances on individual forecast re-sample folds, which can be retrieved from the <code class="docutils literal notranslate"><span class="pre">cv_results_</span></code> argument after the forecaster has been fit via a call to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
<p>In the above example, using the mean squared error instead of the mean absolute percentage error for tuning would be done by defining the forecaster as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting</span><span class="w"> </span><span class="kn">import</span> <span class="n">MeanSquaredError</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mse</span> <span class="o">=</span> <span class="n">MeanSquaredError</span><span class="p">()</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;window_length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]}</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">SlidingWindowSplitter</span><span class="p">(</span><span class="n">initial_window</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">gscv</span> <span class="o">=</span> <span class="n">ForecastingGridSearchCV</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The performances on individual folds can be accessed as follows, after fitting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">gscv</span><span class="o">.</span><span class="n">cv_results_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_test_MeanSquaredError</th>
      <th>mean_fit_time</th>
      <th>mean_pred_time</th>
      <th>params</th>
      <th>rank_test_MeanSquaredError</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2600.750255</td>
      <td>0.051403</td>
      <td>0.002837</td>
      <td>{'window_length': 7}</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1134.999053</td>
      <td>0.051353</td>
      <td>0.002975</td>
      <td>{'window_length': 12}</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1285.133614</td>
      <td>0.050748</td>
      <td>0.003272</td>
      <td>{'window_length': 15}</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="automl-aka-automated-model-selection-ensembling-and-hedging">
<h3>3.4 autoML  aka automated model selection, ensembling and hedging<a class="anchor" id="section_3_4"></a><a class="headerlink" href="#automl-aka-automated-model-selection-ensembling-and-hedging" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> provides a number of compositors for ensembling and automated model selection. In contrast to tuning, which uses data-driven strategies to find optimal hyper-parameters for a fixed forecaster, the strategies in this section combine or select on the level of estimators, using a collection of forecasters to combine or select from.</p>
<p>The strategies discussed in this section are:</p>
<ul class="simple">
<li><p>autoML aka automated model selection</p></li>
<li><p>simple ensembling</p></li>
<li><p>prediction weighted ensembles with weight updates, and hedging strategies</p></li>
</ul>
</section>
<section id="automl-aka-automatic-model-selection-using-tuning-plus-multiplexer">
<h3>3.4.1 autoML aka automatic model selection, using tuning plus multiplexer<a class="anchor" id="section_3_4_1"></a><a class="headerlink" href="#automl-aka-automatic-model-selection-using-tuning-plus-multiplexer" title="Link to this heading">#</a></h3>
<p>The most flexible way to perform model selection over forecasters is by using the <code class="docutils literal notranslate"><span class="pre">MultiplexForecaster</span></code>, which exposes the choice of a forecaster from a list as a hyper-parameter that is tunable by generic hyper-parameter tuning strategies such as in Section 3.3.</p>
<p>In isolation, <code class="docutils literal notranslate"><span class="pre">MultiplexForecaster</span></code> is constructed with a named list <code class="docutils literal notranslate"><span class="pre">forecasters</span></code>, of forecasters. It has a single hyper-parameter, <code class="docutils literal notranslate"><span class="pre">selected_forecaster</span></code>, which can be set to the name of any forecaster in <code class="docutils literal notranslate"><span class="pre">forecasters</span></code>, and behaves exactly like the forecaster keyed in <code class="docutils literal notranslate"><span class="pre">forecasters</span></code> by <code class="docutils literal notranslate"><span class="pre">selected_forecaster</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiplexForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.exp_smoothing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">MultiplexForecaster</span><span class="p">(</span>
    <span class="n">forecasters</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;naive&quot;</span><span class="p">,</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;ets&quot;</span><span class="p">,</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;selected_forecaster&quot;</span><span class="p">:</span> <span class="s2">&quot;naive&quot;</span><span class="p">})</span>
<span class="c1"># now forecaster behaves like NaiveForecaster(strategy=&quot;last&quot;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiplexForecaster(forecasters=[(&#39;naive&#39;, NaiveForecaster()),
                                 (&#39;ets&#39;,
                                  ExponentialSmoothing(sp=12, trend=&#39;add&#39;))],
                    selected_forecaster=&#39;naive&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;selected_forecaster&quot;</span><span class="p">:</span> <span class="s2">&quot;ets&quot;</span><span class="p">})</span>
<span class="c1"># now forecaster behaves like ExponentialSmoothing(trend=&quot;add&quot;, sp=12))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiplexForecaster(forecasters=[(&#39;naive&#39;, NaiveForecaster()),
                                 (&#39;ets&#39;,
                                  ExponentialSmoothing(sp=12, trend=&#39;add&#39;))],
                    selected_forecaster=&#39;ets&#39;)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MultiplexForecaster</span></code> is not too useful in isolation, but allows for flexible autoML when combined with a tuning wrapper. The below defines a forecaster that selects one of <code class="docutils literal notranslate"><span class="pre">NaiveForecaster</span></code> and <code class="docutils literal notranslate"><span class="pre">ExponentialSmoothing</span></code> by sliding window tuning as in Section 3.3.</p>
<p>Combined with rolling use of the forecaster via the <code class="docutils literal notranslate"><span class="pre">update</span></code> functionality (see Section 1.4), the tuned multiplexer can switch back and forth between <code class="docutils literal notranslate"><span class="pre">NaiveForecaster</span></code> and <code class="docutils literal notranslate"><span class="pre">ExponentialSmoothing</span></code>, depending on performance, as time progresses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingGridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlidingWindowSplitter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">MultiplexForecaster</span><span class="p">(</span>
    <span class="n">forecasters</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;naive&quot;</span><span class="p">,</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;ets&quot;</span><span class="p">,</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">SlidingWindowSplitter</span><span class="p">(</span><span class="n">initial_window</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">forecaster_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;selected_forecaster&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ets&quot;</span><span class="p">,</span> <span class="s2">&quot;naive&quot;</span><span class="p">]}</span>
<span class="n">gscv</span> <span class="o">=</span> <span class="n">ForecastingGridSearchCV</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">forecaster_param_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gscv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.19886711926999853
</pre></div>
</div>
<img alt="../../../../../_images/cdba939a3b33b6fb46ac0bd68b52ff1c17afb5730b968164b15950ccf081ee05.png" src="../../../../../_images/cdba939a3b33b6fb46ac0bd68b52ff1c17afb5730b968164b15950ccf081ee05.png" />
</div>
</div>
<p>As with any tuned forecaster, best parameters and an instance of the tuned forecaster can be retrieved using <code class="docutils literal notranslate"><span class="pre">best_params_</span></code> and <code class="docutils literal notranslate"><span class="pre">best_forecaster_</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;selected_forecaster&#39;: &#39;naive&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">best_forecaster_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiplexForecaster(forecasters=[(&#39;naive&#39;, NaiveForecaster()),
                                 (&#39;ets&#39;,
                                  ExponentialSmoothing(sp=12, trend=&#39;add&#39;))],
                    selected_forecaster=&#39;naive&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="automl-selecting-transformer-combinations-via-optimalpassthrough">
<h3>3.4.2 autoML: selecting transformer combinations via <code class="docutils literal notranslate"><span class="pre">OptimalPassthrough</span></code><a class="anchor" id="section_3_4_2"></a><a class="headerlink" href="#automl-selecting-transformer-combinations-via-optimalpassthrough" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> also provides capabilities for automated selection of pipeline components <em>inside</em> a pipeline, i.e., pipeline structure. This is achieved with the <code class="docutils literal notranslate"><span class="pre">OptionalPassthrough</span></code> transformer.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">OptionalPassthrough</span></code> transformer allows to tune whether a transformer inside a pipeline is applied to the data or not. For example, if we want to tune whether <code class="docutils literal notranslate"><span class="pre">sklearn.StandardScaler</span></code> is bringing an advantage to the forecast or not, we wrap it in <code class="docutils literal notranslate"><span class="pre">OptionalPassthrough</span></code>. Internally, <code class="docutils literal notranslate"><span class="pre">OptionalPassthrough</span></code> has a hyperparameter <code class="docutils literal notranslate"><span class="pre">passthrough:</span> <span class="pre">bool</span></code> that is tuneable; when <code class="docutils literal notranslate"><span class="pre">False</span></code> the composite behaves like the wrapped transformer, when <code class="docutils literal notranslate"><span class="pre">True</span></code>, it ignores the transformer within.</p>
<p>To make effective use of <code class="docutils literal notranslate"><span class="pre">OptionalPasstrhough</span></code>, define a suitable parameter set using the <code class="docutils literal notranslate"><span class="pre">__</span></code> (double underscore) notation familiar from <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>. This allows to access and tune attributes of nested objects like TabularToSeriesAdaptor(StandardScaler()). We can use <code class="docutils literal notranslate"><span class="pre">__</span></code> multiple times if we have more than two levels of nesting.</p>
<p>In the following example, we take a deseasonalize/scale pipeline and tune over the four possible combinations of deseasonalizer and scaler being included in the pipeline yes/no (2 times 2 = 4); as well as over the forecaster’s and the scaler’s parameters.</p>
<p>Note: this could be arbitrarily combined with <code class="docutils literal notranslate"><span class="pre">MultiplexForecaster</span></code>, as in Section 3.4.1, to select over pipeline architecture as well as over pipeline structure.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> and <code class="docutils literal notranslate"><span class="pre">sktime</span></code> do not support conditional parameter sets at current (unlike, e.g., the <code class="docutils literal notranslate"><span class="pre">mlr3</span></code> package). This means that the grid search will optimize over the <code class="docutils literal notranslate"><span class="pre">scaler</span></code>’s parameters even when it is skipped. Designing/implementing this capability would be an interesting area for contributions or research.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformedTargetForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingGridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlidingWindowSplitter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">OptionalPassthrough</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.adapt</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularToSeriesAdaptor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.detrend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Deseasonalizer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create pipeline</span>
<span class="n">pipe</span> <span class="o">=</span> <span class="n">TransformedTargetForecaster</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;deseasonalizer&quot;</span><span class="p">,</span> <span class="n">OptionalPassthrough</span><span class="p">(</span><span class="n">Deseasonalizer</span><span class="p">())),</span>
        <span class="p">(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">OptionalPassthrough</span><span class="p">(</span><span class="n">TabularToSeriesAdaptor</span><span class="p">(</span><span class="n">StandardScaler</span><span class="p">()))),</span>
        <span class="p">(</span><span class="s2">&quot;forecaster&quot;</span><span class="p">,</span> <span class="n">NaiveForecaster</span><span class="p">()),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># putting it all together in a grid search</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">SlidingWindowSplitter</span><span class="p">(</span>
    <span class="n">initial_window</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">start_with_window</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">step_length</span><span class="o">=</span><span class="mi">24</span>
<span class="p">)</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;deseasonalizer__passthrough&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
    <span class="s2">&quot;scaler__transformer__transformer__with_mean&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
    <span class="s2">&quot;scaler__passthrough&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
    <span class="s2">&quot;forecaster__strategy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;drift&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">gscv</span> <span class="o">=</span> <span class="n">ForecastingGridSearchCV</span><span class="p">(</span><span class="n">forecaster</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gscv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1299046419013891
</pre></div>
</div>
<img alt="../../../../../_images/5bc07b888ae00b9358e1e0d3bd089a82c7f1ab7806a4c4bc1fb86761df73bd60.png" src="../../../../../_images/5bc07b888ae00b9358e1e0d3bd089a82c7f1ab7806a4c4bc1fb86761df73bd60.png" />
</div>
</div>
</section>
<section id="simple-ensembling-strategies">
<h3>3.4.3 Simple ensembling strategies<a class="anchor" id="section_3_4_3"></a><a class="headerlink" href="#simple-ensembling-strategies" title="Link to this heading">#</a></h3>
<p>TODO - contributions in this section are appreciated</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">EnsembleForecaster</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ses</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">holt</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">damped_trend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">damped</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">damped_trend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">EnsembleForecaster</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;ses&quot;</span><span class="p">,</span> <span class="n">ses</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;holt&quot;</span><span class="p">,</span> <span class="n">holt</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;damped&quot;</span><span class="p">,</span> <span class="n">damped</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.16617968035655875
</pre></div>
</div>
<img alt="../../../../../_images/316005423db76301785f84573248eb5c461ccb1ee1a99fd7b07c9485e8fdd475.png" src="../../../../../_images/316005423db76301785f84573248eb5c461ccb1ee1a99fd7b07c9485e8fdd475.png" />
</div>
</div>
</section>
<section id="prediction-weighted-ensembles-and-hedge-ensembles">
<h3>3.4.4 Prediction weighted ensembles and hedge ensembles<a class="anchor" id="section_3_4_4"></a><a class="headerlink" href="#prediction-weighted-ensembles-and-hedge-ensembles" title="Link to this heading">#</a></h3>
<p>For model evaluation, we sometimes want to evaluate multiple forecasts, using temporal cross-validation with a sliding window over the test data. For this purpose, we can leverage the forecasters from the <code class="docutils literal notranslate"><span class="pre">online_forecasting</span></code> module which use a composite forecaster, <code class="docutils literal notranslate"><span class="pre">PredictionWeightedEnsemble</span></code>, to keep track of the loss accumulated by each forecaster and create a prediction weighted by the predictions of the most “accurate” forecasters.</p>
<p>Note that the forecasting task is changed: we make 35 predictions since we need the first prediction to help update the weights, we do not predict 36 steps ahead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.all</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.online_learning</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">NormalHedgeEnsemble</span><span class="p">,</span>
    <span class="n">OnlineEnsembleForecaster</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>First we need to initialize a <code class="docutils literal notranslate"><span class="pre">PredictionWeightedEnsembler</span></code> that will keep track of the loss accumulated by each forecaster and define which loss function we would like to use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hedge_expert</span> <span class="o">=</span> <span class="n">NormalHedgeEnsemble</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">mean_squared_error</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can then create the forecaster by defining the individual forecasters and specifying the <code class="docutils literal notranslate"><span class="pre">PredictionWeightedEnsembler</span></code> we are using. Then by fitting our forecasters and performing updates and prediction with the <code class="docutils literal notranslate"><span class="pre">update_predict</span></code> function, we get:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">OnlineEnsembleForecaster</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;ses&quot;</span><span class="p">,</span> <span class="n">ses</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;holt&quot;</span><span class="p">,</span> <span class="n">holt</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;damped&quot;</span><span class="p">,</span> <span class="n">damped</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">ensemble_algorithm</span><span class="o">=</span><span class="n">hedge_expert</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">update_predict_single</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">])</span>
<span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0978975689038194
</pre></div>
</div>
<img alt="../../../../../_images/a54cb2754528dbc31b71c504838085a32bb0e6b6705e8fac5a68e57bb06c178b.png" src="../../../../../_images/a54cb2754528dbc31b71c504838085a32bb0e6b6705e8fac5a68e57bb06c178b.png" />
</div>
</div>
</section>
</section>
<section id="extension-guide-implementing-your-own-forecaster">
<h2>4. Extension guide - implementing your own forecaster<a class="anchor" id="chapter4"></a><a class="headerlink" href="#extension-guide-implementing-your-own-forecaster" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> is meant to be easily extensible, for direct contribution to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> as well as for local/private extension with custom methods.</p>
<p>To get started:</p>
<ul class="simple">
<li><p>Follow the <a class="reference external" href="https://www.sktime.net/en/stable/developer_guide/add_estimators.html">“implementing estimator” developer guide</a></p></li>
<li><p>Use the <a class="reference external" href="https://github.com/sktime/sktime/blob/main/extension_templates/forecasting_simple.py">simple forecasting extension template</a> for forecasters without stream, probabilistic, or hierarchical functionality</p></li>
<li><p>Use the <a class="reference external" href="https://github.com/sktime/sktime/blob/main/extension_templates/forecasting.py">advanced forecasting extension template</a> for forecasters with stream, probabilistic or hierarchical functionality</p></li>
<li><p>For probabilistic and hierarchical forecasters, it is recommended to familiarize yourself with the interfaces via the tutorials</p></li>
</ul>
<ol class="arabic simple">
<li><p>Read through the <a class="reference external" href="https://github.com/sktime/sktime/blob/main/extension_templates/forecasting.py">forecasting extension template</a> - this is a <code class="docutils literal notranslate"><span class="pre">python</span></code> file with <code class="docutils literal notranslate"><span class="pre">todo</span></code> blocks that mark the places in which changes need to be added.</p></li>
<li><p>Optionally, if you are planning any major surgeries to the interface: look at the <a class="reference external" href="https://github.com/sktime/sktime/blob/main/sktime/forecasting/base/_base.py">base class architecture</a> - note that “ordinary” extension (e.g., new algorithm) should be easily doable without this.</p></li>
<li><p>Copy the forecasting extension template to a local folder in your own repository (local/private extension), or to a suitable location in your clone of the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> or affiliated repository (if contributed extension), inside <code class="docutils literal notranslate"><span class="pre">sktime.forecasting</span></code>; rename the file and update the file docstring appropriately.</p></li>
<li><p>Address the “todo” parts. Usually, this means: changing the name of the class, setting the tag values, specifying hyper-parameters, filling in <code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">_fit</span></code>, <code class="docutils literal notranslate"><span class="pre">_predict</span></code>, and optional methods such as <code class="docutils literal notranslate"><span class="pre">_update</span></code> (for details see the extension template). You can add private methods as long as they do not override the default public interface. For more details, see the extension template.</p></li>
<li><p>To test your estimator manually: import your estimator and run it in the workflows in Section 1; then use it in the compositors in Section 3.</p></li>
<li><p>To test your estimator automatically: call <code class="docutils literal notranslate"><span class="pre">sktime.utils.estimator_checks.check_estimator</span></code> on your estimator. You can call this on a class or object instance. Ensure you have specified test parameters in the <code class="docutils literal notranslate"><span class="pre">get_test_params</span></code> method, according to the extension template.</p></li>
</ol>
<p>In case of direct contribution to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> or one of its affiliated packages, additionally:</p>
<ul class="simple">
<li><p>Add yourself as an author to the code, and to the <code class="docutils literal notranslate"><span class="pre">CODEOWNERS</span></code> for the new estimator file(s).</p></li>
<li><p>Create a pull request that contains only the new estimators (and their inheritance tree, if it’s not just one class), as well as the automated tests as described above.</p></li>
<li><p>In the pull request, describe the estimator and optimally provide a publication or other technical reference for the strategy it implements.</p></li>
<li><p>Before making the pull request, ensure that you have all necessary permissions to contribute the code to a permissive license (BSD-3) open source project.</p></li>
</ul>
</section>
<section id="summary">
<h2>5. Summary<a class="anchor" id="chapter5"></a><a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> comes with several forecasting algorithms (or forecasters), all of which share a common interface. The interface is fully interoperable with the <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> interface, and provides dedicated interface points for forecasting in batch and rolling mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> comes with rich composition functionality that allows to build complex pipelines easily, and connect easily with other parts of the open source ecosystem, such as <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> and individual algorithm libraries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> is easy to extend, and comes with user friendly tools to facilitate implementing and testing your own forecasters and composition principles.</p></li>
</ul>
</section>
<section id="useful-resources">
<h2>Useful resources<a class="headerlink" href="#useful-resources" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>For more details, take a look at <a class="reference external" href="https://arxiv.org/abs/2005.08067">our paper on forecasting with sktime</a> in which we discuss the forecasting API in more detail and use it to replicate and extend the M4 study.</p></li>
<li><p>For a good introduction to forecasting, see <a class="reference external" href="https://otexts.com/fpp2/">Hyndman, Rob J., and George Athanasopoulos. Forecasting: principles and practice. OTexts, 2018</a>.</p></li>
<li><p>For comparative benchmarking studies/forecasting competitions, see the <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0169207019301128">M4 competition</a> and the <a class="reference external" href="https://www.kaggle.com/c/m5-forecasting-accuracy/overview">M5 competition</a>.</p></li>
</ul>
<hr class="docutils" />
<section id="credits">
<h3>Credits:<a class="headerlink" href="#credits" title="Link to this heading">#</a></h3>
<p>sktime: <a class="github reference external" href="https://github.com/sktime/sktime/blob/main/CONTRIBUTORS.md">sktime/sktime</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./.venv/lib/python3.11/site-packages/examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">Package imports</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-forecasting-workflows">1. Basic forecasting workflows <a class="anchor" id="chapter1"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-container-format">1.1 Data container format<a class="anchor" id="section_1_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-deployment-workflow-batch-fitting-and-forecasting">1.2 Basic deployment workflow - batch fitting and forecasting<a class="anchor" id="section_1_2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-preparation-of-the-data">Step 1 - Preparation of the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-specifying-the-forecasting-horizon">Step 2 - Specifying the forecasting horizon</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-numpy-forecasting-horizon">Using a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> forecasting horizon</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-forecastinghorizon-based-forecasting-horizon">Using a <code class="docutils literal notranslate"><span class="pre">ForecastingHorizon</span></code> based forecasting horizon</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-specifying-the-forecasting-algorithm">Step 3 - Specifying the forecasting algorithm</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-fitting-the-forecaster-to-the-seen-data">Step 4 - Fitting the forecaster to the seen data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-requesting-forecasts">Step 5 - Requesting forecasts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-deployment-workflow-in-a-nutshell">1.2.1 The basic deployment workflow in a nutshell<a class="anchor" id="section_1_2_1"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasters-that-require-the-horizon-already-in-fit">1.2.2 Forecasters that require the horizon already in <code class="docutils literal notranslate"><span class="pre">fit</span></code> <a class="anchor" id="section_1_2_2"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasters-that-can-make-use-of-exogeneous-data">1.2.3 Forecasters that can make use of exogeneous data<a class="anchor" id="section_1_2_3"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multivariate-forecasting">1.2.4. Multivariate forecasting <a class="anchor" id="section_1_2_4"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-forecasting-prediction-intervals-quantile-variance-and-distributional-forecasts">1.2.5 Probabilistic forecasting: prediction intervals, quantile, variance, and distributional forecasts <a class="anchor" id="section_1_2_5"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-interval-interval-predictions"><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> - interval predictions</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-quantiles-quantile-forecasts"><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> - quantile forecasts</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-var-variance-predictions"><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> - variance predictions</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-proba-distribution-predictions"><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> - distribution predictions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-forecasts-and-hierarchical-forecasts">1.2.6 Panel forecasts and hierarchical forecasts <a class="anchor" id="section_1_2_6"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-evaluation-workflow-evaluating-a-batch-of-forecasts-against-ground-truth-observations">1.3 Basic evaluation workflow - evaluating a batch of forecasts against ground truth observations<a class="anchor" id="section_1_3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-splitting-a-historical-data-set-in-to-a-temporal-train-and-test-batch">Step 1 - Splitting a historical data set in to a temporal train and test batch</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-making-forecasts-for-y-test-from-y-train">Step 2 - Making forecasts for y_test from y_train</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-3-and-4-specifying-a-forecasting-metric-evaluating-on-the-test-set">Steps 3 and 4 - Specifying a forecasting metric, evaluating on the test set</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-testing-performance-against-benchmarks">Step 5 - Testing performance against benchmarks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-batch-forecast-evaluation-workflow-in-a-nutshell-function-metric-interface">1.3.1 The basic batch forecast evaluation workflow in a nutshell - function metric interface<a class="anchor" id="section_1_3_1"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-batch-forecast-evaluation-workflow-in-a-nutshell-metric-class-interface">1.3.2 The basic batch forecast evaluation workflow in a nutshell - metric class interface<a class="anchor" id="section_1_3_2"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-deployment-workflow-rolling-updates-forecasts">1.4 Advanced deployment workflow: rolling updates &amp; forecasts<a class="anchor" id="section_1_4"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-a-forecaster-with-the-update-method">1.4.1 Updating a forecaster with the <code class="docutils literal notranslate"><span class="pre">update</span></code> method<a class="anchor" id="section_1_4_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-the-now-state-without-updating-the-model">1.4.2 Moving the “now” state without updating the model<a class="anchor" id="section_1_4_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#walk-forward-predictions-on-a-batch-of-data">1.4.3 Walk-forward predictions on a batch of data<a class="anchor" id="section_1_4_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-evaluation-workflow-rolling-re-sampling-and-aggregate-errors-rolling-back-testing">1.5 Advanced evaluation workflow: rolling re-sampling and aggregate errors, rolling back-testing<a class="anchor" id="section_1_5"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasters-in-sktime-lookup-properties-main-families">2. Forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> - lookup, properties, main families<a class="anchor" id="chapter2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#listing-all-forecasters-in-sktime">2.1 Listing all forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="section_2_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecaster-tags">2.2 Forecaster tags <a class="anchor" id="section_2_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#capability-tags-multivariate-probabilistic-hierarchical">2.2.1 Capability tags: multivariate, probabilistic, hierarchical <a class="anchor" id="section_2_2_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-and-listing-forecasters-by-tag">2.2.2 Finding and listing forecasters by tag <a class="anchor" id="section_2_2_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#listing-all-forecaster-tags">2.2.3 Listing all forecaster tags <a class="anchor" id="section_2_2_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-forecasters-in-sktime">2.3 Common forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> <a class="anchor" id="section_2_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exponential-smoothing-theta-forecaster-autoets-from-statsmodels">2.3.1 Exponential smoothing, theta forecaster, autoETS from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code><a class="anchor" id="section_2_3_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arima-and-autoarima">2.3.2 ARIMA and autoARIMA<a class="anchor" id="section_2_3_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bats-and-tbats">2.3.3 BATS and TBATS<a class="anchor" id="section_2_3_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#facebook-prophet">2.3.4 Facebook prophet<a class="anchor" id="section_2_3_4"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-space-model-structural-time-series">2.3.5 State Space Model (Structural Time Series)<a class="anchor" id="section_2_3_5"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autoarima-from-statsforecast">2.3.6 AutoARIMA from StatsForecast<a class="anchor" id="section_2_3_6"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-composition-patterns-pipelines-reduction-automl-and-more">3. Advanced composition patterns - pipelines, reduction, autoML, and more<a class="anchor" id="chapter3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduction-from-forecasting-to-regression">3.1 Reduction: from forecasting to regression<a class="anchor" id="section_3_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelining-detrending-and-deseasonalization">3.2 Pipelining, detrending and deseasonalization<a class="anchor" id="section_3_2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-forecasting-pipeline">3.2.1 The basic forecasting pipeline<a class="anchor" id="section_3_2_1"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-detrender-as-pipeline-component">3.2.2 The <code class="docutils literal notranslate"><span class="pre">Detrender</span></code> as pipeline component<a class="anchor" id="section_3_2_2"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#complex-pipeline-composites-and-parameter-inspection">3.2.3 Complex pipeline composites and parameter inspection<a class="anchor" id="section_3_2_3"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-tuning">3.3 Parameter tuning<a class="anchor" id="section_3_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-tuning-using-forecastinggridsearchcv">3.3.1 Basic tuning using <code class="docutils literal notranslate"><span class="pre">ForecastingGridSearchCV</span></code><a class="anchor" id="section_3_3_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-of-complex-composites">3.3.2 Tuning of complex composites<a class="anchor" id="section_3_3_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-the-metric-and-retrieving-scores">3.3.3 Selecting the metric and retrieving scores<a class="anchor" id="section_3_3_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automl-aka-automated-model-selection-ensembling-and-hedging">3.4 autoML  aka automated model selection, ensembling and hedging<a class="anchor" id="section_3_4"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automl-aka-automatic-model-selection-using-tuning-plus-multiplexer">3.4.1 autoML aka automatic model selection, using tuning plus multiplexer<a class="anchor" id="section_3_4_1"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automl-selecting-transformer-combinations-via-optimalpassthrough">3.4.2 autoML: selecting transformer combinations via <code class="docutils literal notranslate"><span class="pre">OptimalPassthrough</span></code><a class="anchor" id="section_3_4_2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-ensembling-strategies">3.4.3 Simple ensembling strategies<a class="anchor" id="section_3_4_3"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction-weighted-ensembles-and-hedge-ensembles">3.4.4 Prediction weighted ensembles and hedge ensembles<a class="anchor" id="section_3_4_4"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extension-guide-implementing-your-own-forecaster">4. Extension guide - implementing your own forecaster<a class="anchor" id="chapter4"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">5. Summary<a class="anchor" id="chapter5"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-resources">Useful resources</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits:</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>