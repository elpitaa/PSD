
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Time Series Classification, Regression, Clustering &amp; More &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '.venv/lib64/python3.11/site-packages/examples/02_classification';</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My sample book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F.venv/lib64/python3.11/site-packages/examples/02_classification.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../_sources/.venv/lib64/python3.11/site-packages/examples/02_classification.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Time Series Classification, Regression, Clustering & More</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-this-notebook">Overview of this notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-data-sktime-data-formats">2.1 Panel data - <code class="docutils literal notranslate"><span class="pre">sktime</span></code> data formats <a name="panel"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preferred-format-1-pd-multiindex-specification">2.1.1 Preferred format 1 - <code class="docutils literal notranslate"><span class="pre">pd-multiindex</span></code> specification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preferred-format-2-numpy3d-specification">2.1.2 preferred format 2 - <code class="docutils literal notranslate"><span class="pre">numpy3D</span></code> specification</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-classification-regression-clustering-basic-vignettes">2.2 Time Series Classification, Regression, Clustering - Basic Vignettes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-classification-deployment-vignette">2.2.3 Time Series Classification - deployment vignette</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-classification-simple-evaluation-vignette">2.2.4 Time Series Classification - simple evaluation vignette</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-regression-basic-vignettes">2.2.5 Time Series Regression - basic vignettes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-clustering-basic-vignettes">5.2.6 Time Series Clustering - basic vignettes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-estimators-estimator-tags">2.3 Searching for estimators, estimator tags</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines-feature-extraction-tuning-composition">2.4 Pipelines, Feature Extraction, Tuning, Composition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primer-on-sktime-transformers-for-feature-extraction">2.4.1 Primer on <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers for feature extraction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines-for-time-series-panel-tasks">2.4.2 Pipelines for time series panel tasks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-transformers-to-deal-with-unequal-length-or-missing-values">2.4.3 Using transformers to deal with unequal length or missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-and-model-selection">2.4.4 Tuning and model selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-composition-cheat-sheet-automl-bagging-ensembles">2.4.5 Advanced Composition cheat sheet - AutoML, bagging, ensembles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-extension-guide">2.5 Appendix - Extension guide</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="time-series-classification-regression-clustering-more">
<h1>Time Series Classification, Regression, Clustering &amp; More<a class="headerlink" href="#time-series-classification-regression-clustering-more" title="Link to this heading">#</a></h1>
<section id="overview-of-this-notebook">
<h2>Overview of this notebook<a class="headerlink" href="#overview-of-this-notebook" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Introduction to time series classification, regression, clustering</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> data format fo “time series panels” = collections of time series</p></li>
<li><p>Basic vignettes for TSC, TSR, TSCl</p></li>
<li><p>Advanced vignettes - pipelines, ensembles, tuning</p></li>
</ul>
<p>Deal with <em>collections of time series</em> = “panel data”</p>
<p>Classification = try to assign one <em>category</em> per time series, after training on time series/category examples</p>
<ul class="simple">
<li><p>Example: Daily energy consumption profile over time - Predict season, e.g., winter/summer, or type of consumer</p></li>
</ul>
<p>Regression = try to assign one <em>category</em> per time series, after training on time series/category examples</p>
<ul class="simple">
<li><p>Example: Temperature/pressure/time profile of chemical reactor - Predict total purity (fraction of 1)</p></li>
</ul>
<p>Clustering = put different time series in a small number of similarity buckets</p>
<ul class="simple">
<li><p>Example: Service Level Agreement (SLA) Breaches - Group the collected Panel data to identify common reasons for SLA failures</p></li>
</ul>
<p>Time Series Classification:</p>
<p><img src="./img/tsc.png" width="600" alt="time series classification"> <a class="reference download internal" download="" href="../../../../../_downloads/af783206904797b5a868bb994589eef4/tsc.png"><span class="xref download myst"><i>​</i></span></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Increase display width</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.width&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="panel-data-sktime-data-formats">
<h2>2.1 Panel data - <code class="docutils literal notranslate"><span class="pre">sktime</span></code> data formats <a name="panel"></a><a class="headerlink" href="#panel-data-sktime-data-formats" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Panel</span></code> is an abstract data type where the values are observed for:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">instance</span></code>, e.g., patient</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code>, e.g., blood pressure, body temperature of the patient</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time</span></code>/<code class="docutils literal notranslate"><span class="pre">index</span></code>, e.g., January 12, 2023 (usually but not necessarily a time index!)</p></li>
</ul>
<p>One value X is: “patient ‘A’ had blood pressure ‘X’ on January 12, 2023”</p>
<p>Time series classification, regression, clustering: slices <code class="docutils literal notranslate"><span class="pre">Panel</span></code> data by instance</p>
<p>Preferred format 1: <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> with 2-level <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>, (instance, time) and columns: variables</p>
<p>Preferred format 2: 3D <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> with index (instance, variable, time)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> supports and recognizes multiple data formats for convenience and internal use, e.g., <code class="docutils literal notranslate"><span class="pre">dask</span></code>, <code class="docutils literal notranslate"><span class="pre">xarray</span></code></p></li>
<li><p>abstract data type = “scitype”; in-memory specification = “mtype”</p></li>
<li><p>More information in tutorial on <a class="reference external" href="https://www.sktime.net/en/latest/examples/AA_datatypes_and_datasets.html#In-memory-data-representations-and-data-loading">in-memory data representations and data loading</a></p></li>
</ul>
<section id="preferred-format-1-pd-multiindex-specification">
<h3>2.1.1 Preferred format 1 - <code class="docutils literal notranslate"><span class="pre">pd-multiindex</span></code> specification<a class="headerlink" href="#preferred-format-1-pd-multiindex-specification" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pd-multiindex</span></code> = <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> with 2-level <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>, (instance, time) and columns: variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_italy_power_demand</span>

<span class="c1"># load an example time series panel in pd-multiindex mtype</span>
<span class="n">X</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;pd-multiindex&quot;</span><span class="p">)</span>

<span class="c1"># renaming columns for illustrative purposes</span>
<span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;total_power_demand&quot;</span><span class="p">]</span>
<span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;day_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;hour_of_day&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The Italy power demand dataset has:</p>
<ul class="simple">
<li><p>1096 individual time series instances = single days of total power demand (mean subtracted)</p></li>
<li><p>one single variable per time series instances, <code class="docutils literal notranslate"><span class="pre">total_power_demand</span></code></p>
<ul>
<li><p>total power demand on that day, in that hourly period</p></li>
<li><p>Since there’s only one column, it is a univariate dataset</p></li>
</ul>
</li>
<li><p>individual time series are observed at 24 time (period) points (the same number for all instances)</p></li>
</ul>
<p>In the dataset, days are jumbled and of different scope (independent sampling).</p>
<ul class="simple">
<li><p>considered independent - because <code class="docutils literal notranslate"><span class="pre">hour_of_day</span></code> in one sample doesn’t affect <code class="docutils literal notranslate"><span class="pre">hour_of_day</span></code> in another</p></li>
<li><p>for task, e.g., “identify season or weekday/weekend from pattern”</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>total_power_demand</th>
    </tr>
    <tr>
      <th>day_ID</th>
      <th>hour_of_day</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>-0.710518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.183320</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.372442</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.593083</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.467002</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">1095</th>
      <th>19</th>
      <td>0.180490</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.094058</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.729587</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.210995</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-0.002542</td>
    </tr>
  </tbody>
</table>
<p>26304 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_basic_motions</span>

<span class="c1"># load an example time series panel in pd-multiindex mtype</span>
<span class="n">X</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_basic_motions</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;pd-multiindex&quot;</span><span class="p">)</span>

<span class="c1"># renaming columns for illustrative purposes</span>
<span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;accel_1&quot;</span><span class="p">,</span> <span class="s2">&quot;accel_2&quot;</span><span class="p">,</span> <span class="s2">&quot;accel_3&quot;</span><span class="p">,</span> <span class="s2">&quot;gyro_1&quot;</span><span class="p">,</span> <span class="s2">&quot;gyro_2&quot;</span><span class="p">,</span> <span class="s2">&quot;gyro_3&quot;</span><span class="p">]</span>
<span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;trial_no&quot;</span><span class="p">,</span> <span class="s2">&quot;timepoint&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The basic motions dataset has:</p>
<ul class="simple">
<li><p>80 individual time series instances = trials = person engaging in an activity like running, badminton, etc.</p></li>
<li><p>six variables per time series instance, <code class="docutils literal notranslate"><span class="pre">dim_0</span></code> to <code class="docutils literal notranslate"><span class="pre">dim_5</span></code> (renamed according to the values they represent)</p>
<ul>
<li><p>3 accelerometer and 3 gyrometer measurements</p></li>
<li><p>hence a multivariate dataset</p></li>
</ul>
</li>
<li><p>individual time series are observed at 100 time points (the same number for all instances)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The outermost index represents the instance number</span>
<span class="c1"># whereas the inner index represents the index of the particular index</span>
<span class="c1"># within that instance.</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>accel_1</th>
      <th>accel_2</th>
      <th>accel_3</th>
      <th>gyro_1</th>
      <th>gyro_2</th>
      <th>gyro_3</th>
    </tr>
    <tr>
      <th>trial_no</th>
      <th>timepoint</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>0.079106</td>
      <td>0.394032</td>
      <td>0.551444</td>
      <td>0.351565</td>
      <td>0.023970</td>
      <td>0.633883</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.079106</td>
      <td>0.394032</td>
      <td>0.551444</td>
      <td>0.351565</td>
      <td>0.023970</td>
      <td>0.633883</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.903497</td>
      <td>-3.666397</td>
      <td>-0.282844</td>
      <td>-0.095881</td>
      <td>-0.319605</td>
      <td>0.972131</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.116125</td>
      <td>-0.656101</td>
      <td>0.333118</td>
      <td>1.624657</td>
      <td>-0.569962</td>
      <td>1.209171</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.638200</td>
      <td>1.405135</td>
      <td>0.393875</td>
      <td>1.187864</td>
      <td>-0.271664</td>
      <td>1.739182</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">79</th>
      <th>95</th>
      <td>28.459024</td>
      <td>-16.633770</td>
      <td>3.631869</td>
      <td>8.978229</td>
      <td>-3.611533</td>
      <td>-1.491489</td>
    </tr>
    <tr>
      <th>96</th>
      <td>10.260094</td>
      <td>0.102775</td>
      <td>1.269261</td>
      <td>-1.645964</td>
      <td>-3.377157</td>
      <td>1.283746</td>
    </tr>
    <tr>
      <th>97</th>
      <td>4.316471</td>
      <td>-3.574319</td>
      <td>2.063831</td>
      <td>-1.717875</td>
      <td>-1.843054</td>
      <td>0.484734</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0.704446</td>
      <td>-4.920444</td>
      <td>2.851857</td>
      <td>-2.982977</td>
      <td>-0.809665</td>
      <td>-0.721774</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-2.074749</td>
      <td>-6.892377</td>
      <td>4.848379</td>
      <td>-1.350330</td>
      <td>-1.203844</td>
      <td>-1.776470</td>
    </tr>
  </tbody>
</table>
<p>8000 rows × 6 columns</p>
</div></div></div>
</div>
<p>pandas provides a simple way to access a range of value in the multi-indexed dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select:</span>
<span class="c1"># * the fourth variable (gyroscope 1)</span>
<span class="c1"># * of the first instance (trial 1 = 0 in python)</span>
<span class="c1"># * values at all 100 timestamps</span>
<span class="c1">#</span>
<span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;gyro_1&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>timepoint
0     0.351565
1     0.351565
2    -0.095881
3     1.624657
4     1.187864
        ...   
95    0.039951
96   -0.029297
97    0.000000
98    0.000000
99   -0.007990
Name: gyro_1, Length: 100, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Or if you want to access the individual values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select:</span>
<span class="c1"># * the fifth time time point (5 = 4 in python, because of 0-indexing)</span>
<span class="c1"># * the third variable (accelerometer 3)</span>
<span class="c1"># * of the forty-third instance (trial 43 = 42 in python)</span>

<span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;accel_3&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.27952
</pre></div>
</div>
</div>
</div>
</section>
<section id="preferred-format-2-numpy3d-specification">
<h3>2.1.2 preferred format 2 - <code class="docutils literal notranslate"><span class="pre">numpy3D</span></code> specification<a class="headerlink" href="#preferred-format-2-numpy3d-specification" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">numpy3D</span></code> = 3D <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> with index (instance, variable, time)</p>
<p>instance/time index is interpreted as integer</p>
<p>IMPORTANT: unlike <code class="docutils literal notranslate"><span class="pre">pd-multiindex</span></code>, this assumes:</p>
<ul class="simple">
<li><p>all individual series have the same length</p></li>
<li><p>all individual series have the same index</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_italy_power_demand</span>

<span class="c1"># load an example time series panel in numpy mtype</span>
<span class="n">X</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The Italy power demand dataset has:</p>
<ul class="simple">
<li><p>1096 individual time series instances = single days of total power demand (mean subtracted)</p></li>
<li><p>one single variable per time series instances, unnamed in numpy</p></li>
<li><p>individual time series are observed at 24 time (period) points (the same number for all instances)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (num_instances, num_variables, length)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1096, 1, 24)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_basic_motions</span>

<span class="c1"># load an example time series panel in numpy mtype</span>
<span class="n">X</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_basic_motions</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The basic motions dataset has:</p>
<ul class="simple">
<li><p>80 individual time series instances = trials = person engaging in activity (running, badminton, etc)</p></li>
<li><p>six variables per time series instance, unnamed in numpy</p></li>
<li><p>individual time series are observed at 100 time points (the same number for all instances)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(80, 6, 100)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="time-series-classification-regression-clustering-basic-vignettes">
<h2>2.2 Time Series Classification, Regression, Clustering - Basic Vignettes<a class="headerlink" href="#time-series-classification-regression-clustering-basic-vignettes" title="Link to this heading">#</a></h2>
<p>Above tasks are very similar to “tabular” classification, regression, clustering, as in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></p>
<p>Main distinction:</p>
<ul class="simple">
<li><p>in “tabular” classification etc, one (feature) instance row vector of features</p></li>
<li><p>in TSC, one (feature) instance is a full time series, possibly unequal length, distinct index set</p></li>
</ul>
<p><img alt="" src="../../../../../_images/tsc3.png" /></p>
<p>More formally:</p>
<ul class="simple">
<li><p>“tabular” classification:</p>
<ul>
<li><p>training pairs <span class="math notranslate nohighlight">\((x_1, y_1), \dots, (x_n, y_n)\)</span></p>
<ul>
<li><p>where <span class="math notranslate nohighlight">\(x_i\)</span> are rows of a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> (same col types)</p></li>
<li><p>and <span class="math notranslate nohighlight">\(y_i \in \mathcal{C}\)</span> for a finite set <span class="math notranslate nohighlight">\(\mathcal{C}\)</span></p></li>
</ul>
</li>
<li><p>is used to train a classifier that</p>
<ul>
<li><p>for a new <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> row <span class="math notranslate nohighlight">\(x_*\)</span></p></li>
<li><p>predicts <span class="math notranslate nohighlight">\(y_* \in \mathcal{C}\)</span></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>time series classification:</p>
<ul>
<li><p>training pairs <span class="math notranslate nohighlight">\((x_1, y_1), \dots, (x_n, y_n)\)</span></p>
<ul>
<li><p>where <span class="math notranslate nohighlight">\(x_i\)</span> are time series instances, from a certain domain</p></li>
<li><p>and <span class="math notranslate nohighlight">\(y_i \in \mathcal{C}\)</span> for a finite set <span class="math notranslate nohighlight">\(\mathcal{C}\)</span></p></li>
</ul>
</li>
<li><p>is used to train a classifier that</p>
<ul>
<li><p>for a new time series instance <span class="math notranslate nohighlight">\(x_*\)</span></p></li>
<li><p>predicts <span class="math notranslate nohighlight">\(y_* \in \mathcal{C}\)</span></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>very similar for time series regression, clustering - exercise left to reader :-)</p>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> design implications:</p>
<ul class="simple">
<li><p>need representation of collections of time series (panels),
see tutorial <a class="reference internal" href="AA_datatypes_and_datasets.html"><span class="std std-doc">In-memory data representations and data loading</span></a> for more details on representation of Panel data.</p>
<ul>
<li><p>same as in “adjacent” learning tasks, e.g., panel forecasting</p></li>
<li><p>same as for transformation estimators</p></li>
</ul>
</li>
<li><p>algorithms that use sequentiality, can deal with unequal length, missing values etc</p></li>
<li><p>algorithms usually based on distances or kernels between time series - need to cover that in framework</p></li>
<li><p>but we can use familiar <code class="docutils literal notranslate"><span class="pre">fit</span></code> / <code class="docutils literal notranslate"><span class="pre">predict</span></code> and <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> / <code class="docutils literal notranslate"><span class="pre">scikit-base</span></code> interface!</p></li>
</ul>
<section id="time-series-classification-deployment-vignette">
<h3>2.2.3 Time Series Classification - deployment vignette<a class="headerlink" href="#time-series-classification-deployment-vignette" title="Link to this heading">#</a></h3>
<p>Basic deployment vignette for TSC:</p>
<ol class="arabic simple">
<li><p>load/setup training data, <code class="docutils literal notranslate"><span class="pre">X</span></code> in a <code class="docutils literal notranslate"><span class="pre">Panel</span></code> (more specifically <code class="docutils literal notranslate"><span class="pre">numpy3D</span></code>) format, <code class="docutils literal notranslate"><span class="pre">y</span></code> as 1D <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code></p></li>
<li><p>load/setup new data for prediction (can be done after 3 too)</p></li>
<li><p>specify the classifier using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>-like syntax</p></li>
<li><p>fit classifier to training data, <code class="docutils literal notranslate"><span class="pre">fit(X,</span> <span class="pre">y)</span></code></p></li>
<li><p>predict labels on new data, <code class="docutils literal notranslate"><span class="pre">predict(X_new)</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># steps 1, 2 - prepare osuleaf dataset (train and new)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_italy_power_demand</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>
<span class="n">X_new</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is in numpy3D format, but could also be pd-multiindex or other</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67, 1, 24)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># y is a 1D np.ndarray of labels - same length as number of instances in X_train</span>
<span class="n">y_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 3 - specify the classifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>

<span class="c1"># example 1 - 3-NN with simple dynamic time warping distance (requires numba)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># example 2 - custom distance:</span>
<span class="c1"># 3-nearest neighbour classifier with Euclidean distance (on flattened time series)</span>
<span class="c1"># (requires scipy)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.dists_kernels</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlatDist</span><span class="p">,</span> <span class="n">ScipyDist</span>

<span class="n">eucl_dist</span> <span class="o">=</span> <span class="n">FlatDist</span><span class="p">(</span><span class="n">ScipyDist</span><span class="p">())</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">eucl_dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>we could specify any <code class="docutils literal notranslate"><span class="pre">sktime</span></code> classifier here - the rest remains the same!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># all classifiers is scikit-learn / scikit-base compatible!</span>
<span class="c1"># nested parameter interface via get_params, set_params</span>
<span class="n">clf</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;algorithm&#39;: &#39;brute&#39;,
 &#39;distance&#39;: FlatDist(transformer=ScipyDist()),
 &#39;distance_mtype&#39;: None,
 &#39;distance_params&#39;: None,
 &#39;leaf_size&#39;: 30,
 &#39;n_jobs&#39;: None,
 &#39;n_neighbors&#39;: 3,
 &#39;pass_train_distances&#39;: False,
 &#39;weights&#39;: &#39;uniform&#39;,
 &#39;distance__transformer&#39;: ScipyDist(),
 &#39;distance__transformer__colalign&#39;: &#39;intersect&#39;,
 &#39;distance__transformer__metric&#39;: &#39;euclidean&#39;,
 &#39;distance__transformer__metric_kwargs&#39;: None,
 &#39;distance__transformer__p&#39;: 2,
 &#39;distance__transformer__var_weights&#39;: None}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 4 - fit/train the classifier</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-8caf728f-3734-406a-a91b-bd8571f39855 {color: black;background-color: white;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 pre{padding: 0;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-toggleable {background-color: white;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-estimator:hover {background-color: #d4ebff;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-item {z-index: 1;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-parallel-item:only-child::after {width: 0;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-8caf728f-3734-406a-a91b-bd8571f39855 div.sk-text-repr-fallback {display: none;}</style><div id='sk-8caf728f-3734-406a-a91b-bd8571f39855' class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KNeighborsTimeSeriesClassifier(distance=FlatDist(transformer=ScipyDist()),
                               n_neighbors=3)</pre><b>Please rerun this cell to show the HTML repr or trust the notebook.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class='sk-label-container'><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('e353be50-5527-43ed-8038-8d37418da170') type="checkbox" ><label for=UUID('e353be50-5527-43ed-8038-8d37418da170') class='sk-toggleable__label sk-toggleable__label-arrow'>KNeighborsTimeSeriesClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsTimeSeriesClassifier(distance=FlatDist(transformer=ScipyDist()),
                               n_neighbors=3)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('8c4f22b4-9a4b-44e4-a6bb-152cc66b9766') type="checkbox" ><label for=UUID('8c4f22b4-9a4b-44e4-a6bb-152cc66b9766') class='sk-toggleable__label sk-toggleable__label-arrow'>ScipyDist</label><div class="sk-toggleable__content"><pre>ScipyDist()</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the classifier is now fitted</span>
<span class="n">clf</span><span class="o">.</span><span class="n">is_fitted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and we can inspect fitted parameters if we like</span>
<span class="n">clf</span><span class="o">.</span><span class="n">get_fitted_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;classes&#39;: array([&#39;1&#39;, &#39;2&#39;], dtype=&#39;&lt;U1&#39;),
 &#39;fit_time&#39;: 3,
 &#39;knn_estimator&#39;: KNeighborsClassifier(algorithm=&#39;brute&#39;, metric=&#39;precomputed&#39;, n_neighbors=3),
 &#39;n_classes&#39;: 2,
 &#39;knn_estimator__classes&#39;: array([&#39;1&#39;, &#39;2&#39;], dtype=&#39;&lt;U1&#39;),
 &#39;knn_estimator__effective_metric&#39;: &#39;precomputed&#39;,
 &#39;knn_estimator__effective_metric_params&#39;: {},
 &#39;knn_estimator__n_features_in&#39;: 67,
 &#39;knn_estimator__n_samples_fit&#39;: 67,
 &#39;knn_estimator__outputs_2d&#39;: False}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 5 - predict labels on new data</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># y_pred is an 1D np.ndarray, similar to sklearn classification output</span>
<span class="n">y_pred</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;2&#39;, &#39;2&#39;, &#39;2&#39;, ..., &#39;2&#39;, &#39;2&#39;, &#39;2&#39;], dtype=&#39;&lt;U1&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># predictions and unique counts, for illustration</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([&#39;1&#39;, &#39;2&#39;], dtype=&#39;&lt;U1&#39;), array([510, 519], dtype=int64))
</pre></div>
</div>
</div>
</div>
<p>all together in one cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># steps 1, 2 - prepare osuleaf dataset (train and new)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_italy_power_demand</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>
<span class="n">X_new</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>

<span class="c1"># step 3 - specify the classifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.dists_kernels</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlatDist</span><span class="p">,</span> <span class="n">ScipyDist</span>

<span class="n">eucl_dist</span> <span class="o">=</span> <span class="n">FlatDist</span><span class="p">(</span><span class="n">ScipyDist</span><span class="p">())</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">eucl_dist</span><span class="p">)</span>

<span class="c1"># step 4 - fit/train the classifier</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># step 5 - predict labels on new data</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-series-classification-simple-evaluation-vignette">
<h3>2.2.4 Time Series Classification - simple evaluation vignette<a class="headerlink" href="#time-series-classification-simple-evaluation-vignette" title="Link to this heading">#</a></h3>
<p>Evaluation is similar to <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> classifiers - we split a dataset and evaluate performance on the test set.</p>
<p>This includes as additional steps:</p>
<ul class="simple">
<li><p>splitting the initial, historical data, e.g., using <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code></p></li>
<li><p>comparing predictions with a held out data set</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_italy_power_demand</span>

<span class="c1"># data should be split into train/test</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>

<span class="c1"># step 3-5 are the same</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.dists_kernels</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlatDist</span><span class="p">,</span> <span class="n">ScipyDist</span>

<span class="n">eucl_dist</span> <span class="o">=</span> <span class="n">FlatDist</span><span class="p">(</span><span class="n">ScipyDist</span><span class="p">())</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">eucl_dist</span><span class="p">)</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># for simplest evaluation, compare ground truth to predictions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.956268221574344
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-series-regression-basic-vignettes">
<h3>2.2.5 Time Series Regression - basic vignettes<a class="headerlink" href="#time-series-regression-basic-vignettes" title="Link to this heading">#</a></h3>
<p>TSR vignettes are exactly the same as TSC, except that:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> in <code class="docutils literal notranslate"><span class="pre">fit</span></code> input and <code class="docutils literal notranslate"><span class="pre">predict</span></code> output should be float 1D <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, not categorical</p></li>
<li><p>other algorithms are commonly used and/or performant</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># steps 1, 2 - prepare dataset (train and new)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_covid_3month</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_covid_3month</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
<span class="n">X_new</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_covid_3month</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">X_new</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># smaller dataset for faster notebook runtime</span>

<span class="c1"># step 3 - specify the regressor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.regression.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesRegressor</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsTimeSeriesRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">eucl_dist</span><span class="p">)</span>

<span class="c1"># step 4 - fit/train the regressor</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># step 5 - predict labels on new data</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span>  <span class="c1"># predictions are array of float</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.02957762, 0.0065062 , 0.00183655])
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-series-clustering-basic-vignettes">
<h3>5.2.6 Time Series Clustering - basic vignettes<a class="headerlink" href="#time-series-clustering-basic-vignettes" title="Link to this heading">#</a></h3>
<p>TS clustering is similar - 1st step is also <code class="docutils literal notranslate"><span class="pre">fit</span></code>, but unsupervised</p>
<p>i.e., no labels <code class="docutils literal notranslate"><span class="pre">y</span></code>, and next step is inspecting clusters</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># step 1 - prepare dataset (train and new)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_italy_power_demand</span>

<span class="n">X</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;numpy3D&quot;</span><span class="p">)</span>

<span class="c1"># step 2 - specify the clusterer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.clustering.dbscan</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesDBSCAN</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.dists_kernels</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlatDist</span><span class="p">,</span> <span class="n">ScipyDist</span>

<span class="n">eucl_dist</span> <span class="o">=</span> <span class="n">FlatDist</span><span class="p">(</span><span class="n">ScipyDist</span><span class="p">())</span>
<span class="n">clst</span> <span class="o">=</span> <span class="n">TimeSeriesDBSCAN</span><span class="p">(</span><span class="n">distance</span><span class="o">=</span><span class="n">eucl_dist</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># step 3 - fit the clusterer to the data</span>
<span class="n">clst</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># step 4 - inspect the clustering</span>
<span class="n">clst</span><span class="o">.</span><span class="n">get_fitted_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;core_sample_indices&#39;: array([ 0,  1,  3,  4,  6,  7,  8,  9, 10, 11, 12, 13, 14, 16, 17, 18, 19,
        20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32, 33, 34, 35, 36, 37,
        38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 50, 52, 53, 54, 55, 56, 57,
        58, 60, 61, 62, 63, 64, 65], dtype=int64),
 &#39;dbscan&#39;: DBSCAN(eps=2, metric=&#39;precomputed&#39;),
 &#39;fit_time&#39;: 4,
 &#39;labels&#39;: array([ 0,  0, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,
         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,
         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,
         0,  0,  0,  0,  0,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0, -1],
       dtype=int64),
 &#39;dbscan__components&#39;: array([[0.        , 2.21059984, 7.22653506, ..., 2.43397663, 3.42512865,
         5.77701453],
        [2.21059984, 0.        , 7.31863575, ..., 0.8952782 , 2.01224344,
         5.73199202],
        [2.98199582, 1.8413087 , 7.5785501 , ..., 1.5676963 , 1.41086552,
         5.96418696],
        ...,
        [3.78429193, 2.68599227, 6.32367754, ..., 2.71202763, 1.36130647,
         4.47124464],
        [2.43397663, 0.8952782 , 7.59888847, ..., 0.        , 1.98453315,
         5.99830821],
        [3.42512865, 2.01224344, 7.02761342, ..., 1.98453315, 0.        ,
         5.27610504]]),
 &#39;dbscan__core_sample_indices&#39;: array([ 0,  1,  3,  4,  6,  7,  8,  9, 10, 11, 12, 13, 14, 16, 17, 18, 19,
        20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32, 33, 34, 35, 36, 37,
        38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 50, 52, 53, 54, 55, 56, 57,
        58, 60, 61, 62, 63, 64, 65], dtype=int64),
 &#39;dbscan__labels&#39;: array([ 0,  0, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,
         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,
         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,
         0,  0,  0,  0,  0,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0, -1],
       dtype=int64),
 &#39;dbscan__n_features_in&#39;: 67}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="searching-for-estimators-estimator-tags">
<h2>2.3 Searching for estimators, estimator tags<a class="headerlink" href="#searching-for-estimators-estimator-tags" title="Link to this heading">#</a></h2>
<p>Estimators in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> are tagged.</p>
<p>Tags starting with “capability” indicate things the estimator can or cannot do, e.g.,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;capability:missing_values&quot;</span></code> - dealing with missing values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;capability:multivariate&quot;</span></code> - dealing with multivariate input</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;capability:unequal_length&quot;</span></code> - deaing with time series panels where the individual time series have unequal length and/or unequal index</p></li>
</ul>
<p>all tags for an estimator scitype (e.g., classifier, regressor) can be inspected by <code class="docutils literal notranslate"><span class="pre">sktime.registry.all_tags</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_tags</span>

<span class="n">all_tags</span><span class="p">(</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>scitype</th>
      <th>type</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>capability:contractable</td>
      <td>classifier</td>
      <td>bool</td>
      <td>contract time setting, does the estimator supp...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>capability:missing_values</td>
      <td>[classifier, early_classifier, param_est, regr...</td>
      <td>bool</td>
      <td>can the classifier handle missing data (NA, np...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>capability:multithreading</td>
      <td>[classifier, early_classifier]</td>
      <td>bool</td>
      <td>can the classifier set n_jobs to use multiple ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>capability:multivariate</td>
      <td>[classifier, early_classifier, param_est, regr...</td>
      <td>bool</td>
      <td>can the classifier classify time series with 2...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>capability:predict_proba</td>
      <td>classifier</td>
      <td>bool</td>
      <td>does the classifier implement a non-default pr...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>capability:train_estimate</td>
      <td>classifier</td>
      <td>bool</td>
      <td>can the classifier estimate its performance on...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>capability:unequal_length</td>
      <td>[classifier, early_classifier, regressor, tran...</td>
      <td>bool</td>
      <td>can the estimator handle unequal length time s...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>classifier_type</td>
      <td>classifier</td>
      <td>(list, [dictionary, distance, feature, hybrid,...</td>
      <td>which type the classifier falls under in the t...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>valid estimator types are listed in the <code class="docutils literal notranslate"><span class="pre">all_tags</span></code> docstring, or <code class="docutils literal notranslate"><span class="pre">sktime.registry.BASE_CLASS_REGISTER</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">BASE_CLASS_REGISTER</span>

<span class="c1"># get only fist table column, the list of types</span>
<span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">BASE_CLASS_REGISTER</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;object&#39;,
 &#39;estimator&#39;,
 &#39;aligner&#39;,
 &#39;classifier&#39;,
 &#39;clusterer&#39;,
 &#39;early_classifier&#39;,
 &#39;forecaster&#39;,
 &#39;metric&#39;,
 &#39;network&#39;,
 &#39;param_est&#39;,
 &#39;regressor&#39;,
 &#39;series-annotator&#39;,
 &#39;splitter&#39;,
 &#39;transformer&#39;,
 &#39;transformer-pairwise&#39;,
 &#39;transformer-pairwise-panel&#39;,
 &#39;distribution&#39;)
</pre></div>
</div>
</div>
</div>
<p>to find all estimators of a certain type, use <code class="docutils literal notranslate"><span class="pre">sktime.registry.all_estimators</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list all classifiers in sktime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="n">all_estimators</span><span class="p">(</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>object</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arsenal</td>
      <td>&lt;class 'sktime.classification.kernel_based._ar...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BOSSEnsemble</td>
      <td>&lt;class 'sktime.classification.dictionary_based...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BaggingClassifier</td>
      <td>&lt;class 'sktime.classification.ensemble._baggin...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CNNClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.cn...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CanonicalIntervalForest</td>
      <td>&lt;class 'sktime.classification.interval_based._...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catch22Classifier</td>
      <td>&lt;class 'sktime.classification.feature_based._c...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ClassifierPipeline</td>
      <td>&lt;class 'sktime.classification.compose._pipelin...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ColumnEnsembleClassifier</td>
      <td>&lt;class 'sktime.classification.compose._column_...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ComposableTimeSeriesForestClassifier</td>
      <td>&lt;class 'sktime.classification.ensemble._ctsf.C...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ContractableBOSS</td>
      <td>&lt;class 'sktime.classification.dictionary_based...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>DrCIF</td>
      <td>&lt;class 'sktime.classification.interval_based._...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>DummyClassifier</td>
      <td>&lt;class 'sktime.classification.dummy._dummy.Dum...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>ElasticEnsemble</td>
      <td>&lt;class 'sktime.classification.distance_based._...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>FCNClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.fc...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>FreshPRINCE</td>
      <td>&lt;class 'sktime.classification.feature_based._f...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>HIVECOTEV1</td>
      <td>&lt;class 'sktime.classification.hybrid._hivecote...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>HIVECOTEV2</td>
      <td>&lt;class 'sktime.classification.hybrid._hivecote...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>InceptionTimeClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.in...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>IndividualBOSS</td>
      <td>&lt;class 'sktime.classification.dictionary_based...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>IndividualTDE</td>
      <td>&lt;class 'sktime.classification.dictionary_based...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>KNeighborsTimeSeriesClassifier</td>
      <td>&lt;class 'sktime.classification.distance_based._...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>LSTMFCNClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.ls...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>MACNNClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.ma...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>MCDCNNClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.mc...</td>
    </tr>
    <tr>
      <th>24</th>
      <td>MLPClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.ml...</td>
    </tr>
    <tr>
      <th>25</th>
      <td>MUSE</td>
      <td>&lt;class 'sktime.classification.dictionary_based...</td>
    </tr>
    <tr>
      <th>26</th>
      <td>MatrixProfileClassifier</td>
      <td>&lt;class 'sktime.classification.feature_based._m...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>MrSEQL</td>
      <td>&lt;class 'sktime.classification.shapelet_based._...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>MrSQM</td>
      <td>&lt;class 'sktime.classification.shapelet_based._...</td>
    </tr>
    <tr>
      <th>29</th>
      <td>ProbabilityThresholdEarlyClassifier</td>
      <td>&lt;class 'sktime.classification.early_classifica...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>ProximityForest</td>
      <td>&lt;class 'sktime.classification.distance_based._...</td>
    </tr>
    <tr>
      <th>31</th>
      <td>ProximityStump</td>
      <td>&lt;class 'sktime.classification.distance_based._...</td>
    </tr>
    <tr>
      <th>32</th>
      <td>ProximityTree</td>
      <td>&lt;class 'sktime.classification.distance_based._...</td>
    </tr>
    <tr>
      <th>33</th>
      <td>RandomIntervalClassifier</td>
      <td>&lt;class 'sktime.classification.feature_based._r...</td>
    </tr>
    <tr>
      <th>34</th>
      <td>RandomIntervalSpectralEnsemble</td>
      <td>&lt;class 'sktime.classification.interval_based._...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>ResNetClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.re...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>RocketClassifier</td>
      <td>&lt;class 'sktime.classification.kernel_based._ro...</td>
    </tr>
    <tr>
      <th>37</th>
      <td>ShapeDTW</td>
      <td>&lt;class 'sktime.classification.distance_based._...</td>
    </tr>
    <tr>
      <th>38</th>
      <td>ShapeletTransformClassifier</td>
      <td>&lt;class 'sktime.classification.shapelet_based._...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>SignatureClassifier</td>
      <td>&lt;class 'sktime.classification.feature_based._s...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>SimpleRNNClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.rn...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>SklearnClassifierPipeline</td>
      <td>&lt;class 'sktime.classification.compose._pipelin...</td>
    </tr>
    <tr>
      <th>42</th>
      <td>SummaryClassifier</td>
      <td>&lt;class 'sktime.classification.feature_based._s...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>SupervisedTimeSeriesForest</td>
      <td>&lt;class 'sktime.classification.interval_based._...</td>
    </tr>
    <tr>
      <th>44</th>
      <td>TSFreshClassifier</td>
      <td>&lt;class 'sktime.classification.feature_based._t...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>TapNetClassifier</td>
      <td>&lt;class 'sktime.classification.deep_learning.ta...</td>
    </tr>
    <tr>
      <th>46</th>
      <td>TemporalDictionaryEnsemble</td>
      <td>&lt;class 'sktime.classification.dictionary_based...</td>
    </tr>
    <tr>
      <th>47</th>
      <td>TimeSeriesForestClassifier</td>
      <td>&lt;class 'sktime.classification.interval_based._...</td>
    </tr>
    <tr>
      <th>48</th>
      <td>TimeSeriesSVC</td>
      <td>&lt;class 'sktime.classification.kernel_based._sv...</td>
    </tr>
    <tr>
      <th>49</th>
      <td>WEASEL</td>
      <td>&lt;class 'sktime.classification.dictionary_based...</td>
    </tr>
    <tr>
      <th>50</th>
      <td>WeightedEnsembleClassifier</td>
      <td>&lt;class 'sktime.classification.ensemble._weight...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>for listing all estimators of a certain type with a certain capability,
use the <code class="docutils literal notranslate"><span class="pre">filter_tags</span></code> argument of <code class="docutils literal notranslate"><span class="pre">all_estimators</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list all classifiers in sktime</span>
<span class="c1"># that can classify panels of time series containing missing data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
    <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;capability:missing_values&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>object</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BaggingClassifier</td>
      <td>&lt;class 'sktime.classification.ensemble._baggin...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DummyClassifier</td>
      <td>&lt;class 'sktime.classification.dummy._dummy.Dum...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>KNeighborsTimeSeriesClassifier</td>
      <td>&lt;class 'sktime.classification.distance_based._...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SklearnClassifierPipeline</td>
      <td>&lt;class 'sktime.classification.compose._pipelin...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TimeSeriesSVC</td>
      <td>&lt;class 'sktime.classification.kernel_based._sv...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>WeightedEnsembleClassifier</td>
      <td>&lt;class 'sktime.classification.ensemble._weight...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>side note:</p>
<p>don’t worry about how short the list is - when in doubt, it is always possible to pipeline with <code class="docutils literal notranslate"><span class="pre">Imputer</span></code></p>
<p>as in the next section :-)</p>
</section>
<section id="pipelines-feature-extraction-tuning-composition">
<h2>2.4 Pipelines, Feature Extraction, Tuning, Composition<a class="headerlink" href="#pipelines-feature-extraction-tuning-composition" title="Link to this heading">#</a></h2>
<p>similar to <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> for “tabular” classification, regression, etc,</p>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> has a rich set of tools for:</p>
<ul class="simple">
<li><p>feature extraction via transformers</p></li>
<li><p>pipeline transformers with any estimator</p></li>
<li><p>tuning individual estimators or pipelines via grid search and similar</p></li>
<li><p>building ensembles out of individual estimators, or other composites</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> is also fully interoperable with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> interface if <code class="docutils literal notranslate"><span class="pre">numpy</span></code> based data mtypes are used</p>
<p>(although this loses support for unequal length time series)</p>
<section id="primer-on-sktime-transformers-for-feature-extraction">
<h3>2.4.1 Primer on <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers for feature extraction<a class="headerlink" href="#primer-on-sktime-transformers-for-feature-extraction" title="Link to this heading">#</a></h3>
<p>all <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers work natively with panel data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_italy_power_demand</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.detrend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Detrender</span>

<span class="c1"># load some panel data</span>
<span class="n">X</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_italy_power_demand</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;pd-multiindex&quot;</span><span class="p">)</span>

<span class="c1"># specify a linear detrender</span>
<span class="n">detrender</span> <span class="o">=</span> <span class="n">Detrender</span><span class="p">()</span>

<span class="c1"># detrend X by removing linear trend from each instance</span>
<span class="n">X_detrended</span> <span class="o">=</span> <span class="n">detrender</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_detrended</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>dim_0</th>
    </tr>
    <tr>
      <th></th>
      <th>timepoints</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>0.267711</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.290155</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.564339</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.870044</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.829027</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">1095</th>
      <th>19</th>
      <td>-0.425904</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.781304</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-0.038512</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-0.637956</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-0.932346</td>
    </tr>
  </tbody>
</table>
<p>26304 rows × 1 columns</p>
</div></div></div>
</div>
<p>for panel tasks such as TSC, TSR, clustering, there are two distinctions to be aware of:</p>
<ul class="simple">
<li><p>series-to-series transformers transform individual series to series, panels to panels. E.g., instance-wise detrender above</p></li>
<li><p>series-to-primitive transformers transform individual series to a set of tabular features. E&gt;g., summary feature extractor</p></li>
</ul>
<p>either type of transform can be instance-wise:</p>
<ul class="simple">
<li><p>instance-wise transforms use only the i-th series to transform the i-th series. E.g., instance-wise detrender</p></li>
<li><p>non-instance-wise transforms train on all series to transform the i-th series. E.g., PCA, overall mean detrender</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of a series-to-primitive transformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.summarize</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryTransformer</span>

<span class="c1"># specify summary transformer</span>
<span class="n">summary_trafo</span> <span class="o">=</span> <span class="n">SummaryTransformer</span><span class="p">()</span>

<span class="c1"># extract summary features - one per instance in the panel</span>
<span class="n">X_summaries</span> <span class="o">=</span> <span class="n">summary_trafo</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_summaries</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>max</th>
      <th>0.1</th>
      <th>0.25</th>
      <th>0.5</th>
      <th>0.75</th>
      <th>0.9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.041667e-09</td>
      <td>1.0</td>
      <td>-1.593083</td>
      <td>1.464375</td>
      <td>-1.372442</td>
      <td>-0.805078</td>
      <td>0.030207</td>
      <td>0.936412</td>
      <td>1.218518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.958333e-09</td>
      <td>1.0</td>
      <td>-1.630917</td>
      <td>1.201393</td>
      <td>-1.533955</td>
      <td>-0.999388</td>
      <td>0.384871</td>
      <td>0.735720</td>
      <td>1.084018</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.775000e-09</td>
      <td>1.0</td>
      <td>-1.397118</td>
      <td>2.349344</td>
      <td>-1.003740</td>
      <td>-0.741487</td>
      <td>-0.132687</td>
      <td>0.265374</td>
      <td>1.515756</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-8.541667e-10</td>
      <td>1.0</td>
      <td>-1.646458</td>
      <td>1.344487</td>
      <td>-1.476779</td>
      <td>-0.898722</td>
      <td>0.266022</td>
      <td>0.776495</td>
      <td>1.039641</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-3.416667e-09</td>
      <td>1.0</td>
      <td>-1.620240</td>
      <td>1.303502</td>
      <td>-1.511644</td>
      <td>-0.978061</td>
      <td>0.405495</td>
      <td>0.692648</td>
      <td>1.061249</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1091</th>
      <td>-1.041667e-09</td>
      <td>1.0</td>
      <td>-1.817799</td>
      <td>1.630397</td>
      <td>-1.323058</td>
      <td>-0.643414</td>
      <td>0.081208</td>
      <td>0.568453</td>
      <td>1.390523</td>
    </tr>
    <tr>
      <th>1092</th>
      <td>-4.166666e-10</td>
      <td>1.0</td>
      <td>-1.550077</td>
      <td>1.513605</td>
      <td>-1.343747</td>
      <td>-0.768526</td>
      <td>0.075550</td>
      <td>0.857101</td>
      <td>1.276013</td>
    </tr>
    <tr>
      <th>1093</th>
      <td>4.166667e-09</td>
      <td>1.0</td>
      <td>-1.706992</td>
      <td>1.052255</td>
      <td>-1.498879</td>
      <td>-1.139943</td>
      <td>0.467669</td>
      <td>0.713195</td>
      <td>0.993797</td>
    </tr>
    <tr>
      <th>1094</th>
      <td>1.583333e-09</td>
      <td>1.0</td>
      <td>-1.673857</td>
      <td>2.420163</td>
      <td>-0.744173</td>
      <td>-0.479768</td>
      <td>-0.266538</td>
      <td>0.159923</td>
      <td>1.550184</td>
    </tr>
    <tr>
      <th>1095</th>
      <td>3.495833e-09</td>
      <td>1.0</td>
      <td>-1.680337</td>
      <td>1.461716</td>
      <td>-1.488154</td>
      <td>-0.810934</td>
      <td>0.241501</td>
      <td>0.645697</td>
      <td>1.184117</td>
    </tr>
  </tbody>
</table>
<p>1096 rows × 9 columns</p>
</div></div></div>
</div>
<p>just like classifiers, we can search for transformers of either type via the right tag:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;scitype:transform-input&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;scitype:transform-output&quot;</span></code> define input and output, e.g., “series-to-series” (both are scitype strings)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;scitype:instancewise&quot;</span></code> is boolean and tells us whether the transform is instance-wise</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example: looking for all series-to-primitive transformers that are instance-wise</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;transformer&quot;</span><span class="p">,</span>
    <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;scitype:transform-input&quot;</span><span class="p">:</span> <span class="s2">&quot;Series&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scitype:transform-output&quot;</span><span class="p">:</span> <span class="s2">&quot;Primitives&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scitype:instancewise&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>object</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Catch22</td>
      <td>&lt;class 'sktime.transformations.panel.catch22.C...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Catch22Wrapper</td>
      <td>&lt;class 'sktime.transformations.panel.catch22wr...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FittedParamExtractor</td>
      <td>&lt;class 'sktime.transformations.panel.summarize...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RandomIntervalFeatureExtractor</td>
      <td>&lt;class 'sktime.transformations.panel.summarize...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RandomIntervals</td>
      <td>&lt;class 'sktime.transformations.panel.random_in...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RandomShapeletTransform</td>
      <td>&lt;class 'sktime.transformations.panel.shapelet_...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SignatureTransformer</td>
      <td>&lt;class 'sktime.transformations.panel.signature...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SummaryTransformer</td>
      <td>&lt;class 'sktime.transformations.series.summariz...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>TSFreshFeatureExtractor</td>
      <td>&lt;class 'sktime.transformations.panel.tsfresh.T...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Tabularizer</td>
      <td>&lt;class 'sktime.transformations.panel.reduce.Ta...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>TimeBinner</td>
      <td>&lt;class 'sktime.transformations.panel.reduce.Ti...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Further details on transformations and feature extraction can be found in the tutorial 3, transformers.</p>
<p>All composition steps therein (e.g., chaining, column subsetting) work together with all estimator types in <code class="docutils literal notranslate"><span class="pre">sktime</span></code>, including classifiers, regressors, clusterers.</p>
</section>
<section id="pipelines-for-time-series-panel-tasks">
<h3>2.4.2 Pipelines for time series panel tasks<a class="headerlink" href="#pipelines-for-time-series-panel-tasks" title="Link to this heading">#</a></h3>
<p>all panel estimators pipeline with <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers, via the <code class="docutils literal notranslate"><span class="pre">*</span></code> dunder or <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code>.</p>
<p>The pipeline does the following:</p>
<ul class="simple">
<li><p>in <code class="docutils literal notranslate"><span class="pre">fit</span></code>: runs the transformers’ <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> in sequence, then <code class="docutils literal notranslate"><span class="pre">fit</span></code> of the panel estimator</p></li>
<li><p>in <code class="docutils literal notranslate"><span class="pre">predict</span></code>, runs the fitted transformers’ <code class="docutils literal notranslate"><span class="pre">transform</span></code> in sequence, then <code class="docutils literal notranslate"><span class="pre">predict</span></code> of the panel estimator</p></li>
</ul>
<p>(the logic is same as for <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> pipelines)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.exponent</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentTransformer</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">ExponentTransformer</span><span class="p">()</span> <span class="o">*</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">()</span>

<span class="c1"># this constructs a ClassifierPipeline, which is also a classifier</span>
<span class="n">pipe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-29eec29f-df63-4167-bb11-f9d06cda3863 {color: black;background-color: white;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 pre{padding: 0;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-toggleable {background-color: white;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-estimator:hover {background-color: #d4ebff;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-item {z-index: 1;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-parallel-item:only-child::after {width: 0;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-29eec29f-df63-4167-bb11-f9d06cda3863 div.sk-text-repr-fallback {display: none;}</style><div id='sk-29eec29f-df63-4167-bb11-f9d06cda3863' class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ClassifierPipeline(classifier=KNeighborsTimeSeriesClassifier(),
                   transformers=[ExponentTransformer()])</pre><b>Please rerun this cell to show the HTML repr or trust the notebook.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class='sk-label-container'><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('d0605c8a-e18f-48d8-b912-babd54d6f813') type="checkbox" ><label for=UUID('d0605c8a-e18f-48d8-b912-babd54d6f813') class='sk-toggleable__label sk-toggleable__label-arrow'>ClassifierPipeline</label><div class="sk-toggleable__content"><pre>ClassifierPipeline(classifier=KNeighborsTimeSeriesClassifier(),
                   transformers=[ExponentTransformer()])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('e4448a0d-a32f-46d0-b6a4-4f98d89f581e') type="checkbox" ><label for=UUID('e4448a0d-a32f-46d0-b6a4-4f98d89f581e') class='sk-toggleable__label sk-toggleable__label-arrow'>KNeighborsTimeSeriesClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsTimeSeriesClassifier()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('790128b5-0534-4368-9856-4c2ab56ba8dc') type="checkbox" ><label for=UUID('790128b5-0534-4368-9856-4c2ab56ba8dc') class='sk-toggleable__label sk-toggleable__label-arrow'>ExponentTransformer</label><div class="sk-toggleable__content"><pre>ExponentTransformer()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alternative to construct:</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">ExponentTransformer</span><span class="p">(),</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_unit_test</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_unit_test</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;TRAIN&quot;</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_unit_test</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;TEST&quot;</span><span class="p">)</span>

<span class="c1"># this is a ClassifierPipeline with the same interface as knn-classifier</span>
<span class="c1"># first applies exponent transform, then knn-classifier</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-da1bb5d1-1769-499a-9496-b22c36466a21 {color: black;background-color: white;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 pre{padding: 0;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-toggleable {background-color: white;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-estimator:hover {background-color: #d4ebff;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-item {z-index: 1;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-parallel-item:only-child::after {width: 0;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-da1bb5d1-1769-499a-9496-b22c36466a21 div.sk-text-repr-fallback {display: none;}</style><div id='sk-da1bb5d1-1769-499a-9496-b22c36466a21' class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ClassifierPipeline(classifier=KNeighborsTimeSeriesClassifier(),
                   transformers=[ExponentTransformer()])</pre><b>Please rerun this cell to show the HTML repr or trust the notebook.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class='sk-label-container'><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('9074e27b-30dc-426c-92fa-6be22c0b9f48') type="checkbox" ><label for=UUID('9074e27b-30dc-426c-92fa-6be22c0b9f48') class='sk-toggleable__label sk-toggleable__label-arrow'>ClassifierPipeline</label><div class="sk-toggleable__content"><pre>ClassifierPipeline(classifier=KNeighborsTimeSeriesClassifier(),
                   transformers=[ExponentTransformer()])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('dc0f59b0-e1ff-44f8-be9d-24053443d1ad') type="checkbox" ><label for=UUID('dc0f59b0-e1ff-44f8-be9d-24053443d1ad') class='sk-toggleable__label sk-toggleable__label-arrow'>KNeighborsTimeSeriesClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsTimeSeriesClassifier()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('188eb25d-8007-4ebc-b83c-e14327f8a6f6') type="checkbox" ><label for=UUID('188eb25d-8007-4ebc-b83c-e14327f8a6f6') class='sk-toggleable__label sk-toggleable__label-arrow'>ExponentTransformer</label><div class="sk-toggleable__content"><pre>ExponentTransformer()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers pipeline with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> classifiers!</p>
<p>This allows to build “time series feature extraction then <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> classify`” pipelines:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.summarize</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryTransformer</span>

<span class="c1"># specify summary transformer</span>
<span class="n">summary_rf</span> <span class="o">=</span> <span class="n">SummaryTransformer</span><span class="p">()</span> <span class="o">*</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>

<span class="n">summary_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf {color: black;background-color: white;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf pre{padding: 0;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-toggleable {background-color: white;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-estimator:hover {background-color: #d4ebff;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-item {z-index: 1;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-parallel-item:only-child::after {width: 0;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf div.sk-text-repr-fallback {display: none;}</style><div id='sk-659ee9c8-1fa2-459a-b0e2-7f6f920b3bcf' class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SklearnClassifierPipeline(classifier=RandomForestClassifier(),
                          transformers=[SummaryTransformer()])</pre><b>Please rerun this cell to show the HTML repr or trust the notebook.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class='sk-label-container'><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('5f54c30e-1d6e-4aa7-b842-e6d09e00dd81') type="checkbox" ><label for=UUID('5f54c30e-1d6e-4aa7-b842-e6d09e00dd81') class='sk-toggleable__label sk-toggleable__label-arrow'>SklearnClassifierPipeline</label><div class="sk-toggleable__content"><pre>SklearnClassifierPipeline(classifier=RandomForestClassifier(),
                          transformers=[SummaryTransformer()])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('39938995-f8f9-4f3f-9154-2372be6b3371') type="checkbox" ><label for=UUID('39938995-f8f9-4f3f-9154-2372be6b3371') class='sk-toggleable__label sk-toggleable__label-arrow'>RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('9d5ccdde-703c-4b88-a488-847cc273b949') type="checkbox" ><label for=UUID('9d5ccdde-703c-4b88-a488-847cc273b949') class='sk-toggleable__label sk-toggleable__label-arrow'>SummaryTransformer</label><div class="sk-toggleable__content"><pre>SummaryTransformer()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</section>
<section id="using-transformers-to-deal-with-unequal-length-or-missing-values">
<h3>2.4.3 Using transformers to deal with unequal length or missing values<a class="headerlink" href="#using-transformers-to-deal-with-unequal-length-or-missing-values" title="Link to this heading">#</a></h3>
<p>pro tip: useful transformers to pipeline are those that “improve” capabilities!</p>
<p>Search for these transformer tags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;capability:unequal_length:removes&quot;</span></code> - ensures all instances in the panel have equal length afterwards. Examples: padding, cutting, resampling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;capability:missing_values:removes&quot;</span></code> - removes all missing values from the data (e.g., series, panel) passed to it. Example: mean imputation</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># all transformers that guarantee that the output is equal length and equal index</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;transformer&quot;</span><span class="p">,</span>
    <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;capability:unequal_length:removes&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>object</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ClearSky</td>
      <td>&lt;class 'sktime.transformations.series.clear_sk...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>IntervalSegmenter</td>
      <td>&lt;class 'sktime.transformations.panel.segment.I...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PaddingTransformer</td>
      <td>&lt;class 'sktime.transformations.panel.padder.Pa...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RandomIntervalSegmenter</td>
      <td>&lt;class 'sktime.transformations.panel.segment.R...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SlopeTransformer</td>
      <td>&lt;class 'sktime.transformations.panel.slope.Slo...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TimeBinAggregate</td>
      <td>&lt;class 'sktime.transformations.series.binning....</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TruncationTransformer</td>
      <td>&lt;class 'sktime.transformations.panel.truncatio...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># all transformers that guarantee the output has no missing values</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;transformer&quot;</span><span class="p">,</span>
    <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;capability:missing_values:removes&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>object</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ClearSky</td>
      <td>&lt;class 'sktime.transformations.series.clear_sk...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Imputer</td>
      <td>&lt;class 'sktime.transformations.series.impute.I...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>minor note:</p>
<p>some transformers guarantee “no missing values” under some conditions but not always, e.g., <code class="docutils literal notranslate"><span class="pre">TimeBinAggregate</span></code></p>
<p>let’s check the tags in one example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list all classifiers in sktime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.feature_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryClassifier</span>

<span class="n">no_missing_clf</span> <span class="o">=</span> <span class="n">SummaryClassifier</span><span class="p">()</span>

<span class="n">no_missing_clf</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;python_dependencies_alias&#39;: {&#39;scikit-learn&#39;: &#39;sklearn&#39;},
 &#39;X_inner_mtype&#39;: &#39;numpy3D&#39;,
 &#39;capability:multivariate&#39;: True,
 &#39;capability:unequal_length&#39;: False,
 &#39;capability:missing_values&#39;: False,
 &#39;capability:train_estimate&#39;: False,
 &#39;capability:contractable&#39;: False,
 &#39;capability:multithreading&#39;: True,
 &#39;capability:predict_proba&#39;: True,
 &#39;python_version&#39;: None,
 &#39;requires_cython&#39;: False,
 &#39;classifier_type&#39;: &#39;feature&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">Imputer</span>

<span class="n">clf_can_do_missing</span> <span class="o">=</span> <span class="n">Imputer</span><span class="p">()</span> <span class="o">*</span> <span class="n">SummaryClassifier</span><span class="p">()</span>

<span class="n">clf_can_do_missing</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;python_dependencies_alias&#39;: {&#39;scikit-learn&#39;: &#39;sklearn&#39;},
 &#39;X_inner_mtype&#39;: &#39;pd-multiindex&#39;,
 &#39;capability:multivariate&#39;: True,
 &#39;capability:unequal_length&#39;: False,
 &#39;capability:missing_values&#39;: True,
 &#39;capability:train_estimate&#39;: False,
 &#39;capability:contractable&#39;: False,
 &#39;capability:multithreading&#39;: False,
 &#39;capability:predict_proba&#39;: True,
 &#39;python_version&#39;: None,
 &#39;requires_cython&#39;: False}
</pre></div>
</div>
</div>
</div>
</section>
<section id="tuning-and-model-selection">
<h3>2.4.4 Tuning and model selection<a class="headerlink" href="#tuning-and-model-selection" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> classifiers are compatible with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> model selection and composition tools using <code class="docutils literal notranslate"><span class="pre">sktime</span></code> data formats.</p>
<p>This extends to grid tuning and cross-validation, as long as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> based formats or length/instance indexed formats are used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_unit_test</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_unit_test</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;TRAIN&quot;</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_unit_test</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;TEST&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Cross-validation using the <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> <code class="docutils literal notranslate"><span class="pre">cross_val_score</span></code> and <code class="docutils literal notranslate"><span class="pre">KFold</span></code> functionality:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">cross_val_score</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.feature_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryClassifier</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">SummaryClassifier</span><span class="p">()</span>

<span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.6, 0.8, 0.6, 0.8])
</pre></div>
</div>
</div>
</div>
<p>Parameter tuning using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code>, we tune the <em>k</em> and distance measure for a K-NN classifier:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.classification.distance_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsTimeSeriesClassifier</span>

<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsTimeSeriesClassifier</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_neighbors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;distance&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span> <span class="s2">&quot;dtw&quot;</span><span class="p">]}</span>
<span class="n">parameter_tuning_method</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

<span class="n">parameter_tuning_method</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">parameter_tuning_method</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="advanced-composition-cheat-sheet-automl-bagging-ensembles">
<h3>2.4.5 Advanced Composition cheat sheet - AutoML, bagging, ensembles<a class="headerlink" href="#advanced-composition-cheat-sheet-automl-bagging-ensembles" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>common ensembling patterns: <code class="docutils literal notranslate"><span class="pre">BaggingClassifier</span></code>, <code class="docutils literal notranslate"><span class="pre">WeightedEnsembleClassifier</span></code></p></li>
<li><p>composability with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> classifier, regressor building blocks still applies</p></li>
<li><p>AutoML can be achieved by combining tuning with <code class="docutils literal notranslate"><span class="pre">MultiplexClassifier</span></code> or <code class="docutils literal notranslate"><span class="pre">MultiplexTransformer</span></code></p></li>
</ul>
<p>pro tip: bagging with a fixed single column subset can be used to turn an univariate classifier into a multivariate classifier!</p>
</section>
</section>
<section id="appendix-extension-guide">
<h2>2.5 Appendix - Extension guide<a class="headerlink" href="#appendix-extension-guide" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> is meant to be easily extensible, for direct contribution to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> as well as for local/private extension with custom methods.</p>
<p>To extend <code class="docutils literal notranslate"><span class="pre">sktime</span></code> with a new local or contributed estimator, a good workflow to follow is:</p>
<ol class="arabic simple" start="0">
<li><p>find the right extension template for the type of estimator you want to add - e.g., classifier, regressor, clusterer, etc. The extension templates are located in the <a class="reference external" href="https://github.com/sktime/sktime/blob/main/extension_templates">`extension_templates</a> directory</p></li>
<li><p>read through the extension template - this is a <code class="docutils literal notranslate"><span class="pre">python</span></code> file with <code class="docutils literal notranslate"><span class="pre">todo</span></code> blocks that mark the places in which changes need to be added.</p></li>
<li><p>optionally, if you are planning any major surgeries to the interface: look at the base class - note that “ordinary” extension (e.g., new algorithm) should be easily doable without this.</p></li>
<li><p>copy the extension template to a local folder in your own repository (local/private extension), or to a suitable location in your clone of the <code class="docutils literal notranslate"><span class="pre">sktime</span></code> or affiliated repository (if contributed extension), inside <code class="docutils literal notranslate"><span class="pre">sktime.[name_of_task]</span></code>; rename the file and update the file docstring appropriately.</p></li>
<li><p>address the “todo” parts. Usually, this means: changing the name of the class, setting the tag values, specifying hyper-parameters, filling in <code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">_fit</span></code>, <code class="docutils literal notranslate"><span class="pre">_predict</span></code> and/or other methods (for details see the extension template). You can add private methods as long as they do not override the default public interface. For more details, see the extension template.</p></li>
<li><p>to test your estimator manually: import your estimator and run it in the basic vignettes above.</p></li>
<li><p>to test your estimator automatically: call <code class="docutils literal notranslate"><span class="pre">sktime.tests.test_all_estimators.check_estimator</span></code> on your estimator. You can call this on a class or object instance. Ensure you have specified test parameters in the <code class="docutils literal notranslate"><span class="pre">get_test_params</span></code> method, according to the extension template.</p></li>
</ol>
<p>In case of direct contribution to <code class="docutils literal notranslate"><span class="pre">sktime</span></code> or one of its affiliated packages, additionally:</p>
<ul class="simple">
<li><p>add yourself as an author to the code, and to the <code class="docutils literal notranslate"><span class="pre">CODEOWNERS</span></code> for the new estimator file(s).</p></li>
<li><p>create a pull request that contains only the new estimators (and their inheritance tree, if it’s not just one class), as well as the automated tests as described above.</p></li>
<li><p>in the pull request, describe the estimator and optimally provide a publication or other technical reference for the strategy it implements.</p></li>
<li><p>before making the pull request, ensure that you have all necessary permissions to contribute the code to a permissive license (BSD-3) open source project.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./.venv/lib64/python3.11/site-packages/examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-this-notebook">Overview of this notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-data-sktime-data-formats">2.1 Panel data - <code class="docutils literal notranslate"><span class="pre">sktime</span></code> data formats <a name="panel"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preferred-format-1-pd-multiindex-specification">2.1.1 Preferred format 1 - <code class="docutils literal notranslate"><span class="pre">pd-multiindex</span></code> specification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preferred-format-2-numpy3d-specification">2.1.2 preferred format 2 - <code class="docutils literal notranslate"><span class="pre">numpy3D</span></code> specification</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-classification-regression-clustering-basic-vignettes">2.2 Time Series Classification, Regression, Clustering - Basic Vignettes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-classification-deployment-vignette">2.2.3 Time Series Classification - deployment vignette</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-classification-simple-evaluation-vignette">2.2.4 Time Series Classification - simple evaluation vignette</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-regression-basic-vignettes">2.2.5 Time Series Regression - basic vignettes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-clustering-basic-vignettes">5.2.6 Time Series Clustering - basic vignettes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-estimators-estimator-tags">2.3 Searching for estimators, estimator tags</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines-feature-extraction-tuning-composition">2.4 Pipelines, Feature Extraction, Tuning, Composition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primer-on-sktime-transformers-for-feature-extraction">2.4.1 Primer on <code class="docutils literal notranslate"><span class="pre">sktime</span></code> transformers for feature extraction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines-for-time-series-panel-tasks">2.4.2 Pipelines for time series panel tasks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-transformers-to-deal-with-unequal-length-or-missing-values">2.4.3 Using transformers to deal with unequal length or missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-and-model-selection">2.4.4 Tuning and model selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-composition-cheat-sheet-automl-bagging-ensembles">2.4.5 Advanced Composition cheat sheet - AutoML, bagging, ensembles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-extension-guide">2.5 Appendix - Extension guide</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>